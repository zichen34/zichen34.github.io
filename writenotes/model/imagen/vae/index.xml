<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>VAE on Zichen Wang</title>
        <link>https://zichen34.github.io/writenotes/model/imagen/vae/</link>
        <description>Recent content in VAE on Zichen Wang</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language><atom:link href="https://zichen34.github.io/writenotes/model/imagen/vae/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>read: VAE</title>
        <link>https://zichen34.github.io/writenotes/model/imagen/vae/b-note-vae/</link>
        <pubDate>Wed, 07 Jun 2023 10:00:00 +0000</pubDate>
        
        <guid>https://zichen34.github.io/writenotes/model/imagen/vae/b-note-vae/</guid>
        <description>&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://arxiv.org/abs/1312.6114&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Arxiv&lt;/a&gt;
| &lt;a class=&#34;link&#34; href=&#34;https://keras.io/examples/generative/vae/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Code-keras&lt;/a&gt;
| &lt;a class=&#34;link&#34; href=&#34;https://github.com/bojone/vae/blob/master/cvae_keras.py&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Code-cvae&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Another paper: &lt;a class=&#34;link&#34; href=&#34;https://arxiv.org/abs/1906.02691&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;em&gt;An Introduction to Variational Autoencoders&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Recognition model with parameters Ï†, $q_Ï†(ğ³|ğ±)$, approximates the intractable posterior distribution;&lt;/p&gt;
&lt;p&gt;Generative model with parameters Î¸, $p_Î¸(ğ³)p_Î¸(ğ±|ğ³)$, maps a latent variable to a &amp;ldquo;sample&amp;rdquo;.&lt;/p&gt;
&lt;h2 id=&#34;abstract&#34;&gt;Abstract&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;directed probabilistic model&lt;/p&gt;
&lt;p&gt;The distribution of an i.i.d. dataset with latent variables P(ğ—,ğ™)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;continuous latent variables with intractable posterior distributions&lt;/p&gt;
&lt;p&gt;The latent variable ğ³ per datapoint is continuous, so its posterior distribution $p_Î¸(ğ³|ğ±)$ cannot be computed explicitly.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;reparameterization of the variational lower bound yields a lower bound estimator&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Lower bound estimator can be optimized using SGD,&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Variational Bayesian approach involves the optimization of an approximation to the intractable posterior.&lt;/p&gt;
&lt;p&gt;Use q(ğ³) to approximate $p_Î¸(ğ³|ğ±)$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Mean-field approach requires analytical solutions of expectations w.r.t. the approximate posterior&lt;/p&gt;
&lt;p&gt;ğ”¼_{q(ğ³)} [  ]&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;q(ğ³) is also intractable&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;method&#34;&gt;Method&lt;/h2&gt;
&lt;h3 id=&#34;problem-scenario&#34;&gt;Problem scenario&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Each sample is generated by two steps:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;sample a ğ³ from prior distribution $p_{Î¸^*}(ğ³)$&lt;/li&gt;
&lt;li&gt;Sample an ğ± from the conditional distribution $p_{Î¸^*}(ğ±|ğ³)$&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;where Î¸* is the true parameters.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Intractability:&lt;/p&gt;
&lt;p&gt;The integral of the marginal likelihood $p_Î¸(ğ±) = âˆ« p_Î¸(ğ³) p_Î¸(ğ±|ğ³) dğ³ = âˆ« p_Î¸(ğ±,ğ³) dğ³$ cannot be computed,
because ğ³ is a high-dimensional continuous variable.&lt;/p&gt;
&lt;p&gt;Such that the true posterior density $p_Î¸(ğ³|ğ±) = \frac{ p_Î¸(ğ±|ğ³) p_Î¸(ğ³) }{ p_Î¸(ğ±) }$ is also intractable,
because the denominator marginal likelihood cannot be computed.&lt;/p&gt;
&lt;p&gt;That means the EM algorithm cannot be used,
because in each iteration the introduced prior distribution q(ğ³) needs to be equal to $p_Î¸(ğ³|ğ±)$, which however is intractable.&lt;/p&gt;
&lt;p&gt;And any reasonable mean-field variational bayesian algorithms are intractable,
where the $p_Î¸(ğ³|ğ±)$ is used as the objective of approximating by q(ğ³), but it doesn&amp;rsquo;t work for $p_Î¸(ğ³|ğ±)$ that cannot be computed.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;A large dataset:&lt;/p&gt;
&lt;p&gt;Sampling-based methods, e.g. Monte Carlo EM, would be too slow,
because sampling is performed on every datapoint.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Three meaningful problems:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Estimating the parameter Î¸ of the distribution via MLE or MAP can allow mimicking the data-generating process: Sample ğ³ first then sample the x from the conditional distribution&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;MLE try to find the Î¸ that makes the probability of dataset X &lt;strong&gt;given Z&lt;/strong&gt; maximum.
MLE is to estimate &lt;strong&gt;parameter&lt;/strong&gt; Î¸, while VAE is to estimate the &lt;strong&gt;distribution&lt;/strong&gt; of X.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;MAP believe that the Î¸ having the maximum posterior probability given a dataset likelihood p(X|Î¸) and prior probability p(Î¸) according to, $p(Î¸|X) = \frac{p(X|Î¸) p(Î¸)}{p(X)}$, is the most possible.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;EM algorithm uses MLE to find the &lt;strong&gt;parameter&lt;/strong&gt; Î¸ of a probabilistic model involving latent variable,
where assume the prior probability q(ğ³) = posterior probability $p_Î¸(ğ³|ğ±)$ of the latent variable, then apply MLE find optimal Î¸.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Approximating the &lt;strong&gt;posterior probability&lt;/strong&gt; $p_Î¸(ğ³|ğ±)$ given an observed value ğ± and a choice of parameters Î¸ is useful for encoding data.&lt;/p&gt;
&lt;p&gt;The latent variable ğ³ can be regarded as a latent representation of a datapoint ğ±.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Approximating the &lt;strong&gt;marginal likelihood&lt;/strong&gt; $p_Î¸(ğ±)$ enable to perform those inference tasks where the prior p(ğ±) is required, e.g. image denoising and inpainting.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The above three goals can be tackled by a recognition model $q_Ï†(ğ³|ğ±)$,
which is an approximation to the intractable posterior probability $p_Î¸(ğ³|ğ±)$&lt;/p&gt;
&lt;p&gt;The recognition model $q_Ï†(ğ³|ğ±)$ is a probabilistic &lt;strong&gt;encoder&lt;/strong&gt;, which produces a distribution over &lt;strong&gt;all&lt;/strong&gt; possible values of ğ³ with given a datapoint ğ±.&lt;/p&gt;
&lt;p&gt;(Each datapoint ğ± corresponds to a distribution $q_Ï†(ğ³|ğ±)$ with some parameters (e.g., Î¼,Ïƒ).)&lt;/p&gt;



&lt;div class=&#34;goat svg-container &#34;&gt;
  
    &lt;svg
      xmlns=&#34;http://www.w3.org/2000/svg&#34;
      font-family=&#34;Menlo,Lucida Console,monospace&#34;
      
        viewBox=&#34;0 0 376 169&#34;
      &gt;
      &lt;g transform=&#39;translate(8,16)&#39;&gt;
&lt;path d=&#39;M 32,48 L 40,48&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 104,48 L 112,48&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 224,48 L 232,48&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 296,48 L 304,48&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 16,64 L 128,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 128,64 L 152,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 208,64 L 320,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 320,64 L 344,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 16,16 L 16,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 208,16 L 208,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;polygon points=&#39;24.000000,16.000000 12.000000,10.400000 12.000000,21.600000&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(270.000000, 16.000000, 16.000000)&#39;&gt;&lt;/polygon&gt;
&lt;polygon points=&#39;160.000000,64.000000 148.000000,58.400002 148.000000,69.599998&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(0.000000, 152.000000, 64.000000)&#39;&gt;&lt;/polygon&gt;
&lt;polygon points=&#39;216.000000,16.000000 204.000000,10.400000 204.000000,21.600000&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(270.000000, 208.000000, 16.000000)&#39;&gt;&lt;/polygon&gt;
&lt;polygon points=&#39;352.000000,64.000000 340.000000,58.400002 340.000000,69.599998&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(0.000000, 344.000000, 64.000000)&#39;&gt;&lt;/polygon&gt;
&lt;path d=&#39;M 72,16 A 16,16 0 0,0 56,32&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 72,16 A 16,16 0 0,1 88,32&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 264,16 A 16,16 0 0,0 248,32&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 264,16 A 16,16 0 0,1 280,32&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 32,48 A 16,16 0 0,0 16,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 56,32 A 16,16 0 0,1 40,48&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 88,32 A 16,16 0 0,0 104,48&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 112,48 A 16,16 0 0,1 128,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 224,48 A 16,16 0 0,0 208,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 248,32 A 16,16 0 0,1 232,48&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 280,32 A 16,16 0 0,0 296,48&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 304,48 A 16,16 0 0,1 320,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;0&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;p&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;8&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;(&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;16&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ³&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;16&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;D&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;24&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;|&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;24&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;24&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;(&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;32&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ±&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;32&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;s&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;32&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;b&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;32&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;f&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;40&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;)&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;40&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;t&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;40&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;y&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;40&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;r&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;48&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;r&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;48&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;o&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;56&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;56&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;g&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;56&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;m&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;64&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;b&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;64&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;72&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;u&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;72&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;v&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;72&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;E&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;80&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;t&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;80&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;e&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;80&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;n&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;88&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;88&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;n&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;88&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;c&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;96&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;o&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;96&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;o&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;104&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;n&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;104&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;a&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;104&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;d&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;112&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;e&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;120&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;o&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;120&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ±&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;120&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;r&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;128&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;f&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;128&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;)&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;144&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ³&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;168&#39; y=&#39;68&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ³&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;192&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;p&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;200&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;(&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;208&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ±&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;216&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;|&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;216&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;D&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;224&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ³&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;224&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;224&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;(&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;232&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;)&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;232&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;s&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;232&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;b&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;232&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;f&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;240&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;t&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;240&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;y&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;240&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;r&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;248&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;r&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;248&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;o&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;256&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;256&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;g&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;256&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;m&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;264&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;b&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;264&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;272&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;u&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;272&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;v&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;272&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;D&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;280&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;t&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;280&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;e&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;280&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;e&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;288&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;288&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;n&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;288&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;c&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;296&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;o&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;296&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;o&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;304&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;n&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;304&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;a&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;304&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;d&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;312&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;e&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;320&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;o&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;320&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ³&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;320&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;r&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;328&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;f&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;328&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;)&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;344&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ±&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;360&#39; y=&#39;68&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ±&lt;/text&gt;
&lt;/g&gt;

    &lt;/svg&gt;
  
&lt;/div&gt;
&lt;p&gt;A ğ³ produces a conditional distribution p(ğ±|ğ³), from which a datapoint ğ± is generated. So the generative model $p_Î¸(ğ±|ğ³)$ is called probabilistic &lt;strong&gt;decoder&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;(2023-07-09)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;So a training step is: sampling a ğ³ from distribution p(ğ³|ğ±), then with this ğ³, find the parameter Î¸ that makes the probability p(ğ±|ğ³) largest based on MLE.
That&amp;rsquo;s why the loss funciton has a cross-entropy term that measures the likelihood of output ğ±&amp;rsquo;, i.e., log p(ğ±|ğ³).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;According to KL-divergence $-q(ğ³) log \frac{p(ğ³|ğ±)}{q(ğ³)}$, the approximated posterior q(ğ³) is supposed to equal the real posterior p(ğ³|ğ±),
which, however, is intractable.
So the authors use network and reparameterization to estimate the parameters (mean, variance) of the posterior.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;(I think) ğ³ sampled from posterior can be one value or multiple times and doing average.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;22-the-variational-bound&#34;&gt;2.2 The Variational bound&lt;/h3&gt;
&lt;p&gt;The marginal likelihood of the dataset with N datapoints is a sum over the marginal likelihoods of individual datapoints:&lt;/p&gt;
&lt;p&gt;$log\ p_Î¸(ğ±â½Â¹â¾, &amp;hellip;, ğ±â½á´ºâ¾ ) = âˆ‘áµ¢â‚Œâ‚á´º log\ p_Î¸(ğ±â½â±â¾)$&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Rewrite it by introducing posterior approximation $q_Ï†(ğ³|ğ±â½â±â¾)$ to make up KL divergence:&lt;/p&gt;
&lt;p&gt;$$
\begin{aligned}
&amp;amp;log\ p_Î¸(ğ±â½â±â¾)  \\
&amp;amp;= log\ (\frac{p_Î¸(ğ±â½â±â¾|ğ³) p_Î¸(ğ³)}{p_Î¸(ğ³|ğ±â½â±â¾)} ) \\
&amp;amp;= log\ (p_Î¸(ğ±â½â±â¾|ğ³) p_Î¸(ğ³)) - log\ p_Î¸(ğ³|ğ±â½â±â¾) \\
&amp;amp;= log\ (p_Î¸(ğ±â½â±â¾|ğ³) p_Î¸(ğ³)) - log\ p_Î¸(ğ³|ğ±â½â±â¾) \\
&amp;amp;\quad  + log\ q_Ï†(ğ³|ğ±â½â±â¾) - log\ q_Ï†(ğ³|ğ±â½â±â¾) \\
&amp;amp;= log\ \frac{p_Î¸(ğ±â½â±â¾|ğ³) p_Î¸(ğ³)}{q_Ï†(ğ³|ğ±â½â±â¾)} - log\ \frac{p_Î¸(ğ³|ğ±â½â±â¾)}{q_Ï†(ğ³|ğ±â½â±â¾)}\\
\end{aligned}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Compute &lt;strong&gt;expectations&lt;/strong&gt; w.r.t. the approximate posterior $q_Ï†(ğ³|ğ±)$ for both side:&lt;/p&gt;
&lt;p&gt;$$
âˆ«q_Ï†(ğ³|ğ±â½â±â¾) log\ p_Î¸(ğ±â½â±â¾) dğ³ = \\
âˆ«q_Ï†(ğ³|ğ±â½â±â¾) \left[log\ \frac{p_Î¸(ğ±â½â±â¾|ğ³) p_Î¸(ğ³)}{q_Ï†(ğ³|ğ±â½â±â¾)} - log\ \frac{p_Î¸(ğ³|ğ±â½â±â¾)}{q_Ï†(ğ³|ğ±â½â±â¾)} \right] dğ³
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Left-hand side remains marginal likelihood $log\ p_Î¸(ğ±â½â±â¾)$ (i.e. $ğ”¼_{q_Ï†(ğ³|ğ±â½â±â¾)} [ log\ p_Î¸(ğ±â½â±â¾) ]$) because p(x) has nothing to do with z.&lt;/p&gt;
&lt;p&gt;While right-hand side is the &lt;strong&gt;lower bound&lt;/strong&gt; plus &lt;strong&gt;KL divergence&lt;/strong&gt;: &lt;div id=&#34;eq2&#34;&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;$$
\begin{aligned}
&amp;amp; log\ p_Î¸(ğ±â½â±â¾) = \\
&amp;amp; âˆ«q_Ï†(ğ³|ğ±â½â±â¾) log\ \frac{p_Î¸(ğ±â½â±â¾|ğ³) p_Î¸(ğ³)}{q_Ï†(ğ³|ğ±â½â±â¾)} dğ³ \\
&amp;amp;\quad - âˆ«q_Ï†(ğ³|ğ±â½â±â¾) log\ \frac{p_Î¸(ğ³|ğ±â½â±â¾)}{q_Ï†(ğ³|ğ±â½â±â¾)} dğ³ \\
&amp;amp; = â„’(Î¸,Ï†; ğ±â½â±â¾) + D_{KL} ( q_Ï†(ğ³|ğ±â½â±â¾) || p_Î¸(ğ³|ğ±â½â±â¾ ) \\
&amp;amp;  \\
&amp;amp; = ğ”¼_{q_Ï†(ğ³|ğ±â½â±â¾)} [log\ p_Î¸(ğ±â½â±â¾,ğ³) - log\ q_Ï†(ğ³|ğ±â½â±â¾)] \\
&amp;amp;\quad + D_{KL} ( q_Ï†(ğ³|ğ±â½â±â¾) || p_Î¸(ğ³|ğ±â½â±â¾ ) \quad (2)
\end{aligned}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In another way, the lower bound can also be written as eq.(3): &lt;div id=&#34;eq3&#34;&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;ğ“›$(Î¸,Ï†; ğ±â½â±â¾) = -D_{KL} ( q_Ï†(ğ³|ğ±â½â±â¾) || p_Î¸(ğ³) ) + ğ”¼_{q_Ï†(ğ³|ğ±â½â±â¾)} [log\ p_Î¸(ğ±â½â±â¾|ğ³)]$&lt;/p&gt;
&lt;p&gt;whose derivation starts from the conditional probability $p_Î¸(ğ±â½â±â¾|ğ³)$:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;The likelihood of the i-th datapoint:
$$
\begin{aligned}
&amp;amp; log(p_Î¸(ğ±â½â±â¾|ğ³))  \\
&amp;amp;= log( \frac{p_Î¸(ğ³|ğ±â½â±â¾)p_Î¸(ğ±â½â±â¾))}{p_Î¸(ğ³)} )\\
&amp;amp;= log( \frac{ p_Î¸(ğ³|ğ±â½â±â¾)p_Î¸(ğ±â½â±â¾)* q_Ï†(ğ³|ğ±â½â±â¾) ) }{ p_Î¸(ğ³)*q_Ï†(ğ³|ğ±â½â±â¾) } ) \\
&amp;amp;= log( \frac{ p_Î¸(ğ³|ğ±â½â±â¾)p_Î¸(ğ±â½â±â¾)}{q_Ï†(ğ³|ğ±â½â±â¾)} ) -
log( \frac{p_Î¸(ğ³)}{q_Ï†(ğ³|ğ±â½â±â¾)} )
\end{aligned}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Compute the expectation w.r.t. approximate posterior $q_Ï†(ğ³|ğ±â½â±â¾)$:&lt;/p&gt;
&lt;p&gt;$$
\begin{aligned}
&amp;amp; âˆ«q_Ï†(ğ³|ğ±â½â±â¾)\ log(p_Î¸(ğ±â½â±â¾|ğ³)) dğ³ = \\
&amp;amp; âˆ«q_Ï†(ğ³|ğ±â½â±â¾) log( \frac{ p_Î¸(ğ³|ğ±â½â±â¾)p_Î¸(ğ±â½â±â¾)}{q_Ï†(ğ³|ğ±â½â±â¾)})dğ³\\
&amp;amp; \quad - âˆ«q_Ï†(ğ³|ğ±â½â±â¾) log( \frac{p_Î¸(ğ³)}{q_Ï†(ğ³|ğ±â½â±â¾)} ) dğ³ \\
&amp;amp; \\
&amp;amp; ğ”¼_{q_Ï†(ğ³|ğ±â½â±â¾)} [log\ p_Î¸(ğ±â½â±â¾|ğ³))] = \\
&amp;amp; \quad â„’(Î¸,Ï†; ğ±â½â±â¾) + D_{KL} ( q_Ï†(ğ³|ğ±â½â±â¾ || p_Î¸(ğ³))
\end{aligned}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;However, using Monte Carlo to estimate gradient of ğ“› (an expectation) will bring high variance.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;23-sgvb-estimator-and-aevb-algo&#34;&gt;2.3 SGVB estimator and AEVB algo&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;A practical estimator of the lower bound ğ“› of the likelihood and its derivatives w.r.t. the parameters.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;(With some mild conditions for a selected approximate posterior distribution $q_Ï†(ğ³|ğ±)$,)&lt;/p&gt;
&lt;p&gt;Consider a variable $\~ğ³$ that comes from $\~ğ³ = g_Ï†$(ğ›†,ğ±) with ğ›† ~ p(ğ›†),
follows the posterior distribution $\~ğ³ \sim q_Ï†(ğ³|ğ±)$ (or not conditioned distribution $q_Ï†(ğ³)$). &lt;br&gt;
And $g_Ï†$(ğ›†,ğ±) is a &lt;strong&gt;deterministic differentiable transformation&lt;/strong&gt; of an (auxiliary) noise variable ğ›†.&lt;/p&gt;
&lt;p&gt;Since $\~ğ³$ is a transformation of ğ›†, $\~ğ³$ follows the distribution p(ğ›†) as well.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Monte Carlo estimation&lt;/p&gt;
&lt;p&gt;Therefore, using Monte Carlo (i.e., averaging the L sampled values) to approximate an expectation of some function $f(ğ³)$ w.r.t. the posterior approximation $q_Ï†(ğ³|ğ±â½â±â¾)$ becomes:&lt;/p&gt;
&lt;p&gt;$$
ğ”¼_{q_Ï†(ğ³|ğ±â½â±â¾)} [f(ğ³)] = ğ”¼_{p(Îµ)} [f( g_Ï†(Îµ, ğ±â½â±â¾) )] \\
â‰ƒ  \frac{1}{L} âˆ‘â‚—â‚Œâ‚á´¸ f( g_Ï†(Îµâ½Ë¡â¾, ğ±â½â±â¾) ),
$$
where ğ›†â½Ë¡â¾~ p(ğ›†).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Approximate lower bound with &lt;a class=&#34;link&#34; href=&#34;#eq2&#34; &gt;eq. (2)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The version A of SGVB estimator comes from eq. (2), the lower bound ğ“› should be finally equal to that ELBO expectation,
ğ“›á´¬ (ğ›‰,ğ›—,ğ±â½â±â¾) â‰ƒ ğ“› (ğ›‰,ğ›—,ğ±â½â±â¾) i.e., the KL divergence=0.&lt;/p&gt;
&lt;p&gt;And that expectation can be approximated via Monte Carlo (sampling), so the lower bound is approximated as:&lt;/p&gt;
&lt;p&gt;$$
\~\mathcal L^A (Î¸,Ï†,ğ±â½â±â¾) = \\
\frac{1}{L}  âˆ‘â‚—â‚Œâ‚á´¸ \left[ log\ p_Î¸(ğ±â½â±â¾, ğ³â½â±&amp;rsquo;Ë¡â¾) - log\ q_Ï†(ğ³â½â±&amp;rsquo;Ë¡â¾| ğ±â½â±â¾) \right] \\
$$&lt;/p&gt;
&lt;p&gt;where $ğ³â½â±&amp;rsquo;Ë¡â¾= g_Ï†(Îµâ½â±&amp;rsquo;Ë¡â¾, ğ±â½â±â¾))$ and ğ›†â½Ë¡â¾~ p(ğ›†)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Approximate lower bound with &lt;a class=&#34;link&#34; href=&#34;#eq3&#34; &gt;eq. (3)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Since the KL-divergence $D_{KL}( q_Ï†(ğ³|ğ±â½â±â¾) || p_Î¸(ğ³) )$ of eq. (3) can be integrated analytically,
it can be substituted into eq. (3), then only that expectation (&amp;ldquo;expected reconstruction error&amp;rdquo; $ğ”¼_{q_Ï†(ğ³|ğ±â½â±â¾)} [log\ p_Î¸(ğ±â½â±â¾|ğ³))]$) is approximated,
so the second version of lower bound approximation: ğ“›á´® (ğ›‰,ğ›—,ğ±â½â±â¾) â‰ƒ ğ“› (ğ›‰,ğ›—,ğ±â½â±â¾) is more relatively accurate than the version A.&lt;/p&gt;
&lt;p&gt;$$
\tilde{\mathcal L^B} =
-D_{KL}( q_Ï†(ğ³|ğ±â½â±â¾) || p_Î¸(ğ³) ) \\
\qquad + \frac{1}{L}  âˆ‘â‚—â‚Œâ‚á´¸ log\ p_Î¸(ğ±â½â±â¾ | ğ³â½â±&amp;rsquo;Ë¡â¾)
$$&lt;/p&gt;
&lt;p&gt;where $ğ³â½â±&amp;rsquo;Ë¡â¾= g_Ï†(Îµâ½â±&amp;rsquo;Ë¡â¾, ğ±â½â±â¾))$ and ğ›†â½Ë¡â¾~ p(ğ›†).&lt;/p&gt;
&lt;p&gt;The KL-divergence there can be interpreted as regularizer, and the optimization objective is enlarging the &amp;ldquo;expected negative reconstruction error&amp;rdquo;, i.e., recover original ğ± from code ğ³.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Train with minibatches&lt;/p&gt;
&lt;p&gt;Given a dataset ğ— with N datapoints, each time M datapoints are drawn as a minibatch,
then the marginal likelihood lower bound of the full dataset batch-by-batch is estimated as:&lt;/p&gt;
&lt;p&gt;$$
\mathcal L(\pmb{Î¸,Ï†},ğ±) \simeq \mathcal L^M (\pmb{Î¸,Ï†},ğ—á´¹) =
\frac{N}{M} âˆ‘áµ¢â‚Œâ‚á´¹ \tilde{\mathcal L} (\pmb{Î¸,Ï†},ğ±â½â±â¾)
$$&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;24-reparameterization-trick&#34;&gt;2.4 Reparameterization trick&lt;/h3&gt;
&lt;p&gt;Previously, ğ³ is sampled directly, then input to model $p_Î¸(ğ±|ğ³)$, but the parameter Ï† of the distribution of ğ³ is not able to be optimized via gradient descent, since Monte Carlo isn&amp;rsquo;t differentiable.&lt;/p&gt;



&lt;div class=&#34;goat svg-container &#34;&gt;
  
    &lt;svg
      xmlns=&#34;http://www.w3.org/2000/svg&#34;
      font-family=&#34;Menlo,Lucida Console,monospace&#34;
      
        viewBox=&#34;0 0 280 121&#34;
      &gt;
      &lt;g transform=&#39;translate(8,16)&#39;&gt;
&lt;path d=&#39;M 144,48 L 168,48&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 8,80 L 104,80&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 104,80 L 120,80&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 8,16 L 8,80&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 208,80 L 216,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 228,40 L 236,24&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 208,16 L 216,32&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 228,56 L 236,72&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;polygon points=&#39;16.000000,16.000000 4.000000,10.400000 4.000000,21.600000&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(270.000000, 8.000000, 16.000000)&#39;&gt;&lt;/polygon&gt;
&lt;polygon points=&#39;128.000000,80.000000 116.000000,74.400002 116.000000,85.599998&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(0.000000, 120.000000, 80.000000)&#39;&gt;&lt;/polygon&gt;
&lt;polygon points=&#39;176.000000,48.000000 164.000000,42.400002 164.000000,53.599998&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(0.000000, 168.000000, 48.000000)&#39;&gt;&lt;/polygon&gt;
&lt;path d=&#39;M 56,32 A 16,16 0 0,0 40,48&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 56,32 A 16,16 0 0,1 72,48&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 24,64 A 16,16 0 0,0 8,80&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 40,48 A 16,16 0 0,1 24,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 72,48 A 16,16 0 0,0 88,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 88,64 A 16,16 0 0,1 104,80&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;circle cx=&#39;208&#39; cy=&#39;16&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;208&#39; cy=&#39;48&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;208&#39; cy=&#39;80&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;248&#39; cy=&#39;16&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;248&#39; cy=&#39;32&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;248&#39; cy=&#39;48&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;248&#39; cy=&#39;64&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;248&#39; cy=&#39;80&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;0&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;p&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;8&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;(&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;16&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;z&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;16&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;z&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;24&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;)&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;32&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;p&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;40&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;r&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;48&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;56&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;o&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;64&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;r&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;72&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;,&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;88&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;q&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;96&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;áµ©&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;104&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;(&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;112&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;z&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;120&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;)&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;128&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;s&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;136&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;a&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;136&#39; y=&#39;84&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;z&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;144&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;M&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;144&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;m&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;152&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;.&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;152&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;p&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;152&#39; y=&#39;36&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;z&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;160&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;C&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;160&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;l&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;168&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;.&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;168&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;176&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;n&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;184&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;g&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;208&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;z&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;216&#39; y=&#39;52&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;-&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;224&#39; y=&#39;52&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;Î¸&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;232&#39; y=&#39;52&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;-&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;248&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;x&lt;/text&gt;
&lt;/g&gt;

    &lt;/svg&gt;
  
&lt;/div&gt;
&lt;p&gt;Instead of sampling the ğ³ directly, but the ğ³ is derived from the sampled ğ›†,
based on the deterministic differentiable transformation:
ğ³ = gáµ©(ğ›†, ğ±).&lt;/p&gt;



&lt;div class=&#34;goat svg-container &#34;&gt;
  
    &lt;svg
      xmlns=&#34;http://www.w3.org/2000/svg&#34;
      font-family=&#34;Menlo,Lucida Console,monospace&#34;
      
        viewBox=&#34;0 0 408 121&#34;
      &gt;
      &lt;g transform=&#39;translate(8,16)&#39;&gt;
&lt;path d=&#39;M 144,48 L 168,48&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 288,48 L 304,48&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 24,64 L 32,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 96,64 L 104,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 8,80 L 120,80&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 120,80 L 136,80&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 8,16 L 8,80&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 336,80 L 344,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 356,40 L 364,24&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 336,16 L 344,32&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 356,56 L 364,72&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;polygon points=&#39;16.000000,16.000000 4.000000,10.400000 4.000000,21.600000&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(270.000000, 8.000000, 16.000000)&#39;&gt;&lt;/polygon&gt;
&lt;polygon points=&#39;144.000000,80.000000 132.000000,74.400002 132.000000,85.599998&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(0.000000, 136.000000, 80.000000)&#39;&gt;&lt;/polygon&gt;
&lt;polygon points=&#39;176.000000,48.000000 164.000000,42.400002 164.000000,53.599998&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(0.000000, 168.000000, 48.000000)&#39;&gt;&lt;/polygon&gt;
&lt;polygon points=&#39;312.000000,48.000000 300.000000,42.400002 300.000000,53.599998&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(0.000000, 304.000000, 48.000000)&#39;&gt;&lt;/polygon&gt;
&lt;path d=&#39;M 64,32 A 16,16 0 0,0 48,48&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 64,32 A 16,16 0 0,1 80,48&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 24,64 A 16,16 0 0,0 8,80&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 48,48 A 16,16 0 0,1 32,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 80,48 A 16,16 0 0,0 96,64&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 104,64 A 16,16 0 0,1 120,80&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;circle cx=&#39;336&#39; cy=&#39;16&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;336&#39; cy=&#39;48&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;336&#39; cy=&#39;80&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;376&#39; cy=&#39;16&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;376&#39; cy=&#39;32&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;376&#39; cy=&#39;48&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;376&#39; cy=&#39;64&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;376&#39; cy=&#39;80&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;0&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;p&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;8&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;(&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;16&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ›†&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;24&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;)&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;24&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ›†&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;40&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;d&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;48&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;56&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;s&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;64&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;t&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;72&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;r&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;80&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;88&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;b&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;96&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;u&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;104&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;t&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;112&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;120&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;o&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;128&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;s&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;128&#39; y=&#39;100&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;n&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;136&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;a&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;144&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;M&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;144&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;m&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;152&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;.&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;152&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;p&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;152&#39; y=&#39;36&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ›†&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;152&#39; y=&#39;84&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ›†&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;160&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;C&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;160&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;l&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;168&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;.&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;168&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;176&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;n&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;184&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;g&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;200&#39; y=&#39;52&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;z&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;216&#39; y=&#39;52&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;=&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;232&#39; y=&#39;52&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;Î¼&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;248&#39; y=&#39;52&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;+&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;264&#39; y=&#39;52&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;Ïƒ&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;272&#39; y=&#39;52&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ›†&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;336&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;z&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;344&#39; y=&#39;52&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;-&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;352&#39; y=&#39;52&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;Î¸&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;360&#39; y=&#39;52&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;-&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;376&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;x&lt;/text&gt;
&lt;/g&gt;

    &lt;/svg&gt;
  
&lt;/div&gt;
&lt;p&gt;(The non-differentiable operation (M.C.) is put ahead of the leave nodes on the computational graph.)&lt;/p&gt;
&lt;p&gt;Then the parameters (e.g. Î¼,ÏƒÂ²) of ğ³&amp;rsquo;s distribution can be learned by a network with parameters Ï†.&lt;/p&gt;



&lt;div class=&#34;goat svg-container &#34;&gt;
  
    &lt;svg
      xmlns=&#34;http://www.w3.org/2000/svg&#34;
      font-family=&#34;Menlo,Lucida Console,monospace&#34;
      
        viewBox=&#34;0 0 424 297&#34;
      &gt;
      &lt;g transform=&#39;translate(8,16)&#39;&gt;
&lt;path d=&#39;M 112,16 L 144,16&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 72,80 L 112,80&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 192,128 L 224,128&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 304,128 L 328,128&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 120,240 L 128,240&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 192,240 L 200,240&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 104,256 L 216,256&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 216,256 L 232,256&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 104,208 L 104,256&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 128,96 L 128,112&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 160,32 L 160,112&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 176,144 L 176,176&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 12,72 L 20,56&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 32,32 L 40,16&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 240,160 L 248,144&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 260,120 L 268,104&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 12,24 L 20,40&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 32,64 L 40,80&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 240,96 L 248,112&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 260,136 L 268,152&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;polygon points=&#39;112.000000,208.000000 100.000000,202.399994 100.000000,213.600006&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(270.000000, 104.000000, 208.000000)&#39;&gt;&lt;/polygon&gt;
&lt;polygon points=&#39;136.000000,112.000000 124.000000,106.400002 124.000000,117.599998&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(90.000000, 128.000000, 112.000000)&#39;&gt;&lt;/polygon&gt;
&lt;polygon points=&#39;168.000000,112.000000 156.000000,106.400002 156.000000,117.599998&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(90.000000, 160.000000, 112.000000)&#39;&gt;&lt;/polygon&gt;
&lt;polygon points=&#39;184.000000,144.000000 172.000000,138.399994 172.000000,149.600006&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(270.000000, 176.000000, 144.000000)&#39;&gt;&lt;/polygon&gt;
&lt;polygon points=&#39;232.000000,128.000000 220.000000,122.400002 220.000000,133.600006&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(0.000000, 224.000000, 128.000000)&#39;&gt;&lt;/polygon&gt;
&lt;polygon points=&#39;240.000000,256.000000 228.000000,250.399994 228.000000,261.600006&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(0.000000, 232.000000, 256.000000)&#39;&gt;&lt;/polygon&gt;
&lt;polygon points=&#39;336.000000,128.000000 324.000000,122.400002 324.000000,133.600006&#39; fill=&#39;currentColor&#39; transform=&#39;rotate(0.000000, 328.000000, 128.000000)&#39;&gt;&lt;/polygon&gt;
&lt;path d=&#39;M 144,16 A 16,16 0 0,1 160,32&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 112,80 A 16,16 0 0,1 128,96&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 160,208 A 16,16 0 0,0 144,224&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 160,208 A 16,16 0 0,1 176,224&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 120,240 A 16,16 0 0,0 104,256&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 144,224 A 16,16 0 0,1 128,240&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 176,224 A 16,16 0 0,0 192,240&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;path d=&#39;M 200,240 A 16,16 0 0,1 216,256&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39;&gt;&lt;/path&gt;
&lt;circle cx=&#39;0&#39; cy=&#39;16&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;0&#39; cy=&#39;32&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;0&#39; cy=&#39;48&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;0&#39; cy=&#39;64&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;0&#39; cy=&#39;80&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;40&#39; cy=&#39;16&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;40&#39; cy=&#39;80&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;240&#39; cy=&#39;96&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;240&#39; cy=&#39;128&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;240&#39; cy=&#39;160&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;280&#39; cy=&#39;96&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;280&#39; cy=&#39;112&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;280&#39; cy=&#39;128&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;280&#39; cy=&#39;144&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;circle cx=&#39;280&#39; cy=&#39;160&#39; r=&#39;6&#39; stroke=&#39;currentColor&#39; fill=&#39;#fff&#39;&gt;&lt;/circle&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;0&#39; y=&#39;4&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;x&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;16&#39; y=&#39;52&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;-&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;24&#39; y=&#39;52&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;Ï†&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;56&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;l&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;56&#39; y=&#39;84&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;Î¼&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;64&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;o&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;72&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;g&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;88&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;Ïƒ&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;96&#39; y=&#39;20&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;Â²&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;96&#39; y=&#39;132&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;z&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;96&#39; y=&#39;196&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;p&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;104&#39; y=&#39;196&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;(&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;112&#39; y=&#39;132&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;=&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;112&#39; y=&#39;196&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ›†&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;120&#39; y=&#39;196&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;)&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;120&#39; y=&#39;276&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ›†&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;128&#39; y=&#39;132&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;Î¼&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;136&#39; y=&#39;276&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;d&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;144&#39; y=&#39;132&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;+&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;144&#39; y=&#39;276&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;152&#39; y=&#39;276&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;s&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;160&#39; y=&#39;132&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;Ïƒ&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;160&#39; y=&#39;196&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;s&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;160&#39; y=&#39;276&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;t&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;168&#39; y=&#39;196&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;m&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;168&#39; y=&#39;276&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;r&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;176&#39; y=&#39;132&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ›†&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;176&#39; y=&#39;196&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;a&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;176&#39; y=&#39;276&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;184&#39; y=&#39;196&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;p&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;184&#39; y=&#39;276&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;b&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;192&#39; y=&#39;196&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;l&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;192&#39; y=&#39;276&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;u&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;200&#39; y=&#39;196&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;200&#39; y=&#39;276&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;t&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;208&#39; y=&#39;196&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;n&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;208&#39; y=&#39;276&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;216&#39; y=&#39;196&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;g&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;216&#39; y=&#39;276&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;o&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;224&#39; y=&#39;276&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;n&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;232&#39; y=&#39;196&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;L&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;240&#39; y=&#39;84&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;z&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;248&#39; y=&#39;132&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;-&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;248&#39; y=&#39;260&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;ğ›†&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;256&#39; y=&#39;132&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;Î¸&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;264&#39; y=&#39;132&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;-&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;280&#39; y=&#39;84&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;x&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;336&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;R&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;344&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;e&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;352&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;c&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;352&#39; y=&#39;132&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;c&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;352&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;l&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;360&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;o&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;360&#39; y=&#39;132&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;t&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;360&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;o&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;368&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;n&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;368&#39; y=&#39;132&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;i&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;368&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;s&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;376&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;s&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;376&#39; y=&#39;132&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;o&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;376&#39; y=&#39;148&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;s&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;384&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;t&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;384&#39; y=&#39;132&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;n&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;392&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;r&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;400&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;u&lt;/text&gt;
&lt;text text-anchor=&#39;middle&#39; x=&#39;408&#39; y=&#39;116&#39; fill=&#39;currentColor&#39; style=&#39;font-size:1em&#39;&gt;-&lt;/text&gt;
&lt;/g&gt;

    &lt;/svg&gt;
  
&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Such that the Monte Carlo estimate of the expectation is differentiable w.r.t. Ï†.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The reasoning is as follows:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;For infinitesimals, there is $$q_Ï†(ğ³|ğ±)âˆáµ¢dzáµ¢ = p(\pmb Îµ)âˆáµ¢dÎµáµ¢$$;
where záµ¢ is one of dimensions, dğ³ = âˆáµ¢ dzáµ¢&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Therefore, $âˆ« q_Ï†(ğ³|ğ±) f(ğ³) dğ³$ = âˆ«p(ğ›†) f(ğ³) dğ›† = âˆ« p(ğ›†) $f(g_Ï†$(ğ›†,ğ±)) dğ›†&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Use Monte Carlo sampling approximation: $âˆ« q_Ï†(ğ³|ğ±) f(ğ³) dğ³$ â‰ƒ 1/L âˆ‘â‚—â‚Œâ‚á´¸ f( gáµ©(ğ›†â½Ë¡â¾, ğ±)), where ğ›†â½Ë¡â¾ ~ p(ğ›†)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The transformation (Ï†) from ğ›† to ğ³ can be learned by back-propagation and gradient descent from the reconstruction loss, since the transformation differentiable.&lt;/p&gt;
&lt;p&gt;So the parameters (e.g. Î¼,Ïƒ) of the approximate posterior distribution $q_Ï†(ğ³|ğ±)$ of ğ³ can be optimized through Ï†, and the parameter Î¸ of the generative model is trained jointly.&lt;/p&gt;
&lt;p&gt;This&amp;rsquo;s just a trick, the essence of the algorithm is still the coordinate ascent:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Sample a ğ³ by sampling an ğ›†:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;reparameterize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;logvar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# logvar is logğ›”Â²&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;n&#34;&gt;std&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;logvar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# (e^{logğ›”Â²})^Â½&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;n&#34;&gt;eps&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;randn_like&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mu&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;eps&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Use ğ³ to generate ğ± with model $p_Î¸(ğ±|ğ³)$,&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;n&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;linear&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;latent_dim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;hidden_dims&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;result&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;then use ğ± to produce ğ³ with model $q_Ï†(ğ³|ğ±)$&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;n&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;linear&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;input_dim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;hidden_dim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;n&#34;&gt;mu&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Linear&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hidden_dim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;latent_dim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;n&#34;&gt;logvar&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Linear&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hidden_dim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;latent_dim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;logvar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;With using reparameterization trick, both the two models can be optimized by gradient descent.&lt;/p&gt;
&lt;p&gt;(2024-04-16)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Reparameterization trick is a sampling method. It&amp;rsquo;s similar to inverse transform sampling: using a known distribution (uniform) to sample an unknown distribution.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Reparameterization trick makes the sampling from an unknown distribution differentiable,
and enables the parameters of the distribution to be optimized.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;loss-func&#34;&gt;Loss func&lt;/h3&gt;
&lt;p&gt;Loss function contains two parts: KL divergence and reconstruction error.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;KL divergence (i.e., cross entropy) can be computed with given the prior and assumed posterior of ğ³.&lt;/p&gt;
&lt;p&gt;For example, let the prior $\rm p_Î¸(ğ³) = N(ğ³,ğŸ,ğˆ)$ and assume the posterior qáµ©(ğ³|ğ±) = N(ğ³; ğ›, ğ›”Â²ğˆ),
then cross entropy can be derived by plugging them into Gaussian expression.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The reconstruction error is the log likelihood of the input datapoint log p(ğ±|ğ³).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;For a datapoint obeying multivariate Bernoulli (Yes or No), the log likelihood of ğ± is&lt;/p&gt;
&lt;p&gt;$$
log p(ğ±|ğ³) = log âˆáµ¢â‚Œâ‚á´° yáµ¢Ë£â± (1-yáµ¢)Â¹â»Ë£â±  \\
\          = âˆ‘áµ¢â‚Œâ‚á´° [ xáµ¢log yáµ¢ + (1-xáµ¢)log (1-yáµ¢) ]
$$&lt;/p&gt;
&lt;p&gt;where yáµ¢ should be like a probability (need to do sigmoid activation).
So in this case, this loss term is a cross entropy.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;For a datapoint following multivariate Gaussian distribution N(ğ±; ğ›, ğ›”Â²ğˆ), refer to &lt;a class=&#34;link&#34; href=&#34;https://www.kexue.fm/archives/5343&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Su, Jianlin&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;$$
\begin{aligned}
&amp;amp;p(ğ±|ğ³) = \frac{1}{âˆáµ¢â‚Œâ‚á´° \sqrt{2Ï€Ïƒáµ¢Â²(ğ³)}}
\rm exp(-\frac{1}{2} â€–\frac{x-\pmb Î¼(ğ³)}{\pmb Ïƒ(ğ³)}â€–Â²) \\
\            \\
&amp;amp;log\ p(ğ±|ğ³) \\
&amp;amp;= log \frac{1}{âˆáµ¢â‚Œâ‚á´° \sqrt{2Ï€Ïƒáµ¢Â²(ğ³)}}
\ -\frac{1}{2} â€–\frac{x-\pmb Î¼(ğ³)}{\pmb Ïƒ(ğ³)}â€–Â² \\
&amp;amp;= -âˆ‘áµ¢â‚Œâ‚á´° log \sqrt{2Ï€Ïƒáµ¢Â²(ğ³)} -\frac{1}{2} â€–\frac{x-\pmb Î¼(ğ³)}{\pmb Ïƒ(ğ³)}â€–Â² \\
&amp;amp;= -âˆ‘áµ¢â‚Œâ‚á´° [\frac{1}{2} (log2Ï€ + logÏƒáµ¢Â²(ğ³))] - \frac{1}{2} â€–\frac{x-\pmb Î¼(ğ³)}{\pmb Ïƒ(ğ³)}â€–Â² \\
&amp;amp;= -\frac{D}{2} log2Ï€ -âˆ‘áµ¢â‚Œâ‚á´°logÏƒáµ¢Â²(ğ³) -\frac{1}{2} â€–\frac{x-\pmb Î¼(ğ³)}{\pmb Ïƒ(ğ³)}â€–Â² \\
\end{aligned}
$$&lt;/p&gt;
&lt;p&gt;Normally, the variance ğ›”Â² will be fixed, so this loss term is only related with mean ğ›(ğ³):&lt;/p&gt;
&lt;p&gt;-log p(ğ±|ğ³) ~ $\frac{1}{2\pmb ÏƒÂ²}\| ğ±-\pmb Î¼(ğ³) \|Â²$&lt;/p&gt;
&lt;p&gt;Therefore, this loss term is MSE.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        <item>
        <title>read: Blog - è‹å‰‘æ— | VAE-3</title>
        <link>https://zichen34.github.io/writenotes/model/imagen/vae/d-note-vae_3-su/</link>
        <pubDate>Sun, 01 Jan 2023 22:48:00 +0000</pubDate>
        
        <guid>https://zichen34.github.io/writenotes/model/imagen/vae/d-note-vae_3-su/</guid>
        <description>&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.kexue.fm/archives/5383&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆä¸‰ï¼‰ï¼šè¿™æ ·åšä¸ºä»€ä¹ˆèƒ½æˆï¼Ÿ&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;é‡‡æ ·ä¸€æ¬¡å°±å¤Ÿ&#34;&gt;é‡‡æ ·ä¸€æ¬¡å°±å¤Ÿ&lt;/h2&gt;
&lt;p&gt;å…ˆæ¨æ–­å­¦ä¹  z çš„åéªŒåˆ†å¸ƒ p(z|x) çš„å‚æ•°ï¼Œå†ä»åˆ†å¸ƒä¸­é‡‡æ ·ä¸€ä¸ª zï¼Œç”¨å®ƒè®¡ç®— x çš„åéªŒåˆ†å¸ƒ p(x|z) çš„å‚æ•°ï¼Œå†ç®—ä»xçš„åéªŒåˆ†å¸ƒä¸­é‡‡æ ·å¾—åˆ° xâ€˜çš„æ¦‚ç‡ï¼Œ&lt;/p&gt;
&lt;p&gt;åœ¨ VAE çš„æŸå¤±å‡½æ•°ï¼šğ“› = ğ”¼_pá¢(x) [ KL( p(z|x)||q(z) ) + ğ”¼_p(z|x) [ -ln q(x|z) ] ]ä¸­ï¼Œ&lt;/p&gt;
&lt;p&gt;KLæ•£åº¦çš„è®¡ç®—æ˜¯ä½¿ç”¨ç¥ç»ç½‘ç»œæ‹Ÿåˆå‡ºçš„zçš„åéªŒåˆ†å¸ƒï¼ˆæ­£æ€åˆ†å¸ƒï¼‰çš„æœŸæœ›å’Œæ–¹å·®ï¼Œ
è€Œç¬¬ 2 é¡¹åªé‡‡äº†ä¸€ä¸ªæ ·æœ¬ x åšè¿‘ä¼¼ï¼Œæ‰€ä»¥è¿™ä¸€é¡¹å˜ä¸ºï¼š-ln q(x|z), z~p(z|x)&lt;/p&gt;
&lt;p&gt;å› ä¸º KL æ•£åº¦ä¹Ÿå¯å†™æˆæœŸæœ›ï¼šE_p(z|x) [ ln (p(z|x)/q(z)) ]ï¼Œæ‰€ä»¥å®ƒä¹Ÿå¯ä»¥åªé‡‡æ ·ä¸€ä¸ªç‚¹æ¥è¿‘ä¼¼ã€‚æ‰€ä»¥æŸå¤±å‡½æ•°å°±å¯å†™ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;ğ“› = ğ”¼_pá¢(x) [ ln p(z|x) - ln q(z) - ln q(x|z) ], z~p(z|x)          (5)&lt;/p&gt;
&lt;p&gt;è‹ç¥è¯´ï¼Œä»¥ä¸Šçš„æŸå¤±å‡½æ•°ä¹Ÿèƒ½æ”¶æ•›åˆ°ç›¸ä¼¼çš„ç»“æœã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¼¼ç„¶ä¸èƒ½åªç”¨ä¸€ä¸ªé‡‡æ ·ç‚¹ä¼°è®¡&#34;&gt;ä¼¼ç„¶ä¸èƒ½åªç”¨ä¸€ä¸ªé‡‡æ ·ç‚¹ä¼°è®¡&lt;/h2&gt;
&lt;p&gt;æå¤§ä¼¼ç„¶çš„å…¬å¼å¯ä»¥å†™æˆæœŸæœ›ï¼š
q(x|z) &lt;br&gt;
= arg max_q(x|z) âˆ« pá¢(x) ln (âˆ« q(x|z) q(z) dz) dx ï¼Œæ•°å€¼è®¡ç®—ï¼Œè¦ä¹˜xçš„æ¦‚ç‡&lt;br&gt;
= arg max_q(x|z) ğ”¼_pá¢(x) [ ln ( âˆ« q(x|z) q(z) dz) ] ï¼Œé‡‡æ ·è¿‘ä¼¼æ±‚ç§¯åˆ†&lt;br&gt;
= arg max_q(x|z) ğ”¼_pá¢(x) [ ln (1/K âˆ‘_â‚–â‚Œâ‚á´· q(x|zâ‚–) ], z1,z2,&amp;hellip;,2â‚–ï½q(z)&lt;/p&gt;
&lt;p&gt;å¯¹è¿™ä¸ªæœŸæœ›è¿‘ä¼¼ï¼šå…ˆä»å…ˆéªŒ q(z) ä¸­é‡‡ k ä¸ª zï¼Œç®—ç§¯åˆ†ï¼ˆæ±‚å’Œï¼‰ï¼Œå†é‡‡ 1 ä¸ª xï¼Œæ±‚å®ƒçš„æ¦‚ç‡çš„å¯¹æ•°å°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;p&gt;shuhuai è¯´æ˜¯å› ä¸º log çš„æ–¹å·®å¤§ï¼Œæ‰€ä»¥é‡‡æ ·å¤ªå°‘ä¼šå¤±æ•ˆã€‚
è‹ç¥è¯´ï¼Œå› ä¸ºz å’Œ x æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œå¦‚æœæ²¡æœ‰é‡‡åˆ° zâ‚–ï¼Œé‚£å®ƒå¯¹åº”çš„ xâ‚– ä¹Ÿå°±é‡‡ä¸å‡ºæ¥ï¼Œæ¦‚ç‡å°±ç®—ä¸å‡ºæ¥ï¼Œå› ä¸ºé‡‡æ ·æ˜¯éšæœºçš„ï¼Œä¸èƒ½ä¿è¯æ¯æ¬¡é‡‡çš„ k ä¸ª zï¼ŒåŒ…å«äº†æœ¬ batch ä¸­æ‰€æœ‰ x å¯¹åº”çš„ zï¼Œæ‰€ä»¥å®¹æ˜“å¤±æ•ˆã€‚&lt;/p&gt;
&lt;h2 id=&#34;vaeé‡‡ä¸€ä¸ªç‚¹ç¡®å®å¤Ÿäº†&#34;&gt;VAEé‡‡ä¸€ä¸ªç‚¹ç¡®å®å¤Ÿäº†&lt;/h2&gt;
&lt;p&gt;æ ¹æ®å¯¹æ•°æ®é›†çš„äº†è§£ï¼Œæ•°æ®é›†Xæœ¬èº«å¸¦æœ‰å¾ˆå¼ºçš„çº¦æŸï¼ŒçœŸæ­£ç‹¬ç«‹çš„ç»´åº¦å¾ˆå°‘ï¼Œæ‰€ä»¥æ•°æ®é›†å¯ä»¥è¢«æŠ•å½±åˆ°ä½ç»´ç©ºé—´çš„ä¸€ä¸ªéšå˜é‡ä¸Šã€‚
è¿™å’Œæ™®é€šçš„è‡ªç¼–ç å™¨ä¸€æ ·ï¼Œä¹Ÿå°±æ˜¯ z ä¸ x ä¸€ä¸€å¯¹åº”ï¼Œä¹Ÿå°±æ„å‘³è¿™ p(z|x) å’Œ q(x|z) çš„æ–¹å·®ä¸º0ã€‚
åœ¨å¼•å…¥æ ‡å‡†æ­£æ€å½¢å¼çš„å…ˆéªŒåˆ†å¸ƒ q(z) åï¼Œç²—ç•¥åœ°çœ‹ï¼Œåªæ˜¯å¯¹éšå˜é‡ç©ºé—´åšäº†å¹³ç§»å’Œç¼©æ”¾ï¼Œæ‰€ä»¥æ–¹å·®ä¹Ÿå¯ä»¥ä¸å¤§ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸º x çš„åéªŒåˆ†å¸ƒçš„æ–¹å·®å¾ˆå°ï¼Œæ¯æ¬¡é‡‡çš„ç»“æœéƒ½ä¸€æ ·ï¼Œéƒ½æ˜¯å‡å€¼ Î¼(z)ã€‚
å› ä¸º z ä¸ x æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œæ‰€ä»¥ z çš„åéªŒåˆ†å¸ƒçš„æ–¹å·®ä¹Ÿå¾ˆå°ï¼Œæ‰€ä»¥æ¯æ¬¡ä»ä¸­é‡‡çš„ z éƒ½ç›¸åŒã€‚
æ‰€ä»¥é‡‡æ ·ä¸€æ¬¡ï¼Œä¸é‡‡æ ·å¤šæ¬¡æ²¡ä»€ä¹ˆå·®åˆ«ï¼ŒæœŸæœ›éƒ½æ˜¯ä¸€æ ·çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åéªŒä¹‹å¦™&#34;&gt;åéªŒä¹‹å¦™&lt;/h2&gt;
&lt;p&gt;ç›´æ¥ä»å…ˆéªŒ q(z) ä¸­é‡‡æ ·ä¸å¯è¡Œï¼Œä½†åœ¨åéªŒåˆ†å¸ƒ p(z|x) ä¸­é‡‡æ ·ä¸€ä¸ªç‚¹å°±å¤Ÿäº†ï¼Œ
å› ä¸ºè‡ªç¼–ç å™¨é‡Œçš„æ–¹å·®ä¸º0ï¼Œå¼•å…¥ z çš„å…ˆéªŒï¼ˆæ ‡å‡†æ­£æ€åˆ†å¸ƒï¼‰ï¼Œæ–¹å·®ä¹Ÿä¸ä¼šå¤ªå¤§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è€¿ç›´çš„iwae&#34;&gt;è€¿ç›´çš„IWAE&lt;/h2&gt;
&lt;p&gt;é‡è¦æ€§åŠ æƒè‡ªç¼–ç å™¨ Importance Weighted AutoEncoders &lt;a class=&#34;link&#34; href=&#34;https://arxiv.org/pdf/1509.00519v1.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;arxiv&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯¹ p(x) åšäº†ç­‰ä»·å˜æ¢ï¼šä¹˜ä¸€ä¸ªp(z|x),é™¤ä¸€ä¸ª p(z|x)&lt;/p&gt;
&lt;p&gt;p(x) = âˆ« q(x|z) q(z) dz  &lt;br&gt;
= âˆ« p(z|x) â‹… [q(x|z) â‹… q(z)] / p(z|x) dz  &lt;br&gt;
= ğ”¼_p(z|x) [ q(x|z) â‹… q(z) / p(z|x) ]&lt;/p&gt;
&lt;p&gt;è¿™æ ·ï¼Œä» q(z) ä¸­é‡‡æ ·å°±å˜æˆäº†ä» p(z|x) ä¸­é‡‡æ ·ï¼Œæ­¤å‰å·²è®ºè¿°äº†åéªŒåˆ†å¸ƒ p(z|x) æ–¹å·®è¾ƒå°ï¼Œæ‰€ä»¥é‡‡æ ·å‡ ä¸ªç‚¹å°±å¤Ÿäº†ï¼š&lt;/p&gt;
&lt;p&gt;âˆ« q(x|z) q(z) dz = 1/k âˆ‘â‚–â‚Œâ‚á´· [ q(x|zâ‚–)q(zâ‚–)/p(zâ‚–|x) ], z1,z2,..,zâ‚–ï½p(z|x)&lt;/p&gt;
&lt;p&gt;ä»£å…¥ä¼¼ç„¶å‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;q(x|z)
= arg max_q(x|z) ğ”¼_pá¢(x) [ ln ( âˆ« q(x|z) q(z) dz) ] &lt;br&gt;
= arg max_q(x|z) ğ”¼_pá¢(x) [ ln ( 1/k âˆ‘â‚–â‚Œâ‚á´· [ q(x|zâ‚–)q(zâ‚–)/p(zâ‚–|x) ] ) ]&lt;br&gt;
= arg min_{q(x|z),p(z|x)} ğ”¼_pá¢(x) [ -ln ( 1/k âˆ‘â‚–â‚Œâ‚á´· [ q(x|zâ‚–)q(zâ‚–)/p(zâ‚–|x) ] ) ], z1,z2,..,zâ‚–ï½p(z|x) ï¼ŒåŠ ä¸ªè´Ÿå·ï¼Œæ±‚æå°å€¼ã€‚&lt;/p&gt;
&lt;p&gt;å½“ k=1 æ—¶ï¼Œä¸ (5) å¼ä¸€æ ·ï¼Œä»è¿™ä¸ªè§’åº¦çœ‹ï¼ŒIWAE æ˜¯VAEçš„å‡çº§ç‰ˆã€‚&lt;/p&gt;
&lt;p&gt;å…¶å®ï¼Œç­‰ä»·å˜æ¢å¯ä»¥ä½¿ç”¨ z çš„ä»»æ„åˆ†å¸ƒï¼ˆåªè¦èƒ½é‡‡å‡ºzå°±è¡Œï¼‰ï¼Œ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;â€œé€‰æ‹© p(z|x) åªæ˜¯å› ä¸ºå®ƒæœ‰èšç„¦æ€§ï¼Œä¾¿äºé‡‡æ ·ã€‚è€Œå½“ k è¶³å¤Ÿå¤§æ—¶ï¼Œp(z|x) çš„å…·ä½“å½¢å¼å°±ä¸é‡è¦äº†â€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;IWAE ä¸­å‰Šå¼±äº†æ¨æ–­æ¨¡å‹ p(z|x) çš„ä½œç”¨ï¼Œä¸å»è¿‘ä¼¼åéªŒåˆ†å¸ƒ&lt;/p&gt;
</description>
        </item>
        <item>
        <title>read: Blog - è‹å‰‘æ— | VAE-2</title>
        <link>https://zichen34.github.io/writenotes/model/imagen/vae/d-note-vae_2-su/</link>
        <pubDate>Fri, 30 Dec 2022 20:07:00 +0000</pubDate>
        
        <guid>https://zichen34.github.io/writenotes/model/imagen/vae/d-note-vae_2-su/</guid>
        <description>&lt;p&gt;ç¬”è®° for &lt;a class=&#34;link&#34; href=&#34;https://www.kexue.fm/archives/5343&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆäºŒï¼‰ï¼šä»è´å¶æ–¯è§‚ç‚¹å‡ºå‘&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;æ•°å€¼è®¡ç®—-vs-é‡‡æ ·è®¡ç®—&#34;&gt;æ•°å€¼è®¡ç®— vs é‡‡æ ·è®¡ç®—&lt;/h2&gt;
&lt;p&gt;æ•°å€¼è®¡ç®—æ˜¯å…ˆç»™ä¸ªæ•°åˆ—ï¼Œå¯¹é‡Œé¢çš„æ¯ä¸ªæ•°æ±‚æ¦‚ç‡p(xâ½â±â¾)ï¼Œå†åŠ æƒæ±‚å’Œ âˆ‘áµ¢â‚Œâ‚€â¿ xâ½â±â¾p(xâ½â±â¾) (xâ½â±â¾-xâ½â±â»Â¹â¾)ï¼›
é‡‡æ ·è®¡ç®—æ˜¯å…ˆä»åˆ†å¸ƒä¸­é‡‡æ ·ï¼Œæ±‚é‡‡æ ·ç‚¹æ¦‚ç‡çš„å¹³å‡ï¼Œæ‰€ä»¥ä¸éœ€è¦å†ä¹˜æ ·æœ¬ç‚¹å‡ºç°çš„æ¦‚ç‡ï¼šE[x]â‰ˆ1/nâ‹…âˆ‘áµ¢â‚Œâ‚€â¿ xâ½â±â¾, xâ½â±â¾âˆ¼p(x)ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¨å¯¼vae-çš„æŸå¤±å‡½æ•°&#34;&gt;æ¨å¯¼VAE çš„æŸå¤±å‡½æ•°&lt;/h2&gt;
&lt;p&gt;è‹ç¥ä»é€¼è¿‘è”åˆæ¦‚ç‡ p(x,z) å‡ºå‘ï¼Œè€Œä¸æ˜¯ä»é€¼è¿‘zçš„åéªŒ p(z|x) å‡ºå‘ã€‚
ä¹Ÿè®¸æ˜¯å› ä¸ºæ²¿ç€ EM çš„æ€è·¯èµ°ï¼Œå°±éœ€è¦å¯¹åéªŒ p(z|x) æ±‚è¿‘ä¼¼ï¼Œæ‰€ä»¥å¾ˆå¤šäººèšç„¦äºæ¨å¯¼ p(z|x)ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºæƒ³æ±‚æ ·æœ¬é›†åˆ xçš„åˆ†å¸ƒï¼Œ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½†æ˜¯éš¾ä»¥ç›´æ¥æè¿°å¤æ‚åˆ†å¸ƒï¼Œæ‰€ä»¥é€šè¿‡å¼•å…¥éšå˜é‡æŠŠxçš„åˆ†å¸ƒå˜æˆæ¡ä»¶åˆ†å¸ƒçš„å åŠ ï¼Œè€Œåå¯ä»¥å¯¹éšå˜é‡çš„åˆ†å¸ƒå’Œæ¡ä»¶åˆ†å¸ƒåšé€‚å½“ç®€åŒ–ï¼ˆæ¯”å¦‚éƒ½å‡è®¾ä¸ºæ­£æ€åˆ†å¸ƒï¼‰ï¼Œå¹¶ä¸”å¯ä»¥ç”¨æ·±åº¦å­¦ä¹ æ¨¡å‹è¿‘ä¼¼æ±‚ï¼ˆéšå˜é‡ï¼‰æ¡ä»¶åˆ†å¸ƒçš„å‚æ•°ï¼Œå³â€œæ·±åº¦æ¦‚ç‡å›¾æ¨¡å‹â€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å‡è®¾ x æ˜¯ç”± z ç”Ÿæˆçš„ï¼Œæ‰€ä»¥æ±‚ p(x) å¯ä»¥é€šè¿‡æŠŠè”åˆåˆ†å¸ƒ p(x,z) ä¸­çš„ p(z) ç§¯æ‰æ±‚å¾—ï¼š
p(x) = âˆ«p(x,z) dz = âˆ« p(x|z)p(z) dz&lt;/p&gt;
&lt;p&gt;ç›®æ ‡æ˜¯ç”¨ä¸€ä¸ª q(x,z) é€¼è¿‘ p(x,z)ï¼Œåˆå› ä¸º p(z) æ˜¯å…ˆéªŒï¼ˆå·²çŸ¥ï¼‰ï¼Œæ‰€ä»¥å½“ q(x,z)â‰ˆp(x,z) æ—¶ï¼Œ&lt;strong&gt;ç”Ÿæˆæ¨¡å‹ p(x|z)&lt;/strong&gt; ä¹Ÿå°±å­¦åˆ°äº†ï¼Œâ€œä¸€ä¸¾ä¸¤å¾—â€ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡æœ€å°åŒ– KL æ•£åº¦é€¼è¿‘ï¼šKL( p(x,z) || q(x,z) ) = âˆ«âˆ« p(x,z) [ ln (p(x,z)/q(x,z)) ] dz dxï¼Œæ˜¯ä¸€ä¸ªäºŒé‡ç§¯åˆ†&lt;/p&gt;
&lt;p&gt;æŠŠ p(x,z) å†™æˆ pá¢(x)â‹…p(z|x)ï¼Œä¹Ÿå°±æ˜¯&lt;strong&gt;æ¨æ–­è¿‡ç¨‹&lt;/strong&gt;ï¼Œç”±xçš„å…ˆéªŒæ¨å‡ºzï¼š&lt;/p&gt;
&lt;p&gt;KL( p(x,z) || q(x,z) )
= âˆ«âˆ« pá¢(x)â‹…p(z|x) [ ln ( pá¢(x)â‹…p(z|x) / q(x,z) ) ] dz dx  &lt;br&gt;
= âˆ« pá¢(x) [ âˆ« p(z|x) â‹… ln ( pá¢(x)â‹…p(z|x) / q(x,z) ) dz ] dx  &lt;br&gt;
= ğ”¼_pá¢(x) [ âˆ« p(z|x) â‹… ln ( pá¢(x)â‹…p(z|x) / q(x,z) ) dz]&lt;/p&gt;
&lt;p&gt;å¯ä»¥è’™ç‰¹å¡ç½—é‡‡æ ·è¿‘ä¼¼æ±‚è¿™ä¸ªæœŸæœ›ï¼Œä¹Ÿå°±æ˜¯æŠŠæ¯ä¸ªæ ·æœ¬ xâ½â±â¾ ä»£å…¥ä¸Šé¢ä¸­æ‹¬å·é‡Œçš„å‡½æ•°ï¼ˆä»£å…¥æ¦‚ç‡å¯†åº¦å…¬å¼å¯ç®—å‡ºæ¦‚ç‡å€¼ï¼‰ï¼ŒæŠŠå‡½æ•°å€¼æ±‚å‡å€¼ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæœŸæœ›å¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–ï¼ŒæŠŠ ln æ‹†å¼€ï¼š
ln ( pá¢(x)â‹…p(z|x) / q(x,z) ) = ln pá¢(x) + ln (p(z|x)/q(x,z))&lt;/p&gt;
&lt;p&gt;ğ”¼_pá¢(x) [ âˆ« p(z|x) â‹… ln ( pá¢(x)â‹…p(z|x) / q(x,z) ) dz ] &lt;br&gt;
= ğ”¼_pá¢(x) [ âˆ« p(z|x) â‹… ln pá¢(x) dz] +
ğ”¼_pá¢(x) [ âˆ« p(z|x) â‹… ln (p(z|x)/q(x,z)) dz]&lt;/p&gt;
&lt;p&gt;ä¸Šé¢ç¬¬ 1 ä¸ªæœŸæœ›ï¼š
ğ”¼_pá¢(x) [ âˆ« p(z|x) â‹… ln pá¢(x) dz] = ğ”¼_pá¢(x) [ ln pá¢(x)â‹…âˆ« p(z|x) dz ]
= ğ”¼_pá¢(x) [ ln pá¢(x) ]&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçš„ pá¢(x) æ˜¯æ ¹æ®æ ·æœ¬ xâ½â°â¾, xâ½Â¹â¾,&amp;hellip;, xâ½â¿â¾ ç¡®å®šçš„å…³äº x çš„å…ˆéªŒåˆ†å¸ƒï¼Œæ˜¯å·²çŸ¥çš„ç¡®å®šçš„ï¼Œæ‰€ä»¥è¿™ä¸€é¡¹æ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚
æ‰€ä»¥ KL æ•£åº¦ = å¸¸æ•° + ä¸€ä¸ªæœŸæœ›ï¼š&lt;/p&gt;
&lt;p&gt;KL( p(x,z) || q(x,z) ) = å¸¸æ•° + ğ”¼_pá¢(x) [ âˆ« p(z|x) â‹… ln (p(z|x)/q(x,z)) dz]&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æœ€å°åŒ–KLæ•£åº¦ï¼Œå¯¹åº”ç›®æ ‡å‡½æ•° ğ“› å°±æ˜¯ç¬¬2ä¸ªæœŸæœ›ï¼š&lt;/p&gt;
&lt;p&gt;ğ“› = KL( p(x,z) || q(x,z) ) - å¸¸æ•°ï¼Œåˆ™ğ“› çš„ä¸‹ç•Œå°±æ˜¯&amp;quot;-å¸¸æ•°&amp;quot;: -ğ”¼_pá¢(x) [ ln pá¢(x) ]ï¼Œ
å…¶ä¸­ pá¢(x) ä¸ä¸€å®šæ˜¯æ¦‚ç‡ï¼Œåœ¨è¿ç»­æƒ…å†µæ—¶ï¼Œpá¢(x) æ˜¯æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œå®ƒå¯ä»¥å¤§äº1 ä¹Ÿå¯ä»¥å°äº1ï¼Œæ‰€ä»¥ä¸‹ç•Œä¸ä¸€å®šæ˜¯éè´Ÿçš„ï¼Œå³ loss å¯èƒ½æ˜¯è´Ÿæ•°ã€‚&lt;/p&gt;
&lt;p&gt;å†æŠŠ ğ“› é‡Œçš„ ln å’Œ q(x,z) å±•å¼€ï¼š&lt;/p&gt;
&lt;p&gt;ğ“› = ğ”¼_pá¢(x) [ âˆ« p(z|x) â‹… ln ( p(z|x) / q(x,z) ) dz]  &lt;br&gt;
= ğ”¼_pá¢(x) [ âˆ« p(z|x) â‹… ln ( p(z|x) / (q(x|z)q(z)) dz ]  &lt;br&gt;
= ğ”¼_pá¢(x) [ âˆ« p(z|x) â‹… ln ( p(z|x)/q(z) ) dz - âˆ« p(z|x) â‹… ln q(x|z) dz]&lt;/p&gt;
&lt;p&gt;æŠŠé‡Œé¢çš„ç§¯åˆ†å†™æˆæœŸæœ›ï¼š&lt;/p&gt;
&lt;p&gt;ğ“› = ğ”¼_pá¢(x) [ KL( p(z|x)||q(z) ) + ğ”¼_p(z|x) [ -ln q(x|z) ] ]&lt;/p&gt;
&lt;p&gt;æ‹¬å·é‡Œçš„å°±æ˜¯ VAE çš„æŸå¤±å‡½æ•°ï¼šKLæ•£åº¦ï¼ˆæ­£åˆ™åŒ–é¡¹ï¼‰+ xçš„åéªŒæŒ‰ç…§ z çš„åéªŒæ±‚æœŸæœ› &lt;a class=&#34;link&#34; href=&#34;../ML-%e7%99%bd%e6%9d%bf%e6%8e%a8%e5%af%bc%e7%b3%bb%e5%88%97/32-VAE.md&#34; &gt;shuhuai008-30VAE&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸èƒ½æŠŠæ‹¬å·é‡Œé¢çš„ä¸¤é¡¹åˆ†å¼€çœ‹æˆ–åˆ†å¼€æœ€å°åŒ–ã€‚
å¦‚æœåªä»¤ KL( p(z|x)||q(z) )=0ï¼Œå³æ¯ä¸ªåéªŒéƒ½æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œä¸xæ— å…³ï¼Œå¯¼è‡´ç”Ÿæˆçš„ x ä¸å‡†ï¼Œæ¦‚ç‡ q(x|z) ä¼šå¾ˆå°ï¼Œ-ln q(x|z) å°±ä¼šå¾ˆå¤§ã€‚
è€Œå¦‚æœ -ln q(x|z) å¾ˆå°ï¼Œå³xåéªŒæ¦‚ç‡ q(x|z) å¤§ï¼ŒåéªŒåˆ†å¸ƒ p(z|x) çš„å³°è‚¯å®šé›†ä¸­åœ¨ x é™„è¿‘ï¼Œå³ p(z|x) çš„æ–¹å·®å°ï¼Œä¸æ ‡å‡†æ­£æ€çš„å·®è·å¤§ï¼ŒKL( p(z|x)||q(z) ) ä¸ä¼šå°ã€‚
æ‰€ä»¥è¿™ä¸¤éƒ¨åˆ† loss æ˜¯ç›¸äº’æ‹®æŠ—çš„ï¼Œğ“› è¦ä»¥æ•´ä½“æ¥çœ‹ã€‚
ä¹Ÿå°±æ˜¯è¦æ¨æ–­è¿‡ç¨‹ä¸ç”Ÿæˆè¿‡ç¨‹ç›¸äº’åšå¼ˆã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç®—æ³•è®¾è®¡&#34;&gt;ç®—æ³•è®¾è®¡&lt;/h2&gt;
&lt;p&gt;æŸå¤±å‡½æ•°ä¸­æœªçŸ¥çš„åˆ†å¸ƒåŒ…æ‹¬ï¼šz çš„å…ˆéªŒ q(z)ï¼Œz çš„åéªŒ p(z|x)ï¼Œx çš„åéªŒ q(x|z) ï¼ˆx çš„å…ˆéªŒpá¢(x) æ˜¯å·²çŸ¥çš„ï¼‰&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ä¸ºäº†ä¾¿äºé‡‡æ ·ï¼Œå‡è®¾ z çš„å…ˆéªŒåˆ†å¸ƒä¸ºæ ‡å‡†å¤šå…ƒæ­£æ€åˆ†å¸ƒï¼šq(z)=N(0,I)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”¨ç¥ç»ç½‘ç»œæ‹Ÿåˆ z çš„åéªŒ p(z|x) å’Œ x çš„åéªŒ q(x|z)ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è®¡ç®— z çš„åéªŒæ˜¯æ¨æ–­è¿‡ç¨‹ï¼Œå¯¹åº” EM çš„ Eæ­¥ï¼šè¿‘ä¼¼æ±‚å¾— p(z|x)ï¼›è®¡ç®— x çš„åéªŒæ˜¯ç”Ÿæˆè¿‡ç¨‹ï¼Œå¯¹åº” EM çš„ Mæ­¥ï¼šæŠŠzçš„è¿‘ä¼¼åéªŒä»£å…¥ä¼¼ç„¶å‡½æ•°ï¼Œæ±‚æå¤§ä¼¼ç„¶æ—¶ï¼Œå¯¹åº”çš„æ¨¡å‹å‚æ•°ã€‚
ï¼ˆEMä¸­ç”¨äºé€¼è¿‘ p(z|x) çš„ç¥ç»ç½‘ç»œçš„å‚æ•°æ˜¯ Ï•ï¼›ç”¨äºé€¼è¿‘ q(x|z) çš„ç¥ç»ç½‘ç»œï¼ˆä¹Ÿå¯ç›´æ¥æ±‚å¯¼ï¼‰çš„å‚æ•°æ˜¯ Î¸ï¼‰&lt;/p&gt;
&lt;h3 id=&#34;åéªŒåˆ†å¸ƒè¿‘ä¼¼&#34;&gt;åéªŒåˆ†å¸ƒè¿‘ä¼¼&lt;/h3&gt;
&lt;p&gt;å‡è®¾ z çš„åéªŒæ˜¯ï¼ˆå„åˆ†é‡ç‹¬ç«‹çš„ï¼‰ä¸€èˆ¬æ­£æ€åˆ†å¸ƒï¼Œæ‰€ä»¥éœ€è¦ç¥ç»ç½‘ç»œé€¼è¿‘å®ƒçš„æœŸæœ›å’Œæ–¹å·®ã€‚æœŸæœ›å’Œæ–¹å·®éƒ½ç”± x å†³å®šï¼Œå³æ˜¯ x çš„å‡½æ•° Î¼_Ï•(x), Î£_Ï•(x)&lt;/p&gt;
&lt;p&gt;ç„¶å KL æ•£åº¦å°±å¯ä»¥å†™å‡ºæ¥äº†: 1/2(-logÏƒÂ² + Î¼Â² + ÏƒÂ² -1)ï¼Œå·²åœ¨VAEç¬¬ä¸€ç¯‡æ¨å¯¼è¿‡ã€‚&lt;a class=&#34;link&#34; href=&#34;https://www.kexue.fm/archives/5253&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆä¸€ï¼‰ï¼šåŸæ¥æ˜¯è¿™ä¹ˆä¸€å›äº‹&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;ç”Ÿæˆæ¨¡å‹è¿‘ä¼¼&#34;&gt;ç”Ÿæˆæ¨¡å‹è¿‘ä¼¼&lt;/h3&gt;
&lt;p&gt;å¯¹äºç”Ÿæˆæ¨¡å‹éƒ¨åˆ† q(x|z) çš„å‡è®¾ï¼ŒåŸä½œè€…åœ¨è®ºæ–‡&lt;a class=&#34;link&#34; href=&#34;https://arxiv.org/abs/1312.6114&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ã€ŠAuto-Encoding Variational Bayesã€‹&lt;/a&gt;ä¸­ï¼Œç»™å‡ºäº†ä¸¤ç§æ–¹æ¡ˆï¼šäºŒé¡¹åˆ†å¸ƒæˆ–æ­£æ€åˆ†å¸ƒã€‚â€œæ—¢è¦æ»¡è¶³æ¦‚ç‡çš„å®šä¹‰ï¼ˆå½’ä¸€åŒ–ï¼‰ï¼Œåˆè¦å®¹æ˜“ç®—ï¼Œæ²¡å¤šå°‘é€‰æ‹©â€&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;äºŒé¡¹åˆ†å¸ƒ&lt;/strong&gt;åªæœ‰ä¸€ä¸ªå‚æ•°ï¼š&amp;ldquo;æŠ›ç¡¬å¸å‘ä¸Šçš„æ¦‚ç‡ Ï&amp;rdquo;ã€‚æ‰€ä»¥å¯¹äºä¸€ä¸ª D ç»´çš„æ ·æœ¬ xï¼Œx çš„æ¯ä¸€ç»´éƒ½æ˜¯ä¸ªäºŒå€¼çš„ï¼Œæ‰€ä»¥ä¸€ä¸ªè¾“å…¥æ ·æœ¬ x åœ¨ z æˆç«‹çš„æƒ…å†µä¸‹ï¼Œå‘ç”Ÿçš„æ¦‚ç‡å°±æ˜¯ï¼š
q(x|z) = âˆâ‚–â‚Œâ‚á´° (Ïâ‚–(z))Ë£áµ (1-Ïâ‚–(z))Â¹â»Ë£áµ&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶çš„ -ln q(x|z) = âˆ‘â‚–â‚Œâ‚á´° [ -xâ‚– ln Ïâ‚–(z) - (1-xâ‚–) ln(1-Ïâ‚–(z)) ]&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ç¥ç»ç½‘ç»œçš„è¾“å‡º Ï(z) éœ€è¦æ˜¯åœ¨ 0ï½1 ä¹‹é—´ï¼ˆæ¯”å¦‚ç”¨ sigmoid æ¿€æ´»ï¼‰ï¼Œç„¶åç”¨äº¤å‰ç†µä½œä¸ºæŸå¤±å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœå‡è®¾ q(x|z) æ˜¯&lt;strong&gt;æ­£æ€åˆ†å¸ƒ&lt;/strong&gt;ï¼Œç”¨ç¥ç»ç½‘ç»œä¼°è®¡å®ƒçš„æœŸæœ› Î¼_Î¸(z) å’Œæ–¹å·® Î£_Î¸(z)ï¼Œäºæ˜¯ï¼š
-ln q(x|z) = Â½ || (x-Î¼_Î¸(z)) / Î£_Î¸(z) ||Â² + D/2 ln 2Ï€ + Â½âˆ‘â‚–â‚Œâ‚á´° lnÎ£_Î¸(z)ã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆå¤šæ—¶å€™ï¼Œè®­ç»ƒæ—¶æ–¹å·®ä¼šå›ºå®šä¸ºä¸€ä¸ªè¾ƒå°çš„å¸¸æ•°ï¼ˆæ¯æ¬¡é‡‡æ ·éƒ½ä¼šé‡‡åˆ°Î¼ï¼‰ï¼Œæ‰€ä»¥ç¥ç»ç½‘ç»œåªéœ€ä¼°è®¡Î¼ï¼Œä¹Ÿå°±æ˜¯æŠŠ Î¼ å½“ä½œç”Ÿæˆçš„ x&amp;rsquo;ï¼Œåˆ™ä¸Šå¼é‡æ„è¯¯å·®å¯ç®€åŒ–ä¸ºï¼š
-ln q(x|z) = Â½ || (x-Î¼_Î¸(z)) / Î£_Î¸(z) ||Â²&lt;/p&gt;
&lt;p&gt;x &amp;ndash;&amp;gt; z &amp;ndash;&amp;gt; x&#39;&lt;/p&gt;
&lt;p&gt;ç»¼ä¸Šï¼Œå¯¹äºäºŒå€¼æ•°æ®ï¼Œå‡è®¾ q(x|z) æ˜¯ä¼¯åŠªåˆ©åˆ†å¸ƒï¼ˆäºŒé¡¹åˆ†å¸ƒï¼‰ï¼Œå¯ä»¥å¯¹ decoder ï¼ˆç¬¬2ä¸ªç¥ç»ç½‘ç»œï¼‰çš„è¾“å‡ºç”¨ sigmoid æ¿€æ´»ï¼Œå¹¶ç”¨äº¤å‰ç†µä½œä¸ºæŸå¤±å‡½æ•°ï¼›
è€Œå¯¹äºä¸€èˆ¬æ•°æ®ï¼Œå‡è®¾ q(x|z) æ˜¯æ­£æ€åˆ†å¸ƒï¼Œåˆ™ä½¿ç”¨ mse ä½œä¸ºæŸå¤±å‡½æ•°ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä»åéªŒä¸­é‡‡æ ·-z-çš„æŠ€å·§&#34;&gt;ä»åéªŒä¸­é‡‡æ · z çš„æŠ€å·§&lt;/h3&gt;
&lt;p&gt;æŸå¤±å‡½æ•°çš„ç¬¬ 2 é¡¹æ˜¯ï¼šğ”¼_p(z|x) [ -ln q(x|z) ]ï¼Œæ ¹æ®è’™ç‰¹å¡ç½—çš„æ€æƒ³ï¼Œè¿™ä¸ªæœŸæœ›ç”¨å‡å€¼è¿‘ä¼¼ï¼šå…ˆé‡‡æ · zï¼Œç”¨ z è®¡ç®— x çš„åéªŒåˆ†å¸ƒ q(x|z)ï¼Œå†ä»ä¸­é‡‡æ · x è®¡ç®—å®ƒå‡ºç°æ¦‚ç‡çš„å¯¹æ•°ï¼š-ln q(x|z)ï¼Œå†æ±‚å‡å€¼ï¼š&lt;/p&gt;
&lt;p&gt;ğ”¼_p(z|x) [ -ln q(x|z) ] = -1/n âˆ‘áµ¢â‚Œâ‚á´º ln q(x|záµ¢), záµ¢ï½p(z|x)&lt;/p&gt;
&lt;p&gt;å‡è®¾äº† p(z|x) æ˜¯æ­£æ€åˆ†å¸ƒï¼Œå®ƒçš„å‚æ•° Î¼_Ï•, Î£_Ï• å·²ç”±ç¥ç»ç½‘ç»œç®—å‡ºï¼Œå†ä½¿ç”¨é‡å‚æ•°åŒ–æŠ€å·§å°±èƒ½é‡‡æ ·å‡º z ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯è¦é‡‡æ ·å¤šå°‘ä¸ªåˆé€‚å‘¢ï¼Ÿå› ä¸ºæ¯ä¸ª z æ˜¯ä¸“å±äº 1 ä¸ª xï¼Œæ‰€ä»¥åªä» p(z|x) ä¸­é‡‡ä¸€ä¸ª z æ¥è®¡ç®— x çš„åˆ†å¸ƒ q(x|z)ï¼Œå†è®¡ç®— -ln q(x|z)ï¼Œå°±æ˜¯losså€¼ã€‚&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆï¼šğ“› = ğ”¼_pá¢(x) [ KL( p(z|x)||q(z) ) -ln q(x|z) ] , zï½p(z|x)&lt;/p&gt;
&lt;p&gt;å› ä¸ºæ¯æ¬¡ epoch çš„éšå˜é‡éƒ½æ˜¯éšæœºç”Ÿæˆçš„ï¼Œå› æ­¤å½“ epoch æ•°è¶³å¤Ÿå¤šæ—¶ï¼Œå¯ä»¥ä¿è¯é‡‡æ ·çš„å……åˆ†è¡Œã€‚è‹ç¥è¯•è¿‡é‡‡æ ·å¤šä¸ªçš„æƒ…å½¢ï¼Œæ„Ÿè§‰ç”Ÿæˆçš„æ ·æœ¬æ²¡æœ‰æ˜æ˜¾å˜åŒ–ã€‚&lt;/p&gt;
</description>
        </item>
        <item>
        <title>sum: VAE</title>
        <link>https://zichen34.github.io/writenotes/model/imagen/vae/c-sum-vae/</link>
        <pubDate>Fri, 26 Aug 2022 00:00:00 +0000</pubDate>
        
        <guid>https://zichen34.github.io/writenotes/model/imagen/vae/c-sum-vae/</guid>
        <description>&lt;p&gt;(2022-12-28)&lt;/p&gt;
&lt;h2 id=&#34;ç™½æ¿æ¨å¯¼-vae&#34;&gt;ç™½æ¿æ¨å¯¼: VAE&lt;/h2&gt;
&lt;p&gt;Source videoï¼š&lt;a class=&#34;link&#34; href=&#34;https://www.bilibili.com/video/BV15E411w7Pz/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ã€æœºå™¨å­¦ä¹ ã€‘ç™½æ¿æ¨å¯¼ç³»åˆ—(ä¸‰åäºŒ) ï½ å˜åˆ†è‡ªç¼–ç å™¨(VAE)ã€‘&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;VAE å’Œ GMM ä¸€æ ·ä¹Ÿæ˜¯ç”Ÿæˆæ¨¡å‹ï¼šéšå˜é‡ z ç”Ÿæˆè§‚æµ‹å˜é‡ xï¼Œä»è€Œå­¦ä¹ æ ·æœ¬æ•°æ® x æœ¬èº«çš„åˆ†å¸ƒã€‚ä¸è¿‡ VAE çš„ z ä¸æ˜¯1ç»´çš„ï¼Œè€Œæ˜¯å¤šç»´çš„ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç”¨ &lt;a class=&#34;link&#34; href=&#34;https://zichen34.github.io/writenotes/calc/ml-%E7%99%BD%E6%9D%BF%E6%8E%A8%E5%AF%BC%E7%B3%BB%E5%88%97/11-gmm/&#34; &gt;EM è§£ GMM&lt;/a&gt; çš„æœ€ä¼˜å‚æ•° Î¸ æ—¶ï¼Œå‡è®¾ z çš„åéªŒåˆ†å¸ƒ P(z|x;Î¸â½áµ—â¾) èƒ½å¤Ÿå–åˆ°ï¼Œè€Œä¸”å› ä¸º z æ˜¯ç¦»æ•£çš„ï¼ŒP(x) = âˆ‘â‚–â‚Œâ‚á´·P(x,z=Câ‚–;Î¸) å°±èƒ½ç®—å‡ºæ¥ï¼Œ
æ‰€ä»¥åéªŒ P(z|x)=P(x|z)P(z)/P(x) ä¹Ÿèƒ½ç®—å‡ºæ¥ï¼Œå…¶ä¸­åˆ†å­ä¸¤é¡¹æ˜¯å‡è®¾çš„åˆ†å¸ƒã€‚Eæ­¥æŠŠç›®æ ‡å‡½æ•°: &amp;ldquo;æœ€å¤§çš„æœŸæœ›&amp;rdquo; $E_{P(z|x)} [ log P(x,z|Î¸) ]$ å†™å‡ºæ¥ï¼ŒMæ­¥å¯¹å…¶æ±‚å¯¼æ‰¾å‡ºï¼ˆæœŸæœ›æœ€å¤§æ—¶çš„ï¼‰æœ€ä½³Î¸â½áµ—âºÂ¹â¾ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è€Œ VAE çš„ z æ˜¯é«˜ç»´è¿ç»­çš„ï¼ŒP(x) = $âˆ«_z P(x,z) dz$ ç§¯ä¸å‡ºæ¥ï¼ŒåéªŒP(z|x) å°±æ²¡æ³•ç”¨è´å¶æ–¯å…¬å¼å¯¼å‡ºï¼Œä½†å¯ä»¥ç”¨éšæœºæ¢¯åº¦ä¸‹é™å˜åˆ†æ¨æ–­(SGVI)è¿‘ä¼¼åéªŒã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;â€œæ¨æ–­â€æ˜¯ä» x åˆ° z çš„è¿‡ç¨‹ï¼šç”¨æ ·æœ¬ x ä¿®æ­£ z çš„å…ˆéªŒ P(z) å¾—åˆ° z çš„åéªŒ P(z|x)ï¼›è€Œâ€œç”Ÿæˆâ€æ˜¯ä» z çš„åéªŒåˆ†å¸ƒ P(z|x) ä¸­é‡‡æ ·å‡º zï¼Œå†å˜æ¢æˆæ ·æœ¬çš„åˆ†å¸ƒ P(x)ã€‚&lt;/p&gt;
&lt;div class=&#34;mermaid&#34;&gt;flowchart LR; observed((x)) --&gt;|Inference| latent((z)); latent --&gt;|Generation| observed
&lt;/div&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”¨ q(z|x;Ï•) é€¼è¿‘åéªŒ P(z|x;Î¸) æ—¶ï¼Œè¦æœ€å°åŒ– $KL(q_{Ï•(z|x)} || P_{Î¸(z|x)})$ï¼Œåœ¨ Î¸ å›ºå®šï¼Œåˆ™ä¼¼ç„¶ P(X) ä¹Ÿå›ºå®šçš„æƒ…å†µä¸‹ï¼Œç­‰ä»·äºæœ€å¤§åŒ– ELBOï¼š
arg max $E_{qáµ©(z|x)} [ log (P(z,x;Î¸)/qáµ©(z|x)) ]) ]$ã€‚ç±»ä¼¼å¹¿ä¹‰ EM çš„ Eæ­¥ï¼Œåœ¨ Î¸ å›ºå®šçš„æƒ…å†µä¸‹ï¼Œæ±‚åéªŒçš„è¿‘ä¼¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é€šè¿‡æŠŠè”åˆæ¦‚ç‡æ‹†å¼€ï¼Œè¿™ä¸ª ELBO ä¹Ÿå¯å†™æˆ: $E_{qáµ©(z|x)} [ log P(x|z;Î¸) ] - KL(q(z|x;Ï•) ||P(z))$ã€‚
å½“ z çš„å…ˆéªŒåˆ†å¸ƒ P(z) æ˜¯æ ‡å‡†æ­£æ€æ—¶ï¼Œé‚£ä¹ˆKLæ•£åº¦å°±æ˜¯å¸Œæœ› qáµ©(z|x) çš„æ–¹å·®ä¿æŒä¸ºIï¼Œä¸è¦å¤ªå°ï¼Œåˆ†å¸ƒåç¼©åˆ°ä¸€ç‚¹å°±æ˜¯è¿‡æ‹Ÿåˆï¼šxä¸zä¸€ä¸€å¯¹åº”ï¼Œå°±å˜æˆ AEäº†ï¼Œåªèƒ½å¯¹è®­ç»ƒæ ·æœ¬ x æ¨å‡ºæ­£ç¡®çš„ zã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ±‚ç”Ÿæˆæ¨¡å‹çš„æœ€ä¼˜å‚æ•° Î¸ åŒæ ·æ˜¯è¦ä½¿ä¼¼ç„¶æœŸæœ›æœ€å¤§ï¼šarg max ELBOï¼ˆxåéªŒä¸KLæ•£åº¦åŒæ—¶ä¼˜åŒ–ï¼‰ï¼Œï¼ˆæ²¡æ³•ç›´æ¥æ±‚å¯¼ï¼‰å¯é‡‡ç”¨æ¢¯åº¦ä¸Šå‡æ³•ï¼Œæ‰€ä»¥ VAE æ˜¯æŠŠ EM çš„ä¸¤æ­¥åˆèµ·æ¥äº†ï¼Œæ—¢é€¼è¿‘åéªŒ p(z|x) çš„å‚æ•° Ï•ï¼Œåˆé€¼è¿‘ç”Ÿæˆæ¨¡å‹ p(x|z) çš„å‚æ•°Î¸ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨&lt;a class=&#34;link&#34; href=&#34;https://zichen34.github.io/writenotes/calc/ml-%E7%99%BD%E6%9D%BF%E6%8E%A8%E5%AF%BC%E7%B3%BB%E5%88%97/12-%E5%8F%98%E5%88%86%E6%8E%A8%E6%96%AD/&#34; &gt;è®¡ç®— ELBO å¯¹ Ï• çš„æ¢¯åº¦&lt;/a&gt;æ—¶ï¼Œâˆ‡áµ©L(Ï•) å¯ä»¥å†™æˆä¸€ä¸ªæœŸæœ›ï¼Œç›´æ¥å¯¹ z é‡‡æ ·æ±‚å‡å€¼å¯èƒ½ç”±äºæ–¹å·®å¤ªå¤§è€Œå¤±æ•ˆï¼ˆè€Œä¸”é‡‡æ ·æ“ä½œä¸å¯å¯¼ï¼Œå°±æ— æ³•å¯¹zæ±‚æ¢¯åº¦ï¼‰ï¼Œ
æ‰€ä»¥å…ˆå¯¹ä¸€ä¸ªé«˜æ–¯å™ªå£° Îµ é‡‡æ ·ï¼Œå†æ ¹æ®å˜æ¢ï¼šz=Î¼_Ï•(x) + Î£_Ï•Â¹áŸÂ²(x)â‹…Îµ å¾—åˆ° z &lt;a class=&#34;link&#34; href=&#34;https://zichen34.github.io/writenotes/calc/ml-%E7%99%BD%E6%9D%BF%E6%8E%A8%E5%AF%BC%E7%B3%BB%E5%88%97/30-%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B%E7%BB%BC%E8%BF%B0/&#34; &gt;(é‡å‚æ•°åŒ–)&lt;/a&gt;ã€‚ç„¶åæ±‚å‡å€¼(=æ¢¯åº¦)ï¼Œå¸¦å…¥æ¢¯åº¦ä¸Šå‡å…¬å¼ï¼Œæ›´æ–°Ï•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è®­ç»ƒNNæ—¶ï¼Œè¾“å…¥ä¸€ä¸ª xï¼Œç¥ç»ç½‘ç»œè¾“å‡ºåéªŒåˆ†å¸ƒï¼ˆç¼–ç ï¼‰p(z|x) ä»¥åŠé‡‡æ ·å‡ºä¸€ä¸ªzã€‚ç”¨è¿™ä¸ªz é€šè¿‡å¦ä¸€ä¸ªç½‘ç»œé€¼è¿‘ x çš„åéªŒåˆ†å¸ƒï¼ˆç”Ÿæˆæ¨¡å‹ï¼‰p(x|z)ï¼Œ
ä¹Ÿå°±æ˜¯åœ¨å­¦åˆ°çš„ z æˆç«‹çš„æƒ…å†µä¸‹ï¼Œä» p(x|z) ä¸­é‡‡åˆ° x çš„æ¦‚ç‡ï¼Œç›®æ ‡å‡½æ•°å°±æ˜¯å¸Œæœ›è¿™ä¸ªæ¦‚ç‡è¶Šå¤§è¶Šå¥½ï¼Œå¯ä»¥å‡è®¾ xæœä»äºŒé¡¹æˆ–æ­£æ€ï¼ŒæŠŠå‚æ•°ä»£å…¥å…¬å¼å³å¾—æ¦‚ç‡
æˆ–è€…è¯´ï¼Œåˆ†å¸ƒ p(x|z) çš„&amp;quot;ä¼—æ•°&amp;quot; x&amp;rsquo;è¦ä¸è¾“å…¥ x çš„è·ç¦»è¶Šå°è¶Šå¥½ï¼Œå½“æ–¹å·®å¾ˆå°æ—¶ï¼Œä¼—æ•°å°±æ˜¯æœŸæœ›ï¼Œå³æ¯æ¬¡é‡‡æ ·éƒ½ä¼šé‡‡åˆ°æœŸæœ› Î¼(z)ï¼Œæ‰€ä»¥ä»¥ Î¼(z) ä¸ x çš„è·ç¦»ä½œä¸ºç›®æ ‡å‡½æ•°ã€‚
ä¸€ä¸ªxæ˜¯å¤šç»´çš„ï¼Œå®ƒæœ‰è‡ªå·±ï¼ˆç»´åº¦ä¹‹é—´ï¼‰çš„åˆ†å¸ƒã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;mermaid&#34;&gt;flowchart LR
subgraph Encoder
x(&#34;Input x&#34;) --&gt; net(&#34;NN-Ï•&#34;) --&gt; a(&#34;Î¼(x)&#34;) &amp; b(&#34;Î£(x)&#34;)
end
subgraph Decoder
a --&gt; o((&#34;+&#34;)) --&gt; z(&#34;sampled z \n from N(Î¼(x),Î£(x))&#34;) --&gt; net2(&#34;NN-Î¸\n(Î¼(z))&#34;) --&gt;r(&#34;reconstructed\n x&#39;&#34;)
b --&gt; m((&#34;Ã—&#34;)) --&gt; o
Îµ(&#34;Îµï½N(0,ğˆ)&#34;) --&gt; m
end
&lt;/div&gt;

&lt;p&gt;å®Œæ•´ç¬”è®°ï¼š&lt;a class=&#34;link&#34; href=&#34;https://zichen34.github.io/writenotes/calc/ml-%E7%99%BD%E6%9D%BF%E6%8E%A8%E5%AF%BC%E7%B3%BB%E5%88%97/32-vae/&#34; &gt;shuhuai008-32&lt;/a&gt;ï¼›
å‚è€ƒï¼š&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/146944379&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;éšå˜é‡æ¨¡å‹åˆ°EMåˆ°å˜åˆ†è‡ªç¼–ç å™¨ - æˆ‘è¦ç»™ä¸»æ’­ç”ŸçŒ´å­ -çŸ¥ä¹&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;(2022-12-29)&lt;/p&gt;
&lt;h2 id=&#34;è‹å‰‘æ—-vaeä¸€&#34;&gt;è‹å‰‘æ—: VAEï¼ˆä¸€ï¼‰&lt;/h2&gt;
&lt;p&gt;Source articleï¼š&lt;a class=&#34;link&#34; href=&#34;https://www.kexue.fm/archives/5253&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆä¸€ï¼‰ï¼šåŸæ¥æ˜¯è¿™ä¹ˆä¸€å›äº‹-è‹å‰‘æ—&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é€šè¿‡éšå˜é‡ z æ±‚æ ·æœ¬ x çš„åˆ†å¸ƒï¼šp(x) = âˆ«_z p(x|z) p(z) dzã€‚
å…ˆå­¦ä¹  z çš„åéªŒåˆ†å¸ƒ p(z|x)ï¼ˆ &lt;strong&gt;ç¼–ç &lt;/strong&gt; ï¼‰ï¼Œå†ç”±å®ƒ &lt;strong&gt;ç”Ÿæˆ&lt;/strong&gt; $\^x$ï¼Œ$\^x$åº”ä¸xä¸€æ ·ã€‚&lt;/p&gt;
&lt;div class=&#34;mermaid&#34;&gt;flowchart LR
sample(x) --&gt;|&#34;N(Î¼á¶¿,Î£á¶¿)&#34;| latent(&#34;p(z|x)&#34;) --&gt;|&#34;sampling z \n P(x)=Î£p(x|z)â‹…p(z)ï¼Ÿ&#34;| recon(x^)
sample -.-|=| recon
&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ³¨æ„åŒºåˆ†å…ˆéªŒ p(z) ä¸åéªŒ p(z|x)ã€‚å› ä¸ºå‡è®¾äº†åéªŒæ˜¯æ­£æ€åˆ†å¸ƒçš„å½¢å¼ï¼Œæ‰€ä»¥æ˜¯å¯¹ Î¼á¶¿,Î£á¶¿ åšé‡å‚æ•°åŒ–ã€‚è€Œå…ˆéªŒåªå‡ºç°åœ¨æ­£åˆ™åŒ–é¡¹ä¸­ï¼Œä¸å‚ä¸åéªŒçš„è®­ç»ƒã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸€ä¸ªæ ·æœ¬ç‚¹xâ½â±â¾å¯¹åº”ä¸€ä¸ªï¼ˆç‹¬ç«‹çš„ã€å¤šå…ƒçš„ï¼‰åéªŒåˆ†å¸ƒ p(z|xâ½â±â¾)ï¼Œè¿™æ ·ä»ä¸­é‡‡å‡ºçš„ z å°±ä¸€å®šå¯¹åº”è¿™ä¸ªæ ·æœ¬ç‚¹ã€‚æ‰€ä»¥æ¯ä¸ªæ ·æœ¬æœ‰è‡ªå·±çš„æ­£æ€åˆ†å¸ƒã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;z æ˜¯åéªŒåˆ†å¸ƒçš„ä¸€ä¸ªé‡‡æ ·ï¼Œé‡‡æ ·å°±ä¼šæœ‰åå·®ï¼ˆæ–¹å·®ï¼‰ï¼Œå¯¼è‡´é‡æ„è¯¯å·®ä¸ä¸º0ã€‚å¦‚æœä¸åŠ æ­£åˆ™åŒ–ï¼Œä¸ºäº†å‡å°è¯¯å·®ï¼ŒÎ£ä¼šä¸æ–­å‡å°åˆ°0ï¼Œé€€åŒ–æˆAEã€‚
ä»è¿™ä¸ªè§’åº¦çœ‹ vae æ˜¯ AE åŠ ä¸Šå™ªå£°ï¼Œå¹¶çº¦æŸå™ªå£°çš„å¼ºåº¦ï¼ˆæ–¹å·®ï¼‰å°½é‡ä¸º1.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;vae å¸Œæœ›æ‰€æœ‰çš„åéªŒåˆ†å¸ƒï¼ˆâ€ä¸€èˆ¬æ­£æ€â€œï¼‰éƒ½ä¸æ ‡å‡†æ­£æ€ç›¸ä¼¼ï¼šÎ¼=0ï¼ŒÎ£=Iï¼Œé‡‡æ ·zæ—¶å°±ä¿è¯äº†ç”Ÿæˆèƒ½åŠ›ã€‚å› ä¸ºå„åˆ†é‡ç‹¬ç«‹ï¼Œæ‰€ä»¥æ˜¯dç»´ä¸€å…ƒNçš„åŠ å’Œï¼š
KL( N(Î¼,Î£)|| N(0,I) ) = Â½ Î£ [(-logÏƒÂ² + Î¼Â² + ÏƒÂ² -1) ]&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é‡å‚æ•°åŒ–æŠ€å·§æŠŠæœä»N(Î¼,Î£)çš„éšæœºå˜é‡ z çš„æ¦‚ç‡æ‹†æˆä¸€ä¸ªæœä»æ ‡å‡†æ­£æ€çš„å˜é‡Îµå’Œä¸€ä¸ªå‚æ•°å˜æ¢Î¼+ÎµÃ—Ïƒï¼Œä»è€Œå®ç°è™½ç„¶é‡‡æ ·æ“ä½œä¸å¯å¯¼ï¼Œä½†å®ƒä¸å‚ä¸æ¢¯åº¦çš„åå‘ä¼ æ’­ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¡ä»¶VAEï¼šæ ·æœ¬å±äºä¸åŒçš„ç±»åˆ«-æœŸæœ›ä¸åŒ &lt;a class=&#34;link&#34; href=&#34;https://github.com/bojone/vae/blob/master/cvae_keras.py&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;cvaeä»£ç &lt;/a&gt;ï¼šç”¨2ä¸ªçº¿æ€§å±‚åˆ†åˆ«æ‹ŸåˆÎ¼å’ŒÎ£ï¼Œç”¨é‡å‚æ•°åŒ–æŠ€å·§é‡‡æ ·zï¼Œxä¸x&amp;rsquo;ä¹‹é—´çš„é‡æ„æŸå¤±ç”¨äº†äº¤å‰ç†µ &lt;br&gt;
modelï¼š&lt;/p&gt;

  
  
  
  
    
    
    
    
     
    
    
     
    
    &lt;img src= /writenotes/model/imagen/vae/img/cvae.png width=&gt;
    
    
  

&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;mermaid&#34;&gt;flowchart LR
x(x\n original_dim) --&gt;|&#34;Dense\n(intermediate_dim)&#34;| h --&gt;|&#34;Dense\n(latent_dim)&#34;| Î¼(&#34;z_mean&#34;) &amp; Î£(&#34;z_log_var&#34;);
y(y\n num_classes) --&gt;|&#34;Dense\n(latent_dim)&#34;| yh
Î¼ &amp; Î£ --&gt; rp{sampling} --&gt;|reparame\n terization| z --&gt;|&#34;Dense\n (intermediate_dim)&#34;| h_decoded --&gt;|&#34;Dense\n(original_dim)&#34;| x_decoded_mean
&lt;/div&gt;

&lt;hr&gt;
&lt;p&gt;(2022-12-30)&lt;/p&gt;
&lt;h2 id=&#34;è‹å‰‘æ—-vaeäºŒ&#34;&gt;è‹å‰‘æ—: VAEï¼ˆäºŒï¼‰&lt;/h2&gt;
&lt;p&gt;åŸæ–‡ï¼š&lt;a class=&#34;link&#34; href=&#34;https://www.kexue.fm/archives/5343&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆäºŒï¼‰ï¼šä»è´å¶æ–¯è§‚ç‚¹å‡ºå‘&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æœŸæœ›çš„æ•°å€¼è®¡ç®—ä¸é‡‡æ ·è®¡ç®—ä¸åŒï¼šæ•°å€¼è®¡ç®—æ˜¯å…ˆç»™ä¸€ä¸ªæ•°åˆ— xï¼ˆå…¶ä¸­$xâ° &amp;lt; xÂ¹ &amp;lt; xÂ²&amp;lt;&amp;hellip;xâ¿$ï¼‰ï¼Œç„¶åå¯¹é‡Œé¢çš„æ¯ä¸ªæ•° xâ½â±â¾ æŒ‰å®ƒçš„æ¦‚ç‡åŠ æƒæ±‚å’Œï¼šE[x]=âˆ« xp(x) dxã€‚
ä½†å¦‚æœ xâ½â±â¾ æ˜¯åˆ†å¸ƒ p(x) ä¸­çš„é‡‡æ ·ï¼Œæ¦‚ç‡å¤§çš„ä¼šè¢«å¤šé‡‡å‡ æ¬¡ï¼Œæ ·æœ¬é›†åˆ x ä¸­å°±åŒ…å«äº†æ¦‚ç‡ä¿¡æ¯ï¼Œä¸ç”¨å†ä¹˜ p(xâ½â±â¾)äº†ï¼šE[x]â‰ˆ1/nâ‹…âˆ‘áµ¢â‚Œâ‚€â¿ xâ½â±â¾, xâ½â±â¾âˆ¼p(x)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¨å¯¼ç›®æ ‡å‡½æ•°æ—¶ï¼Œå…ˆæ„é€ äº† p(x,z)=p(z|x)â‹…p^(x)ï¼Œå†æ„é€  q(x,z)=q(x|z)q(z)ï¼Œè¿™ä¸¤ä¸ªæ„é€ æ¯«æ— å…³ç³»ï¼Œå¸Œæœ›å®ƒä¿©äº’ç›¸é è¿‘ï¼Œè€Œä¸æ˜¯ä¸ºäº†é€¼è¿‘zçš„åéªŒp(z|x)ã€‚&lt;a class=&#34;link&#34; href=&#34;./WatchVideos/%e8%8b%8f%e5%89%91%e6%9e%97/VAE_2.md&#34; &gt;notes&lt;/a&gt;; (vaeä¸‰-josh00çš„è¯„è®º)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨ç”Ÿæˆé˜¶æ®µï¼Œè‹¥å‡è®¾ p(x|z) æœä»äºŒé¡¹åˆ†å¸ƒï¼Œåˆ™é‡æ„è¯¯å·®å°±æ˜¯äº¤å‰ç†µï¼›è‹¥å‡è®¾ p(x|z) æœä»æ­£æ€åˆ†å¸ƒï¼Œåˆ™é‡æ„è¯¯å·®å°±æ˜¯MSE&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è®­ç»ƒæ—¶ï¼Œç”Ÿæˆé˜¶æ®µåªä» z çš„åéªŒåˆ†å¸ƒä¸­é‡‡æ ·ä¸€ä¸ªï¼Œå› ä¸º z æ˜¯ä¸“å±äºä¸€ä¸ªxã€‚P(x)â” Î¼_Ï•(x), Î£_Ï•Â¹áŸÂ²(x) â” z â” Î¼_Î¸(z) â” x&#39;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;(2022-12-31)&lt;/p&gt;
&lt;h2 id=&#34;è‹å‰‘æ—-vaeä¸‰&#34;&gt;è‹å‰‘æ—: VAEï¼ˆä¸‰ï¼‰&lt;/h2&gt;
&lt;p&gt;åŸæ–‡ï¼š&lt;a class=&#34;link&#34; href=&#34;https://www.kexue.fm/archives/5383&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆä¸‰ï¼‰ï¼šè¿™æ ·åšä¸ºä»€ä¹ˆèƒ½æˆï¼Ÿ&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;vaeç”Ÿæˆæ—¶ï¼Œåªé‡‡ä¸€ä¸ªzï¼šå› ä¸ºxä¸zä¸€ä¸€å¯¹åº”ï¼ˆè‡ªç¼–ç å™¨ï¼‰æ–¹å·®ä¸º0ï¼Œvaeå¼•å…¥äº†å…ˆéªŒq(z)=N(0,I)ï¼Œæ–¹å·®ä¹Ÿä¸ä¼šå¤ªå¤§ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡é‡‡æ ·ï¼Œç»“æœéƒ½ä¸€æ ·ã€‚å¦‚æœç›´æ¥åšæœ€å¤§ä¼¼ç„¶p(x|z)ï¼Œå°±éœ€è¦ä»zçš„å…ˆéªŒp(z)ä¸­é‡‡å¤šä¸ªæ ·æœ¬å…ˆä¼°è®¡å‡ºæ¯ä¸ªxçš„ä¼¼ç„¶ï¼Œå†æ±‚ä¼¼ç„¶çš„æœŸæœ›æœ€å¤§åŒ–ã€‚ä½†å¦‚è¿‡æ²¡é‡‡åˆ° zâ‚–ï¼Œå®ƒå¯¹åº”çš„ xâ‚–çš„ä¼¼ç„¶å°±æ˜¯0ï¼Œln0æ˜¯-âˆï¼Œå¯¼è‡´è®­ç»ƒå¤±è´¥ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;VAE çš„é‡å»ºç”Ÿæˆç›¸å½“äºåœ¨AEä¸ŠåŠ äº†å™ªå£°ï¼ˆæ–¹å·®ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥ç”Ÿæˆä¸åŸå§‹æ ·æœ¬ä¸åŒçš„æ•°æ®ã€‚&lt;/p&gt;
&lt;div class=&#34;mermaid&#34;&gt;%%{ init: { &#39;flowchart&#39;: { &#39;curve&#39;: &#39;linear&#39; } } }%%
flowchart TB
x[&#34;x\n(æ ·æœ¬)&#34;] --&gt; nn[&#34;éšå˜é‡çš„åˆ†å¸ƒ Î¼(x), Î£(x)&#34;] --&gt; z 
--&gt; nn2[&#34;æ•°æ®çš„åˆ†å¸ƒ p(x|z)\n æ–¹å·®å¾ˆå°&#34;] --&gt; recon[x&#39;\né‡å»ºæ ·æœ¬]
nn --&gt; |&#34;é€šè¿‡é‡‡æ ·ï¼Œä» â€œå¤šä¸ªâ€ åˆ° â€œä¸€ä¸ªâ€ï¼Œ&lt;br&gt;ä» â€œæ— é™â€ åˆ° â€œå”¯ä¸€â€&#34;| recon 
&lt;/div&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;&#34; &gt;IWAE&lt;/a&gt; å¯¹p(x,z)=âˆ«p(x|z)p(z)dz åšç­‰ä»·å˜æ¢ï¼Œä»è€Œå¯ä»åéªŒp(z|x)ä¸­é‡‡æ ·zã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;(2023-06-04)&lt;/p&gt;
&lt;h2 id=&#34;pca-ä¸-vae&#34;&gt;PCA ä¸ VAE&lt;/h2&gt;
&lt;p&gt;They&amp;rsquo;re both learning the distribution of data.&lt;/p&gt;
&lt;p&gt;DDG search: &amp;ldquo;&lt;a class=&#34;link&#34; href=&#34;https://duckduckgo.com/?q=PCA&amp;#43;%E4%B8%8E&amp;#43;VAE&amp;#43;%E5%AF%B9%E6%AF%94&amp;amp;ia=web&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PCA ä¸ VAE å¯¹æ¯”&lt;/a&gt;&amp;rdquo;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://towardsdatascience.com/understanding-variational-autoencoders-vaes-f70510919f73&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Understanding Variational Autoencoders (VAEs) - Joseph Rocca&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://sannaperzon.medium.com/paper-summary-variational-autoencoders-with-pytorch-implementation-1b4b23b1763a&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Variational Autoencoders explained â€” with PyTorch Implementation - Sanna Persson&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;torch&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;Instead of mapping the input into a fixed vector, we want to map it into a distribution. &lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;https://lilianweng.github.io/posts/2018-08-12-vae/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;From Autoencoder to Beta-VAE - Lil&amp;rsquo;Log&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</description>
        </item>
        <item>
        <title>images</title>
        <link>https://zichen34.github.io/writenotes/model/imagen/vae/img/</link>
        <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
        
        <guid>https://zichen34.github.io/writenotes/model/imagen/vae/img/</guid>
        <description></description>
        </item>
        
    </channel>
</rss>
