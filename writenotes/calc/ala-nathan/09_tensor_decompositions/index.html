<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Course page: AM584
Descovered by Ytb search: CANDECOMP/PARAFAC (CP) decomposition
Tensor Decomposition Source video Applied Linear Algebra: Tensor Decompositions
Tensor is the generalization of matrix. Tensor decomposition is doing multiple times SVD to extract the corelation in each dimension.
One piece of data could be a matrix, e.g., the temperture distribution in a region of latitude and longitude.
By stacking the data matrices of different time points, the obtained data forms a cube.'>
<title>watch: Nathan 09 | Tensor Decompositions</title>

<link rel='canonical' href='https://zichen34.github.io/writenotes/calc/ala-nathan/09_tensor_decompositions/'>

<link rel="stylesheet" href="/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css"><meta property='og:title' content='watch: Nathan 09 | Tensor Decompositions'>
<meta property='og:description' content='Course page: AM584
Descovered by Ytb search: CANDECOMP/PARAFAC (CP) decomposition
Tensor Decomposition Source video Applied Linear Algebra: Tensor Decompositions
Tensor is the generalization of matrix. Tensor decomposition is doing multiple times SVD to extract the corelation in each dimension.
One piece of data could be a matrix, e.g., the temperture distribution in a region of latitude and longitude.
By stacking the data matrices of different time points, the obtained data forms a cube.'>
<meta property='og:url' content='https://zichen34.github.io/writenotes/calc/ala-nathan/09_tensor_decompositions/'>
<meta property='og:site_name' content='Zichen Wang'>
<meta property='og:type' content='article'><meta property='article:section' content='WriteNotes' /><meta property='article:published_time' content='2023-05-22T18:00:00&#43;00:00'/><meta property='article:modified_time' content='2023-05-22T18:00:00&#43;00:00'/>
<meta name="twitter:title" content="watch: Nathan 09 | Tensor Decompositions">
<meta name="twitter:description" content="Course page: AM584
Descovered by Ytb search: CANDECOMP/PARAFAC (CP) decomposition
Tensor Decomposition Source video Applied Linear Algebra: Tensor Decompositions
Tensor is the generalization of matrix. Tensor decomposition is doing multiple times SVD to extract the corelation in each dimension.
One piece of data could be a matrix, e.g., the temperture distribution in a region of latitude and longitude.
By stacking the data matrices of different time points, the obtained data forms a cube.">
    <link rel="shortcut icon" href="/favicon-32x32.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu238e2fe759432347fa5dd53661ac4381_131637_300x0_resize_box_3.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Zichen Wang</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/zichen34'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com/luckily1640'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/aboutme/' >
                
                
                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/writenotes/' >
                
                
                
                <span>WriteNotes</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#tensor-decomposition">Tensor Decomposition</a>
      <ol>
        <li><a href="#vectorizing">Vectorizing</a></li>
        <li><a href="#svd">SVD</a></li>
        <li><a href="#reconstruct">Reconstruct</a></li>
        <li><a href="#inner-and-outer-product">Inner and Outer product:</a></li>
      </ol>
    </li>
    <li><a href="#code-demo">Code Demo</a>
      <ol>
        <li><a href="#dataset">Dataset</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/writenotes/calc/ala-nathan/09_tensor_decompositions/">watch: Nathan 09 | Tensor Decompositions</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">May 22, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    5 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>Course page: <a class="link" href="https://faculty.washington.edu/kutz/am584/am584.html"  target="_blank" rel="noopener"
    >AM584</a></p>
<p>Descovered by Ytb search: <a class="link" href="https://www.youtube.com/results?search_query=CANDECOMP%2FPARAFAC&#43;%28CP%29&#43;decomposition"  target="_blank" rel="noopener"
    >CANDECOMP/PARAFAC (CP) decomposition</a></p>
<h2 id="tensor-decomposition">Tensor Decomposition</h2>
<p>Source video <a class="link" href="https://youtu.be/tm5am60CId4"  target="_blank" rel="noopener"
    >Applied Linear Algebra: Tensor Decompositions</a></p>
<p>Tensor is the generalization of matrix. Tensor decomposition is doing <strong>multiple times SVD</strong> to extract the corelation in each dimension.</p>
<p>One piece of data could be a matrix, e.g., the temperture distribution in a region of latitude and longitude.</p>
<p>By stacking the data matrices of different time points, the obtained data forms a cube.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 272 137"
      >
      <g transform='translate(8,16)'>
<path d='M 0,0 L 32,0' fill='none' stroke='currentColor'></path>
<path d='M 32,0 L 64,0' fill='none' stroke='currentColor'></path>
<path d='M 64,0 L 96,0' fill='none' stroke='currentColor'></path>
<path d='M 168,0 L 224,0' fill='none' stroke='currentColor'></path>
<path d='M 0,32 L 32,32' fill='none' stroke='currentColor'></path>
<path d='M 32,32 L 64,32' fill='none' stroke='currentColor'></path>
<path d='M 64,32 L 96,32' fill='none' stroke='currentColor'></path>
<path d='M 200,32 L 224,32' fill='none' stroke='currentColor'></path>
<path d='M 224,32 L 256,32' fill='none' stroke='currentColor'></path>
<path d='M 120,48 L 144,48' fill='none' stroke='currentColor'></path>
<path d='M 0,64 L 32,64' fill='none' stroke='currentColor'></path>
<path d='M 32,64 L 64,64' fill='none' stroke='currentColor'></path>
<path d='M 64,64 L 96,64' fill='none' stroke='currentColor'></path>
<path d='M 168,64 L 200,64' fill='none' stroke='currentColor'></path>
<path d='M 200,64 L 224,64' fill='none' stroke='currentColor'></path>
<path d='M 0,96 L 32,96' fill='none' stroke='currentColor'></path>
<path d='M 32,96 L 64,96' fill='none' stroke='currentColor'></path>
<path d='M 64,96 L 96,96' fill='none' stroke='currentColor'></path>
<path d='M 200,96 L 256,96' fill='none' stroke='currentColor'></path>
<path d='M 0,0 L 0,32' fill='none' stroke='currentColor'></path>
<path d='M 0,32 L 0,64' fill='none' stroke='currentColor'></path>
<path d='M 0,64 L 0,96' fill='none' stroke='currentColor'></path>
<path d='M 32,0 L 32,32' fill='none' stroke='currentColor'></path>
<path d='M 32,32 L 32,64' fill='none' stroke='currentColor'></path>
<path d='M 32,64 L 32,96' fill='none' stroke='currentColor'></path>
<path d='M 64,0 L 64,32' fill='none' stroke='currentColor'></path>
<path d='M 64,32 L 64,64' fill='none' stroke='currentColor'></path>
<path d='M 64,64 L 64,96' fill='none' stroke='currentColor'></path>
<path d='M 96,0 L 96,32' fill='none' stroke='currentColor'></path>
<path d='M 96,32 L 96,64' fill='none' stroke='currentColor'></path>
<path d='M 96,64 L 96,96' fill='none' stroke='currentColor'></path>
<path d='M 168,0 L 168,64' fill='none' stroke='currentColor'></path>
<path d='M 200,32 L 200,64' fill='none' stroke='currentColor'></path>
<path d='M 200,64 L 200,96' fill='none' stroke='currentColor'></path>
<path d='M 224,0 L 224,32' fill='none' stroke='currentColor'></path>
<path d='M 224,32 L 224,64' fill='none' stroke='currentColor'></path>
<path d='M 256,32 L 256,96' fill='none' stroke='currentColor'></path>
<polygon points='152.000000,48.000000 140.000000,42.400002 140.000000,53.599998' fill='currentColor' transform='rotate(0.000000, 144.000000, 48.000000)'></polygon>
<text text-anchor='middle' x='48' y='116' fill='currentColor' style='font-size:1em'>X</text>
<text text-anchor='middle' x='56' y='116' fill='currentColor' style='font-size:1em'>ⱼ</text>
<text text-anchor='middle' x='176' y='20' fill='currentColor' style='font-size:1em'>`</text>
<text text-anchor='middle' x='176' y='84' fill='currentColor' style='font-size:1em'>`</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='184' y='84' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='192' y='36' fill='currentColor' style='font-size:1em'>`</text>
<text text-anchor='middle' x='192' y='100' fill='currentColor' style='font-size:1em'>`</text>
<text text-anchor='middle' x='208' y='116' fill='currentColor' style='font-size:1em'>X</text>
<text text-anchor='middle' x='232' y='84' fill='currentColor' style='font-size:1em'>`</text>
<text text-anchor='middle' x='240' y='20' fill='currentColor' style='font-size:1em'>`</text>
<text text-anchor='middle' x='240' y='84' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>.</text>
</g>

    </svg>
  
</div>
<h3 id="vectorizing">Vectorizing</h3>
<p>Vectorize a (n-dimensional) array is to reshape it into a vector.</p>
<p>Stacking the columns on top of each other.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 384 137"
      >
      <g transform='translate(8,16)'>
<path d='M 0,0 L 32,0' fill='none' stroke='currentColor'></path>
<path d='M 32,0 L 64,0' fill='none' stroke='currentColor'></path>
<path d='M 64,0 L 96,0' fill='none' stroke='currentColor'></path>
<path d='M 144,0 L 160,0' fill='none' stroke='currentColor'></path>
<path d='M 216,0 L 272,0' fill='none' stroke='currentColor'></path>
<path d='M 352,0 L 368,0' fill='none' stroke='currentColor'></path>
<path d='M 144,16 L 160,16' fill='none' stroke='currentColor'></path>
<path d='M 352,16 L 368,16' fill='none' stroke='currentColor'></path>
<path d='M 0,32 L 32,32' fill='none' stroke='currentColor'></path>
<path d='M 32,32 L 64,32' fill='none' stroke='currentColor'></path>
<path d='M 64,32 L 96,32' fill='none' stroke='currentColor'></path>
<path d='M 144,32 L 160,32' fill='none' stroke='currentColor'></path>
<path d='M 248,32 L 272,32' fill='none' stroke='currentColor'></path>
<path d='M 272,32 L 304,32' fill='none' stroke='currentColor'></path>
<path d='M 352,32 L 368,32' fill='none' stroke='currentColor'></path>
<path d='M 112,48 L 128,48' fill='none' stroke='currentColor'></path>
<path d='M 144,48 L 160,48' fill='none' stroke='currentColor'></path>
<path d='M 320,48 L 336,48' fill='none' stroke='currentColor'></path>
<path d='M 352,48 L 368,48' fill='none' stroke='currentColor'></path>
<path d='M 0,64 L 32,64' fill='none' stroke='currentColor'></path>
<path d='M 32,64 L 64,64' fill='none' stroke='currentColor'></path>
<path d='M 64,64 L 96,64' fill='none' stroke='currentColor'></path>
<path d='M 216,64 L 248,64' fill='none' stroke='currentColor'></path>
<path d='M 248,64 L 272,64' fill='none' stroke='currentColor'></path>
<path d='M 144,80 L 160,80' fill='none' stroke='currentColor'></path>
<path d='M 352,80 L 368,80' fill='none' stroke='currentColor'></path>
<path d='M 0,96 L 32,96' fill='none' stroke='currentColor'></path>
<path d='M 32,96 L 64,96' fill='none' stroke='currentColor'></path>
<path d='M 64,96 L 96,96' fill='none' stroke='currentColor'></path>
<path d='M 144,96 L 160,96' fill='none' stroke='currentColor'></path>
<path d='M 248,96 L 304,96' fill='none' stroke='currentColor'></path>
<path d='M 352,96 L 368,96' fill='none' stroke='currentColor'></path>
<path d='M 0,0 L 0,32' fill='none' stroke='currentColor'></path>
<path d='M 0,32 L 0,64' fill='none' stroke='currentColor'></path>
<path d='M 0,64 L 0,96' fill='none' stroke='currentColor'></path>
<path d='M 32,0 L 32,32' fill='none' stroke='currentColor'></path>
<path d='M 32,32 L 32,64' fill='none' stroke='currentColor'></path>
<path d='M 32,64 L 32,96' fill='none' stroke='currentColor'></path>
<path d='M 64,0 L 64,32' fill='none' stroke='currentColor'></path>
<path d='M 64,32 L 64,64' fill='none' stroke='currentColor'></path>
<path d='M 64,64 L 64,96' fill='none' stroke='currentColor'></path>
<path d='M 96,0 L 96,32' fill='none' stroke='currentColor'></path>
<path d='M 96,32 L 96,64' fill='none' stroke='currentColor'></path>
<path d='M 96,64 L 96,96' fill='none' stroke='currentColor'></path>
<path d='M 144,0 L 144,16' fill='none' stroke='currentColor'></path>
<path d='M 144,16 L 144,32' fill='none' stroke='currentColor'></path>
<path d='M 144,32 L 144,48' fill='none' stroke='currentColor'></path>
<path d='M 144,80 L 144,96' fill='none' stroke='currentColor'></path>
<path d='M 160,0 L 160,16' fill='none' stroke='currentColor'></path>
<path d='M 160,16 L 160,32' fill='none' stroke='currentColor'></path>
<path d='M 160,32 L 160,48' fill='none' stroke='currentColor'></path>
<path d='M 160,80 L 160,96' fill='none' stroke='currentColor'></path>
<path d='M 216,0 L 216,64' fill='none' stroke='currentColor'></path>
<path d='M 248,32 L 248,64' fill='none' stroke='currentColor'></path>
<path d='M 248,64 L 248,96' fill='none' stroke='currentColor'></path>
<path d='M 272,0 L 272,32' fill='none' stroke='currentColor'></path>
<path d='M 272,32 L 272,64' fill='none' stroke='currentColor'></path>
<path d='M 304,32 L 304,96' fill='none' stroke='currentColor'></path>
<path d='M 352,0 L 352,16' fill='none' stroke='currentColor'></path>
<path d='M 352,16 L 352,32' fill='none' stroke='currentColor'></path>
<path d='M 352,32 L 352,48' fill='none' stroke='currentColor'></path>
<path d='M 352,80 L 352,96' fill='none' stroke='currentColor'></path>
<path d='M 368,0 L 368,16' fill='none' stroke='currentColor'></path>
<path d='M 368,16 L 368,32' fill='none' stroke='currentColor'></path>
<path d='M 368,32 L 368,48' fill='none' stroke='currentColor'></path>
<path d='M 368,80 L 368,96' fill='none' stroke='currentColor'></path>
<polygon points='136.000000,48.000000 124.000000,42.400002 124.000000,53.599998' fill='currentColor' transform='rotate(0.000000, 128.000000, 48.000000)'></polygon>
<polygon points='344.000000,48.000000 332.000000,42.400002 332.000000,53.599998' fill='currentColor' transform='rotate(0.000000, 336.000000, 48.000000)'></polygon>
<text text-anchor='middle' x='48' y='116' fill='currentColor' style='font-size:1em'>X</text>
<text text-anchor='middle' x='56' y='116' fill='currentColor' style='font-size:1em'>ⱼ</text>
<text text-anchor='middle' x='152' y='68' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='152' y='116' fill='currentColor' style='font-size:1em'>X</text>
<text text-anchor='middle' x='160' y='116' fill='currentColor' style='font-size:1em'>ⱼ</text>
<text text-anchor='middle' x='184' y='52' fill='currentColor' style='font-size:1em'>O</text>
<text text-anchor='middle' x='192' y='52' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='224' y='20' fill='currentColor' style='font-size:1em'>`</text>
<text text-anchor='middle' x='224' y='84' fill='currentColor' style='font-size:1em'>`</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='232' y='84' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='240' y='36' fill='currentColor' style='font-size:1em'>`</text>
<text text-anchor='middle' x='240' y='100' fill='currentColor' style='font-size:1em'>`</text>
<text text-anchor='middle' x='280' y='84' fill='currentColor' style='font-size:1em'>`</text>
<text text-anchor='middle' x='288' y='20' fill='currentColor' style='font-size:1em'>`</text>
<text text-anchor='middle' x='288' y='84' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='296' y='20' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='360' y='68' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='360' y='116' fill='currentColor' style='font-size:1em'>X</text>
<text text-anchor='middle' x='368' y='116' fill='currentColor' style='font-size:1em'>ⱼ</text>
</g>

    </svg>
  
</div>
<p>Vectorizing doesn&rsquo;t bother the similarity against each smaples? because the total amount of difference is fixed?
No matter using which kind of metric, the normalized distinctions between each other are fixed?</p>
<h3 id="svd">SVD</h3>
<p>By flattening each sample, and arrange them into a matrix, then SVD can be applied.</p>
<p>Reconstruct the matrix A with low-rank structures?</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 680 217"
      >
      <g transform='translate(8,16)'>
<path d='M 0,16 L 32,16' fill='none' stroke='currentColor'></path>
<path d='M 32,16 L 64,16' fill='none' stroke='currentColor'></path>
<path d='M 64,16 L 96,16' fill='none' stroke='currentColor'></path>
<path d='M 144,16 L 176,16' fill='none' stroke='currentColor'></path>
<path d='M 192,16 L 224,16' fill='none' stroke='currentColor'></path>
<path d='M 224,16 L 256,16' fill='none' stroke='currentColor'></path>
<path d='M 256,16 L 288,16' fill='none' stroke='currentColor'></path>
<path d='M 320,16 L 352,16' fill='none' stroke='currentColor'></path>
<path d='M 368,16 L 400,16' fill='none' stroke='currentColor'></path>
<path d='M 400,16 L 432,16' fill='none' stroke='currentColor'></path>
<path d='M 432,16 L 464,16' fill='none' stroke='currentColor'></path>
<path d='M 496,16 L 528,16' fill='none' stroke='currentColor'></path>
<path d='M 544,16 L 576,16' fill='none' stroke='currentColor'></path>
<path d='M 576,16 L 608,16' fill='none' stroke='currentColor'></path>
<path d='M 608,16 L 640,16' fill='none' stroke='currentColor'></path>
<path d='M 0,48 L 32,48' fill='none' stroke='currentColor'></path>
<path d='M 32,48 L 64,48' fill='none' stroke='currentColor'></path>
<path d='M 64,48 L 96,48' fill='none' stroke='currentColor'></path>
<path d='M 144,48 L 176,48' fill='none' stroke='currentColor'></path>
<path d='M 192,48 L 224,48' fill='none' stroke='currentColor'></path>
<path d='M 224,48 L 256,48' fill='none' stroke='currentColor'></path>
<path d='M 256,48 L 288,48' fill='none' stroke='currentColor'></path>
<path d='M 320,48 L 352,48' fill='none' stroke='currentColor'></path>
<path d='M 368,48 L 400,48' fill='none' stroke='currentColor'></path>
<path d='M 400,48 L 432,48' fill='none' stroke='currentColor'></path>
<path d='M 432,48 L 464,48' fill='none' stroke='currentColor'></path>
<path d='M 496,48 L 528,48' fill='none' stroke='currentColor'></path>
<path d='M 544,48 L 576,48' fill='none' stroke='currentColor'></path>
<path d='M 576,48 L 608,48' fill='none' stroke='currentColor'></path>
<path d='M 608,48 L 640,48' fill='none' stroke='currentColor'></path>
<path d='M 0,80 L 32,80' fill='none' stroke='currentColor'></path>
<path d='M 32,80 L 64,80' fill='none' stroke='currentColor'></path>
<path d='M 64,80 L 96,80' fill='none' stroke='currentColor'></path>
<path d='M 144,80 L 176,80' fill='none' stroke='currentColor'></path>
<path d='M 320,80 L 352,80' fill='none' stroke='currentColor'></path>
<path d='M 496,80 L 528,80' fill='none' stroke='currentColor'></path>
<path d='M 0,112 L 32,112' fill='none' stroke='currentColor'></path>
<path d='M 32,112 L 64,112' fill='none' stroke='currentColor'></path>
<path d='M 64,112 L 96,112' fill='none' stroke='currentColor'></path>
<path d='M 144,112 L 176,112' fill='none' stroke='currentColor'></path>
<path d='M 320,112 L 352,112' fill='none' stroke='currentColor'></path>
<path d='M 496,112 L 528,112' fill='none' stroke='currentColor'></path>
<path d='M 0,144 L 32,144' fill='none' stroke='currentColor'></path>
<path d='M 32,144 L 64,144' fill='none' stroke='currentColor'></path>
<path d='M 64,144 L 96,144' fill='none' stroke='currentColor'></path>
<path d='M 144,144 L 176,144' fill='none' stroke='currentColor'></path>
<path d='M 320,144 L 352,144' fill='none' stroke='currentColor'></path>
<path d='M 496,144 L 528,144' fill='none' stroke='currentColor'></path>
<path d='M 0,176 L 32,176' fill='none' stroke='currentColor'></path>
<path d='M 32,176 L 64,176' fill='none' stroke='currentColor'></path>
<path d='M 64,176 L 96,176' fill='none' stroke='currentColor'></path>
<path d='M 144,176 L 176,176' fill='none' stroke='currentColor'></path>
<path d='M 320,176 L 352,176' fill='none' stroke='currentColor'></path>
<path d='M 496,176 L 528,176' fill='none' stroke='currentColor'></path>
<path d='M 0,16 L 0,48' fill='none' stroke='currentColor'></path>
<path d='M 0,48 L 0,80' fill='none' stroke='currentColor'></path>
<path d='M 0,80 L 0,112' fill='none' stroke='currentColor'></path>
<path d='M 0,112 L 0,144' fill='none' stroke='currentColor'></path>
<path d='M 0,144 L 0,176' fill='none' stroke='currentColor'></path>
<path d='M 32,16 L 32,48' fill='none' stroke='currentColor'></path>
<path d='M 32,48 L 32,80' fill='none' stroke='currentColor'></path>
<path d='M 32,80 L 32,112' fill='none' stroke='currentColor'></path>
<path d='M 32,112 L 32,144' fill='none' stroke='currentColor'></path>
<path d='M 32,144 L 32,176' fill='none' stroke='currentColor'></path>
<path d='M 64,16 L 64,48' fill='none' stroke='currentColor'></path>
<path d='M 64,48 L 64,80' fill='none' stroke='currentColor'></path>
<path d='M 64,80 L 64,112' fill='none' stroke='currentColor'></path>
<path d='M 64,112 L 64,144' fill='none' stroke='currentColor'></path>
<path d='M 64,144 L 64,176' fill='none' stroke='currentColor'></path>
<path d='M 96,16 L 96,48' fill='none' stroke='currentColor'></path>
<path d='M 96,48 L 96,80' fill='none' stroke='currentColor'></path>
<path d='M 96,80 L 96,112' fill='none' stroke='currentColor'></path>
<path d='M 96,112 L 96,144' fill='none' stroke='currentColor'></path>
<path d='M 96,144 L 96,176' fill='none' stroke='currentColor'></path>
<path d='M 144,16 L 144,48' fill='none' stroke='currentColor'></path>
<path d='M 144,48 L 144,80' fill='none' stroke='currentColor'></path>
<path d='M 144,80 L 144,112' fill='none' stroke='currentColor'></path>
<path d='M 144,112 L 144,144' fill='none' stroke='currentColor'></path>
<path d='M 144,144 L 144,176' fill='none' stroke='currentColor'></path>
<path d='M 176,16 L 176,48' fill='none' stroke='currentColor'></path>
<path d='M 176,48 L 176,80' fill='none' stroke='currentColor'></path>
<path d='M 176,80 L 176,112' fill='none' stroke='currentColor'></path>
<path d='M 176,112 L 176,144' fill='none' stroke='currentColor'></path>
<path d='M 176,144 L 176,176' fill='none' stroke='currentColor'></path>
<path d='M 192,16 L 192,48' fill='none' stroke='currentColor'></path>
<path d='M 224,16 L 224,48' fill='none' stroke='currentColor'></path>
<path d='M 256,16 L 256,48' fill='none' stroke='currentColor'></path>
<path d='M 288,16 L 288,48' fill='none' stroke='currentColor'></path>
<path d='M 320,16 L 320,48' fill='none' stroke='currentColor'></path>
<path d='M 320,48 L 320,80' fill='none' stroke='currentColor'></path>
<path d='M 320,80 L 320,112' fill='none' stroke='currentColor'></path>
<path d='M 320,112 L 320,144' fill='none' stroke='currentColor'></path>
<path d='M 320,144 L 320,176' fill='none' stroke='currentColor'></path>
<path d='M 352,16 L 352,48' fill='none' stroke='currentColor'></path>
<path d='M 352,48 L 352,80' fill='none' stroke='currentColor'></path>
<path d='M 352,80 L 352,112' fill='none' stroke='currentColor'></path>
<path d='M 352,112 L 352,144' fill='none' stroke='currentColor'></path>
<path d='M 352,144 L 352,176' fill='none' stroke='currentColor'></path>
<path d='M 368,16 L 368,48' fill='none' stroke='currentColor'></path>
<path d='M 400,16 L 400,48' fill='none' stroke='currentColor'></path>
<path d='M 432,16 L 432,48' fill='none' stroke='currentColor'></path>
<path d='M 464,16 L 464,48' fill='none' stroke='currentColor'></path>
<path d='M 496,16 L 496,48' fill='none' stroke='currentColor'></path>
<path d='M 496,48 L 496,80' fill='none' stroke='currentColor'></path>
<path d='M 496,80 L 496,112' fill='none' stroke='currentColor'></path>
<path d='M 496,112 L 496,144' fill='none' stroke='currentColor'></path>
<path d='M 496,144 L 496,176' fill='none' stroke='currentColor'></path>
<path d='M 528,16 L 528,48' fill='none' stroke='currentColor'></path>
<path d='M 528,48 L 528,80' fill='none' stroke='currentColor'></path>
<path d='M 528,80 L 528,112' fill='none' stroke='currentColor'></path>
<path d='M 528,112 L 528,144' fill='none' stroke='currentColor'></path>
<path d='M 528,144 L 528,176' fill='none' stroke='currentColor'></path>
<path d='M 544,16 L 544,48' fill='none' stroke='currentColor'></path>
<path d='M 576,16 L 576,48' fill='none' stroke='currentColor'></path>
<path d='M 608,16 L 608,48' fill='none' stroke='currentColor'></path>
<path d='M 640,16 L 640,48' fill='none' stroke='currentColor'></path>
<text text-anchor='middle' x='16' y='100' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='48' y='4' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='48' y='196' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='112' y='100' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='128' y='84' fill='currentColor' style='font-size:1em'>σ</text>
<text text-anchor='middle' x='136' y='84' fill='currentColor' style='font-size:1em'>₁</text>
<text text-anchor='middle' x='152' y='4' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='160' y='4' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='232' y='4' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='240' y='4' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='288' y='84' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='304' y='84' fill='currentColor' style='font-size:1em'>σ</text>
<text text-anchor='middle' x='312' y='84' fill='currentColor' style='font-size:1em'>₂</text>
<text text-anchor='middle' x='328' y='4' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='336' y='4' fill='currentColor' style='font-size:1em'>₂</text>
<text text-anchor='middle' x='408' y='4' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='416' y='4' fill='currentColor' style='font-size:1em'>₂</text>
<text text-anchor='middle' x='464' y='84' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='480' y='84' fill='currentColor' style='font-size:1em'>σ</text>
<text text-anchor='middle' x='488' y='84' fill='currentColor' style='font-size:1em'>₃</text>
<text text-anchor='middle' x='504' y='4' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='512' y='4' fill='currentColor' style='font-size:1em'>₃</text>
<text text-anchor='middle' x='584' y='4' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='592' y='4' fill='currentColor' style='font-size:1em'>₃</text>
<text text-anchor='middle' x='632' y='84' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='648' y='84' fill='currentColor' style='font-size:1em'>⋯</text>
<text text-anchor='middle' x='664' y='84' fill='currentColor' style='font-size:1em'>⋯</text>
</g>

    </svg>
  
</div>
<p>To avoid vectorization (flattening) messes up or mixes together the independent attributes (temperture, pressure, and humidity) and keep them in their own dimensions separately,
SVD needs to be applied for every dimension.</p>
<p>Decompose a data cube 𝓜 by performing SVD in 3 directions:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 584 553"
      >
      <g transform='translate(8,16)'>
<path d='M 48,0 L 120,0' fill='none' stroke='currentColor'></path>
<path d='M 24,48 L 48,48' fill='none' stroke='currentColor'></path>
<path d='M 48,48 L 96,48' fill='none' stroke='currentColor'></path>
<path d='M 48,112 L 96,112' fill='none' stroke='currentColor'></path>
<path d='M 96,112 L 120,112' fill='none' stroke='currentColor'></path>
<path d='M 24,160 L 96,160' fill='none' stroke='currentColor'></path>
<path d='M 32,176 L 40,176' fill='none' stroke='currentColor'></path>
<path d='M 80,176 L 88,176' fill='none' stroke='currentColor'></path>
<path d='M 64,224 L 96,224' fill='none' stroke='currentColor'></path>
<path d='M 248,224 L 280,224' fill='none' stroke='currentColor'></path>
<path d='M 432,224 L 464,224' fill='none' stroke='currentColor'></path>
<path d='M 48,256 L 80,256' fill='none' stroke='currentColor'></path>
<path d='M 232,256 L 264,256' fill='none' stroke='currentColor'></path>
<path d='M 416,256 L 448,256' fill='none' stroke='currentColor'></path>
<path d='M 32,288 L 64,288' fill='none' stroke='currentColor'></path>
<path d='M 216,288 L 248,288' fill='none' stroke='currentColor'></path>
<path d='M 400,288 L 432,288' fill='none' stroke='currentColor'></path>
<path d='M 16,320 L 48,320' fill='none' stroke='currentColor'></path>
<path d='M 200,320 L 232,320' fill='none' stroke='currentColor'></path>
<path d='M 384,320 L 416,320' fill='none' stroke='currentColor'></path>
<path d='M 56,336 L 88,336' fill='none' stroke='currentColor'></path>
<path d='M 88,336 L 120,336' fill='none' stroke='currentColor'></path>
<path d='M 120,336 L 152,336' fill='none' stroke='currentColor'></path>
<path d='M 240,336 L 272,336' fill='none' stroke='currentColor'></path>
<path d='M 272,336 L 304,336' fill='none' stroke='currentColor'></path>
<path d='M 304,336 L 336,336' fill='none' stroke='currentColor'></path>
<path d='M 424,336 L 456,336' fill='none' stroke='currentColor'></path>
<path d='M 456,336 L 488,336' fill='none' stroke='currentColor'></path>
<path d='M 488,336 L 520,336' fill='none' stroke='currentColor'></path>
<path d='M 16,352 L 48,352' fill='none' stroke='currentColor'></path>
<path d='M 200,352 L 232,352' fill='none' stroke='currentColor'></path>
<path d='M 384,352 L 416,352' fill='none' stroke='currentColor'></path>
<path d='M 56,368 L 88,368' fill='none' stroke='currentColor'></path>
<path d='M 88,368 L 120,368' fill='none' stroke='currentColor'></path>
<path d='M 120,368 L 152,368' fill='none' stroke='currentColor'></path>
<path d='M 240,368 L 272,368' fill='none' stroke='currentColor'></path>
<path d='M 272,368 L 304,368' fill='none' stroke='currentColor'></path>
<path d='M 304,368 L 336,368' fill='none' stroke='currentColor'></path>
<path d='M 424,368 L 456,368' fill='none' stroke='currentColor'></path>
<path d='M 456,368 L 488,368' fill='none' stroke='currentColor'></path>
<path d='M 488,368 L 520,368' fill='none' stroke='currentColor'></path>
<path d='M 16,384 L 48,384' fill='none' stroke='currentColor'></path>
<path d='M 200,384 L 232,384' fill='none' stroke='currentColor'></path>
<path d='M 384,384 L 416,384' fill='none' stroke='currentColor'></path>
<path d='M 16,416 L 48,416' fill='none' stroke='currentColor'></path>
<path d='M 200,416 L 232,416' fill='none' stroke='currentColor'></path>
<path d='M 384,416 L 416,416' fill='none' stroke='currentColor'></path>
<path d='M 16,448 L 48,448' fill='none' stroke='currentColor'></path>
<path d='M 200,448 L 232,448' fill='none' stroke='currentColor'></path>
<path d='M 384,448 L 416,448' fill='none' stroke='currentColor'></path>
<path d='M 16,480 L 48,480' fill='none' stroke='currentColor'></path>
<path d='M 200,480 L 232,480' fill='none' stroke='currentColor'></path>
<path d='M 384,480 L 416,480' fill='none' stroke='currentColor'></path>
<path d='M 16,512 L 48,512' fill='none' stroke='currentColor'></path>
<path d='M 200,512 L 232,512' fill='none' stroke='currentColor'></path>
<path d='M 384,512 L 416,512' fill='none' stroke='currentColor'></path>
<path d='M 0,64 L 0,96' fill='none' stroke='currentColor'></path>
<path d='M 0,128 L 0,160' fill='none' stroke='currentColor'></path>
<path d='M 16,352 L 16,384' fill='none' stroke='currentColor'></path>
<path d='M 16,384 L 16,416' fill='none' stroke='currentColor'></path>
<path d='M 16,416 L 16,448' fill='none' stroke='currentColor'></path>
<path d='M 16,448 L 16,480' fill='none' stroke='currentColor'></path>
<path d='M 16,480 L 16,512' fill='none' stroke='currentColor'></path>
<path d='M 24,48 L 24,160' fill='none' stroke='currentColor'></path>
<path d='M 48,0 L 48,48' fill='none' stroke='currentColor'></path>
<path d='M 48,48 L 48,112' fill='none' stroke='currentColor'></path>
<path d='M 48,352 L 48,384' fill='none' stroke='currentColor'></path>
<path d='M 48,384 L 48,416' fill='none' stroke='currentColor'></path>
<path d='M 48,416 L 48,448' fill='none' stroke='currentColor'></path>
<path d='M 48,448 L 48,480' fill='none' stroke='currentColor'></path>
<path d='M 48,480 L 48,512' fill='none' stroke='currentColor'></path>
<path d='M 56,336 L 56,368' fill='none' stroke='currentColor'></path>
<path d='M 88,336 L 88,368' fill='none' stroke='currentColor'></path>
<path d='M 96,48 L 96,112' fill='none' stroke='currentColor'></path>
<path d='M 96,112 L 96,160' fill='none' stroke='currentColor'></path>
<path d='M 120,0 L 120,112' fill='none' stroke='currentColor'></path>
<path d='M 120,336 L 120,368' fill='none' stroke='currentColor'></path>
<path d='M 152,336 L 152,368' fill='none' stroke='currentColor'></path>
<path d='M 200,352 L 200,384' fill='none' stroke='currentColor'></path>
<path d='M 200,384 L 200,416' fill='none' stroke='currentColor'></path>
<path d='M 200,416 L 200,448' fill='none' stroke='currentColor'></path>
<path d='M 200,448 L 200,480' fill='none' stroke='currentColor'></path>
<path d='M 200,480 L 200,512' fill='none' stroke='currentColor'></path>
<path d='M 232,352 L 232,384' fill='none' stroke='currentColor'></path>
<path d='M 232,384 L 232,416' fill='none' stroke='currentColor'></path>
<path d='M 232,416 L 232,448' fill='none' stroke='currentColor'></path>
<path d='M 232,448 L 232,480' fill='none' stroke='currentColor'></path>
<path d='M 232,480 L 232,512' fill='none' stroke='currentColor'></path>
<path d='M 240,336 L 240,368' fill='none' stroke='currentColor'></path>
<path d='M 272,336 L 272,368' fill='none' stroke='currentColor'></path>
<path d='M 304,336 L 304,368' fill='none' stroke='currentColor'></path>
<path d='M 336,336 L 336,368' fill='none' stroke='currentColor'></path>
<path d='M 384,352 L 384,384' fill='none' stroke='currentColor'></path>
<path d='M 384,384 L 384,416' fill='none' stroke='currentColor'></path>
<path d='M 384,416 L 384,448' fill='none' stroke='currentColor'></path>
<path d='M 384,448 L 384,480' fill='none' stroke='currentColor'></path>
<path d='M 384,480 L 384,512' fill='none' stroke='currentColor'></path>
<path d='M 416,352 L 416,384' fill='none' stroke='currentColor'></path>
<path d='M 416,384 L 416,416' fill='none' stroke='currentColor'></path>
<path d='M 416,416 L 416,448' fill='none' stroke='currentColor'></path>
<path d='M 416,448 L 416,480' fill='none' stroke='currentColor'></path>
<path d='M 416,480 L 416,512' fill='none' stroke='currentColor'></path>
<path d='M 424,336 L 424,368' fill='none' stroke='currentColor'></path>
<path d='M 456,336 L 456,368' fill='none' stroke='currentColor'></path>
<path d='M 488,336 L 488,368' fill='none' stroke='currentColor'></path>
<path d='M 520,336 L 520,368' fill='none' stroke='currentColor'></path>
<path d='M 24,48 L 48,0' fill='none' stroke='currentColor'></path>
<path d='M 24,160 L 48,112' fill='none' stroke='currentColor'></path>
<path d='M 96,48 L 120,0' fill='none' stroke='currentColor'></path>
<path d='M 16,320 L 32,288' fill='none' stroke='currentColor'></path>
<path d='M 32,288 L 48,256' fill='none' stroke='currentColor'></path>
<path d='M 48,256 L 64,224' fill='none' stroke='currentColor'></path>
<path d='M 96,160 L 120,112' fill='none' stroke='currentColor'></path>
<path d='M 112,160 L 136,112' fill='none' stroke='currentColor'></path>
<path d='M 48,320 L 64,288' fill='none' stroke='currentColor'></path>
<path d='M 64,288 L 80,256' fill='none' stroke='currentColor'></path>
<path d='M 80,256 L 96,224' fill='none' stroke='currentColor'></path>
<path d='M 200,320 L 216,288' fill='none' stroke='currentColor'></path>
<path d='M 216,288 L 232,256' fill='none' stroke='currentColor'></path>
<path d='M 232,256 L 248,224' fill='none' stroke='currentColor'></path>
<path d='M 232,320 L 248,288' fill='none' stroke='currentColor'></path>
<path d='M 248,288 L 264,256' fill='none' stroke='currentColor'></path>
<path d='M 264,256 L 280,224' fill='none' stroke='currentColor'></path>
<path d='M 384,320 L 400,288' fill='none' stroke='currentColor'></path>
<path d='M 400,288 L 416,256' fill='none' stroke='currentColor'></path>
<path d='M 416,256 L 432,224' fill='none' stroke='currentColor'></path>
<path d='M 416,320 L 432,288' fill='none' stroke='currentColor'></path>
<path d='M 432,288 L 448,256' fill='none' stroke='currentColor'></path>
<path d='M 448,256 L 464,224' fill='none' stroke='currentColor'></path>
<polygon points='8.000000,64.000000 -4.000000,58.400002 -4.000000,69.599998' fill='currentColor' transform='rotate(270.000000, 0.000000, 64.000000)'></polygon>
<polygon points='8.000000,160.000000 -4.000000,154.399994 -4.000000,165.600006' fill='currentColor' transform='rotate(90.000000, 0.000000, 160.000000)'></polygon>
<polygon points='40.000000,176.000000 28.000000,170.399994 28.000000,181.600006' fill='currentColor' transform='rotate(180.000000, 32.000000, 176.000000)'></polygon>
<polygon points='96.000000,176.000000 84.000000,170.399994 84.000000,181.600006' fill='currentColor' transform='rotate(0.000000, 88.000000, 176.000000)'></polygon>
<polygon points='124.000000,160.000000 112.000000,154.399994 112.000000,165.600006' fill='currentColor' transform='rotate(120.000000, 112.000000, 160.000000)'></polygon>
<polygon points='148.000000,112.000000 136.000000,106.400002 136.000000,117.599998' fill='currentColor' transform='rotate(300.000000, 136.000000, 112.000000)'></polygon>
<text text-anchor='middle' x='0' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='0' y='340' fill='currentColor' style='font-size:1em'>σ</text>
<text text-anchor='middle' x='8' y='116' fill='currentColor' style='font-size:1em'>ⱼ</text>
<text text-anchor='middle' x='8' y='340' fill='currentColor' style='font-size:1em'>₁</text>
<text text-anchor='middle' x='32' y='532' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='40' y='532' fill='currentColor' style='font-size:1em'>₁</text>
<text text-anchor='middle' x='56' y='180' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='64' y='180' fill='currentColor' style='font-size:1em'>ⱼ</text>
<text text-anchor='middle' x='72' y='212' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='80' y='212' fill='currentColor' style='font-size:1em'>₁</text>
<text text-anchor='middle' x='104' y='388' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='112' y='388' fill='currentColor' style='font-size:1em'>₁</text>
<text text-anchor='middle' x='128' y='148' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='136' y='148' fill='currentColor' style='font-size:1em'>ⱼ</text>
<text text-anchor='middle' x='152' y='68' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='168' y='340' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='184' y='340' fill='currentColor' style='font-size:1em'>σ</text>
<text text-anchor='middle' x='192' y='340' fill='currentColor' style='font-size:1em'>₂</text>
<text text-anchor='middle' x='216' y='532' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='224' y='532' fill='currentColor' style='font-size:1em'>₂</text>
<text text-anchor='middle' x='256' y='212' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='264' y='212' fill='currentColor' style='font-size:1em'>₂</text>
<text text-anchor='middle' x='288' y='388' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='296' y='388' fill='currentColor' style='font-size:1em'>₂</text>
<text text-anchor='middle' x='352' y='340' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='368' y='340' fill='currentColor' style='font-size:1em'>σ</text>
<text text-anchor='middle' x='376' y='340' fill='currentColor' style='font-size:1em'>₃</text>
<text text-anchor='middle' x='400' y='532' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='408' y='532' fill='currentColor' style='font-size:1em'>₃</text>
<text text-anchor='middle' x='448' y='212' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='456' y='212' fill='currentColor' style='font-size:1em'>₃</text>
<text text-anchor='middle' x='472' y='388' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='480' y='388' fill='currentColor' style='font-size:1em'>₃</text>
<text text-anchor='middle' x='536' y='340' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='552' y='340' fill='currentColor' style='font-size:1em'>⋯</text>
<text text-anchor='middle' x='568' y='340' fill='currentColor' style='font-size:1em'>⋯</text>
</g>

    </svg>
  
</div>
<p>A dominant vector is responsible for its homologous vectors, having the same dimensionality.</p>
<p>For example, the above 5-dimensional vector is representing for the vectors parallel to it.</p>
<p>As the following hand illustration shows, Align the fingers with the vector and move towards the direction that the palm is facing.
The vectors on the hand path will be represented.</p>
<p>




  
  
  
  
   
  
  
   
  
  <img src= /writenotes/calc/ala-nathan/img/hand-drawing-side-palm-human-sing-stop-vector-198490406.jpg width=>
  
  


(image comes from <a class="link" href="https://www.dreamstime.com/illustration/stop-hand-side.html"  target="_blank" rel="noopener"
    >here</a>)</p>
<h3 id="reconstruct">Reconstruct</h3>
<p>The r-rank approximation to the data cube M is the sum of the outer product of the dominant vectors in 3 directions.</p>
<p>𝓜 = ∑ⱼ₌₁ʳ σⱼ∘aⱼ∘bⱼ∘cⱼ</p>
<p>All individual dominant vectors aⱼ constitute 𝓐ᵣ. And 𝓑ᵣ is the collection of all the bⱼ, and so do 𝓒ᵣ.</p>
<p>𝓜 = 𝓐ᵣ ∘ 𝓑ᵣ ∘ 𝓒ᵣ</p>
<h3 id="inner-and-outer-product">Inner and Outer product:</h3>
<p>Given two column vectors: $𝐮=[^{{u_1}}_{^{u_2}_{u_3}}]$
and $𝐯=[^{v_1}_{^{v_2}_{v_3}}]$,</p>
<ul>
<li>
<p>Inner product (equals dot product):</p>
<p>$$
\rm uᵀv = (u₁,u₂,u₃) [^{v_1}_{^{v_2}_{v_3}}] = u₁v₁ +u₂v₂ + u₃v₃ \text{= scalar}
$$</p>
</li>
<li>
<p>Outer prodcut:
$$
\rm 𝐮⊗𝐯 = uvᵀ = [^{{u_1}}_{^{u_2}_{u_3}}] (v₁,v₂,v₃) \\ =
\begin{bmatrix}
\rm u₁v₁ &amp; \rm u₁v₂ &amp; \rm u₁v₃ \\
\rm u₂v₁ &amp; \rm u₂v₂ &amp; \rm u₂v₃ \\ \rm u₃v₁ &amp; \rm u₃v₂ &amp; \rm u₃v₃
\end{bmatrix}
$$</p>
<p>Any two vectors (with difference lengths) can perform outer product:</p>
<p>$$
\rm (^{v₁}_{v₂}) ⊗ (^{w₁}_{^{w₂}_{w₃}}) =
\begin{bmatrix}
\rm v₁w₁ &amp; \rm v₁w₂ &amp; \rm v₁w₃ \\
\rm v₂w₁ &amp; \rm v₂w₂ &amp; \rm v₂w₃
\end{bmatrix}
$$</p>
<p>Each entry in the matrix is a scalar and can be indexed by: (𝐯 ⊗ 𝐰)ᵢⱼ= 𝐯ᵢ⋅𝐰ⱼ,
the product of an element in the first vector with an element in the second vector.</p>
</li>
<li>
<p>Vector-matrix outer product</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>         <span class="c1"># [2]</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span> <span class="c1"># [2, 2]</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;p,qr-&gt; pqr&#39;</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tensor</span><span class="p">([[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="link" href="https://stackoverflow.com/a/55069431"  target="_blank" rel="noopener"
    >Pytorch batch matrix vector outer product - SO</a></p>
</li>
<li>
<p>The SVD decomposition can be interpreted as the sum of outer products of each left (𝐮ₖ) and right (𝐯ₖ) singular vectors, scaled by the corresponding nonzero signular value σₖ
<a class="link" href="https://en.wikipedia.org/wiki/Outer_product"  target="_blank" rel="noopener"
    >wiki</a></p>
<p>𝐀 = 𝐔 𝚺 𝐕ᵀ = $∑_{k=1}^{rank(A)}$ (𝐮ₖ ⊗ 𝐯ₖ)σₖ</p>
</li>
</ul>
<h2 id="code-demo">Code Demo</h2>
<p>Source video: <a class="link" href="https://www.youtube.com/watch?v=1UbAJeix3To"  target="_blank" rel="noopener"
    >Applied Linear Algebra: Implementing Tensor Decompositions</a></p>
<h3 id="dataset">Dataset</h3>
<p>The data cube is generated by a spatial temporal function.
It&rsquo;s like a video having x and y directions and chaning in time.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 536 361"
      >
      <g transform='translate(8,16)'>
<path d='M 248,16 L 280,16' fill='none' stroke='currentColor'></path>
<path d='M 432,16 L 464,16' fill='none' stroke='currentColor'></path>
<path d='M 232,48 L 264,48' fill='none' stroke='currentColor'></path>
<path d='M 416,48 L 448,48' fill='none' stroke='currentColor'></path>
<path d='M 48,64 L 120,64' fill='none' stroke='currentColor'></path>
<path d='M 216,80 L 248,80' fill='none' stroke='currentColor'></path>
<path d='M 400,80 L 432,80' fill='none' stroke='currentColor'></path>
<path d='M 24,112 L 48,112' fill='none' stroke='currentColor'></path>
<path d='M 48,112 L 96,112' fill='none' stroke='currentColor'></path>
<path d='M 200,112 L 232,112' fill='none' stroke='currentColor'></path>
<path d='M 384,112 L 416,112' fill='none' stroke='currentColor'></path>
<path d='M 240,128 L 272,128' fill='none' stroke='currentColor'></path>
<path d='M 272,128 L 304,128' fill='none' stroke='currentColor'></path>
<path d='M 304,128 L 336,128' fill='none' stroke='currentColor'></path>
<path d='M 424,128 L 456,128' fill='none' stroke='currentColor'></path>
<path d='M 456,128 L 488,128' fill='none' stroke='currentColor'></path>
<path d='M 488,128 L 520,128' fill='none' stroke='currentColor'></path>
<path d='M 200,144 L 232,144' fill='none' stroke='currentColor'></path>
<path d='M 384,144 L 416,144' fill='none' stroke='currentColor'></path>
<path d='M 240,160 L 272,160' fill='none' stroke='currentColor'></path>
<path d='M 272,160 L 304,160' fill='none' stroke='currentColor'></path>
<path d='M 304,160 L 336,160' fill='none' stroke='currentColor'></path>
<path d='M 424,160 L 456,160' fill='none' stroke='currentColor'></path>
<path d='M 456,160 L 488,160' fill='none' stroke='currentColor'></path>
<path d='M 488,160 L 520,160' fill='none' stroke='currentColor'></path>
<path d='M 48,176 L 96,176' fill='none' stroke='currentColor'></path>
<path d='M 96,176 L 120,176' fill='none' stroke='currentColor'></path>
<path d='M 200,176 L 232,176' fill='none' stroke='currentColor'></path>
<path d='M 384,176 L 416,176' fill='none' stroke='currentColor'></path>
<path d='M 200,208 L 232,208' fill='none' stroke='currentColor'></path>
<path d='M 384,208 L 416,208' fill='none' stroke='currentColor'></path>
<path d='M 24,224 L 96,224' fill='none' stroke='currentColor'></path>
<path d='M 32,240 L 40,240' fill='none' stroke='currentColor'></path>
<path d='M 72,240 L 80,240' fill='none' stroke='currentColor'></path>
<path d='M 200,240 L 232,240' fill='none' stroke='currentColor'></path>
<path d='M 384,240 L 416,240' fill='none' stroke='currentColor'></path>
<path d='M 200,272 L 232,272' fill='none' stroke='currentColor'></path>
<path d='M 384,272 L 416,272' fill='none' stroke='currentColor'></path>
<path d='M 200,304 L 232,304' fill='none' stroke='currentColor'></path>
<path d='M 384,304 L 416,304' fill='none' stroke='currentColor'></path>
<path d='M 8,128 L 8,160' fill='none' stroke='currentColor'></path>
<path d='M 8,192 L 8,224' fill='none' stroke='currentColor'></path>
<path d='M 24,112 L 24,224' fill='none' stroke='currentColor'></path>
<path d='M 48,64 L 48,112' fill='none' stroke='currentColor'></path>
<path d='M 48,112 L 48,176' fill='none' stroke='currentColor'></path>
<path d='M 96,112 L 96,176' fill='none' stroke='currentColor'></path>
<path d='M 96,176 L 96,224' fill='none' stroke='currentColor'></path>
<path d='M 120,64 L 120,176' fill='none' stroke='currentColor'></path>
<path d='M 200,144 L 200,176' fill='none' stroke='currentColor'></path>
<path d='M 200,176 L 200,208' fill='none' stroke='currentColor'></path>
<path d='M 200,208 L 200,240' fill='none' stroke='currentColor'></path>
<path d='M 200,240 L 200,272' fill='none' stroke='currentColor'></path>
<path d='M 200,272 L 200,304' fill='none' stroke='currentColor'></path>
<path d='M 232,144 L 232,176' fill='none' stroke='currentColor'></path>
<path d='M 232,176 L 232,208' fill='none' stroke='currentColor'></path>
<path d='M 232,208 L 232,240' fill='none' stroke='currentColor'></path>
<path d='M 232,240 L 232,272' fill='none' stroke='currentColor'></path>
<path d='M 232,272 L 232,304' fill='none' stroke='currentColor'></path>
<path d='M 240,128 L 240,160' fill='none' stroke='currentColor'></path>
<path d='M 272,128 L 272,160' fill='none' stroke='currentColor'></path>
<path d='M 304,128 L 304,160' fill='none' stroke='currentColor'></path>
<path d='M 336,128 L 336,160' fill='none' stroke='currentColor'></path>
<path d='M 384,144 L 384,176' fill='none' stroke='currentColor'></path>
<path d='M 384,176 L 384,208' fill='none' stroke='currentColor'></path>
<path d='M 384,208 L 384,240' fill='none' stroke='currentColor'></path>
<path d='M 384,240 L 384,272' fill='none' stroke='currentColor'></path>
<path d='M 384,272 L 384,304' fill='none' stroke='currentColor'></path>
<path d='M 416,144 L 416,176' fill='none' stroke='currentColor'></path>
<path d='M 416,176 L 416,208' fill='none' stroke='currentColor'></path>
<path d='M 416,208 L 416,240' fill='none' stroke='currentColor'></path>
<path d='M 416,240 L 416,272' fill='none' stroke='currentColor'></path>
<path d='M 416,272 L 416,304' fill='none' stroke='currentColor'></path>
<path d='M 424,128 L 424,160' fill='none' stroke='currentColor'></path>
<path d='M 456,128 L 456,160' fill='none' stroke='currentColor'></path>
<path d='M 488,128 L 488,160' fill='none' stroke='currentColor'></path>
<path d='M 520,128 L 520,160' fill='none' stroke='currentColor'></path>
<path d='M 8,112 L 32,64' fill='none' stroke='currentColor'></path>
<path d='M 24,112 L 48,64' fill='none' stroke='currentColor'></path>
<path d='M 24,224 L 48,176' fill='none' stroke='currentColor'></path>
<path d='M 96,112 L 120,64' fill='none' stroke='currentColor'></path>
<path d='M 96,224 L 120,176' fill='none' stroke='currentColor'></path>
<path d='M 200,112 L 216,80' fill='none' stroke='currentColor'></path>
<path d='M 216,80 L 232,48' fill='none' stroke='currentColor'></path>
<path d='M 232,48 L 248,16' fill='none' stroke='currentColor'></path>
<path d='M 232,112 L 248,80' fill='none' stroke='currentColor'></path>
<path d='M 248,80 L 264,48' fill='none' stroke='currentColor'></path>
<path d='M 264,48 L 280,16' fill='none' stroke='currentColor'></path>
<path d='M 384,112 L 400,80' fill='none' stroke='currentColor'></path>
<path d='M 400,80 L 416,48' fill='none' stroke='currentColor'></path>
<path d='M 416,48 L 432,16' fill='none' stroke='currentColor'></path>
<path d='M 416,112 L 432,80' fill='none' stroke='currentColor'></path>
<path d='M 432,80 L 448,48' fill='none' stroke='currentColor'></path>
<path d='M 448,48 L 464,16' fill='none' stroke='currentColor'></path>
<polygon points='20.000000,112.000000 8.000000,106.400002 8.000000,117.599998' fill='currentColor' transform='rotate(120.000000, 8.000000, 112.000000)'></polygon>
<polygon points='16.000000,128.000000 4.000000,122.400002 4.000000,133.600006' fill='currentColor' transform='rotate(270.000000, 8.000000, 128.000000)'></polygon>
<polygon points='16.000000,224.000000 4.000000,218.399994 4.000000,229.600006' fill='currentColor' transform='rotate(90.000000, 8.000000, 224.000000)'></polygon>
<polygon points='44.000000,64.000000 32.000000,58.400002 32.000000,69.599998' fill='currentColor' transform='rotate(300.000000, 32.000000, 64.000000)'></polygon>
<polygon points='40.000000,240.000000 28.000000,234.399994 28.000000,245.600006' fill='currentColor' transform='rotate(180.000000, 32.000000, 240.000000)'></polygon>
<polygon points='88.000000,240.000000 76.000000,234.399994 76.000000,245.600006' fill='currentColor' transform='rotate(0.000000, 80.000000, 240.000000)'></polygon>
<text text-anchor='middle' x='8' y='180' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='16' y='84' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='56' y='244' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='152' y='132' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='184' y='132' fill='currentColor' style='font-size:1em'>σ</text>
<text text-anchor='middle' x='192' y='132' fill='currentColor' style='font-size:1em'>₁</text>
<text text-anchor='middle' x='200' y='340' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='208' y='340' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='216' y='324' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='216' y='340' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='224' y='324' fill='currentColor' style='font-size:1em'>₁</text>
<text text-anchor='middle' x='224' y='340' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='240' y='340' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='256' y='4' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='264' y='4' fill='currentColor' style='font-size:1em'>₁</text>
<text text-anchor='middle' x='288' y='180' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='296' y='180' fill='currentColor' style='font-size:1em'>₁</text>
<text text-anchor='middle' x='352' y='132' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='368' y='132' fill='currentColor' style='font-size:1em'>σ</text>
<text text-anchor='middle' x='376' y='132' fill='currentColor' style='font-size:1em'>₂</text>
<text text-anchor='middle' x='384' y='340' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='392' y='340' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='400' y='324' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='400' y='340' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='408' y='324' fill='currentColor' style='font-size:1em'>₂</text>
<text text-anchor='middle' x='408' y='340' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='424' y='340' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='440' y='4' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='448' y='4' fill='currentColor' style='font-size:1em'>₂</text>
<text text-anchor='middle' x='472' y='180' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='480' y='180' fill='currentColor' style='font-size:1em'>₂</text>
</g>

    </svg>
  
</div>
<p>The function mixes two fundamental features (modes) together. So the decomposition method should pull out the the two features back.</p>
<ul>
<li>Feature 1: $f₁(x,y,t) = e^{-(x²+0.5*y²)} cos(2t)$, the spatial structure is a elliptical shaped gaussian, and this bump oscillate up and down in time.</li>
<li>Feature 2: $f₂(x,y,t) = sech(x)tanh(x) e^{-0.2y^2} sin(t)$, x direction is the shape -∿-, y direction is gaussian bell, and it oscillates with sine t</li>
<li>Data matrix: F = f₁ + f₂</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-matlab" data-lang="matlab"><span class="line"><span class="cl"><span class="n">clear</span> <span class="n">all</span><span class="p">;</span> <span class="n">close</span> <span class="n">all</span><span class="p">;</span> <span class="n">clc</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">% Basic domains (each frame is a rectangle)</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="p">=</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">5</span><span class="p">;</span> <span class="n">y</span> <span class="p">=</span> <span class="o">-</span><span class="mi">6</span><span class="p">:</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">6</span><span class="p">;</span> <span class="n">t</span> <span class="p">=</span> <span class="mi">0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">10</span><span class="o">*</span><span class="nb">pi</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">);</span>  <span class="c">% Data cube</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">f1</span> <span class="p">=</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">X</span><span class="o">.^</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Y</span><span class="o">.^</span><span class="mi">2</span><span class="p">))</span><span class="o">.*</span><span class="p">(</span><span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">));</span>       <span class="c">% (Y,X,t): (121, 101, 315)</span>
</span></span><span class="line"><span class="cl"><span class="n">f2</span> <span class="p">=</span> <span class="p">(</span><span class="nb">sech</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.*</span><span class="nb">tanh</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="n">Y</span><span class="o">.^</span><span class="mi">2</span><span class="p">))</span><span class="o">.*</span><span class="nb">sin</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="p">=</span> <span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span><span class="p">;</span>  <span class="c">% Tensor</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">% Visualizing the shapes</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nb">j</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">surfl</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">f1</span><span class="p">(:,:,</span><span class="nb">j</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="c">%surfl(x, y, f2(:,:,j);</span>
</span></span><span class="line"><span class="cl">    <span class="c">%axis([-5,5], [-6,6], [-1,1]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">colormap</span><span class="p">(</span><span class="n">hot</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">shading</span> <span class="n">interp</span><span class="p">;</span> <span class="n">drawnow</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">% Vectorizing (for performing standard SVD)</span>
</span></span><span class="line"><span class="cl"><span class="n">nx</span> <span class="p">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">ny</span> <span class="p">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nb">j</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c">% Every flattened column vector is appended to the matrix Af</span>
</span></span><span class="line"><span class="cl">    <span class="n">Af</span><span class="p">(:,</span><span class="nb">j</span><span class="p">)</span> <span class="p">=</span> <span class="nb">reshape</span><span class="p">(</span><span class="n">A</span><span class="p">(:,:,</span><span class="nb">j</span><span class="p">),</span> <span class="n">nx</span><span class="o">*</span><span class="n">ny</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>  <span class="c">% (nx*ny, t)</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">% Make matrix Af back to a tensor</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nb">j</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">At</span><span class="p">(:,:,</span><span class="nb">j</span><span class="p">)</span> <span class="p">=</span> <span class="nb">reshape</span><span class="p">(</span><span class="n">Af</span><span class="p">(:,</span><span class="nb">j</span><span class="p">),</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">% n-way array tensor decomposition (parallel factorization algorithm)</span>
</span></span><span class="line"><span class="cl"><span class="c">% Given a hypercube of data, it will find the dominant factors in each direction.</span>
</span></span><span class="line"><span class="cl"><span class="c">% Input tensor and rank (# of dominant components truncated)</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span> <span class="p">=</span> <span class="n">parafac</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">% Determine factors in each directions from each low-rank projections</span>
</span></span><span class="line"><span class="cl"><span class="c">% If A is a 10-dim tensor, A1,A2,...,A10 directions are expected.</span>
</span></span><span class="line"><span class="cl"><span class="c">% A1 has 2 factors, A2 has 2 factors, ...</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">A3</span><span class="p">]</span> <span class="p">=</span> <span class="n">fac2let</span><span class="p">(</span><span class="n">model</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">% Plot the 2 factors (vectors) in each component.</span>
</span></span><span class="line"><span class="cl"><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="s">&#39;Linewidth&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>   <span class="c">% </span>
</span></span><span class="line"><span class="cl"><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="s">&#39;Linewidth&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">A3</span><span class="p">,</span> <span class="s">&#39;Linewidth&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In y direction has two gaussian: $e^{-0.5y^2}$ and $e^(-0.2y^2)$</p>
<p>In x direction, there are a gaussian $e^(-x^2)$ and $sech(x)*tanh(x)$</p>
<p>In t direciton, cos(2t) and sin(t) are pulled out.</p>

</section>


    <footer class="article-footer">
    

    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>

    

    

    


    
    


    
    

</article>



    

    

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2024 Zichen Wang
    </section>
    
    <section class="powerby">
        
              <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a>
   <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
