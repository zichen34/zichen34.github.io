<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='F.grid_sample F.grid_sample(tensor,p,mode) 把 tensor 插补成与网格 p 有相同大小的 tensor。 网格p指定了在 input 上的采样点坐标，在采样点附近插值形成一个新像素，各 channel 上采样点相同。 grid 中的 (x,y) 已缩放到 [-1,1]，在函数内变换到 [0,W],[0,H] 索引像素 PyTorch中grid_sample的使用方法-csdn
mode = &amp;lsquo;bilinear&amp;rsquo; 是三线性插值: 双线性插值（bilinear）的3D形式(卿卿小徐的评论); c&#43;&#43;源码
4D input 对应一个 batch 的图片 (B,C,H,W)。
align_corners = True 认为input以像素为单位，各像素由其中心点代表，从而做双线性插值的时候，就用像素的四个角点； (2023-10-08: 角点？邻点？)
False 是把 input 当作各像素角点的集合，此时 input 的边界 (W-1,H-1) 小于原来的图片边界 (W,H)，则grid采样点的坐标可能超出 input边界（比如采样点落在图片边缘，而双线性插值需要用周围 4 个点），所以需要在input外围padding，再与各neighbor点做插值。
torch.nn.functional.grid_sample() 函数实例-csdn
As shown below, black points are input datapoints. In the left figure, the datapoints fit the pixels corners of the input image to be scaled, whereas in the right figure, the datapoints forms an independent image to perform interpolation.'>
<title>memo: PyTorch | Sample &amp; Interpolation</title>

<link rel='canonical' href='https://zichen34.github.io/writenotes/lib/pytorch_sample_interpolate/'>

<link rel="stylesheet" href="/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css"><meta property='og:title' content='memo: PyTorch | Sample &amp; Interpolation'>
<meta property='og:description' content='F.grid_sample F.grid_sample(tensor,p,mode) 把 tensor 插补成与网格 p 有相同大小的 tensor。 网格p指定了在 input 上的采样点坐标，在采样点附近插值形成一个新像素，各 channel 上采样点相同。 grid 中的 (x,y) 已缩放到 [-1,1]，在函数内变换到 [0,W],[0,H] 索引像素 PyTorch中grid_sample的使用方法-csdn
mode = &amp;lsquo;bilinear&amp;rsquo; 是三线性插值: 双线性插值（bilinear）的3D形式(卿卿小徐的评论); c&#43;&#43;源码
4D input 对应一个 batch 的图片 (B,C,H,W)。
align_corners = True 认为input以像素为单位，各像素由其中心点代表，从而做双线性插值的时候，就用像素的四个角点； (2023-10-08: 角点？邻点？)
False 是把 input 当作各像素角点的集合，此时 input 的边界 (W-1,H-1) 小于原来的图片边界 (W,H)，则grid采样点的坐标可能超出 input边界（比如采样点落在图片边缘，而双线性插值需要用周围 4 个点），所以需要在input外围padding，再与各neighbor点做插值。
torch.nn.functional.grid_sample() 函数实例-csdn
As shown below, black points are input datapoints. In the left figure, the datapoints fit the pixels corners of the input image to be scaled, whereas in the right figure, the datapoints forms an independent image to perform interpolation.'>
<meta property='og:url' content='https://zichen34.github.io/writenotes/lib/pytorch_sample_interpolate/'>
<meta property='og:site_name' content='Zichen Wang'>
<meta property='og:type' content='article'><meta property='article:section' content='WriteNotes' /><meta property='article:published_time' content='2022-06-23T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2022-06-23T00:00:00&#43;00:00'/>
<meta name="twitter:title" content="memo: PyTorch | Sample &amp; Interpolation">
<meta name="twitter:description" content="F.grid_sample F.grid_sample(tensor,p,mode) 把 tensor 插补成与网格 p 有相同大小的 tensor。 网格p指定了在 input 上的采样点坐标，在采样点附近插值形成一个新像素，各 channel 上采样点相同。 grid 中的 (x,y) 已缩放到 [-1,1]，在函数内变换到 [0,W],[0,H] 索引像素 PyTorch中grid_sample的使用方法-csdn
mode = &amp;lsquo;bilinear&amp;rsquo; 是三线性插值: 双线性插值（bilinear）的3D形式(卿卿小徐的评论); c&#43;&#43;源码
4D input 对应一个 batch 的图片 (B,C,H,W)。
align_corners = True 认为input以像素为单位，各像素由其中心点代表，从而做双线性插值的时候，就用像素的四个角点； (2023-10-08: 角点？邻点？)
False 是把 input 当作各像素角点的集合，此时 input 的边界 (W-1,H-1) 小于原来的图片边界 (W,H)，则grid采样点的坐标可能超出 input边界（比如采样点落在图片边缘，而双线性插值需要用周围 4 个点），所以需要在input外围padding，再与各neighbor点做插值。
torch.nn.functional.grid_sample() 函数实例-csdn
As shown below, black points are input datapoints. In the left figure, the datapoints fit the pixels corners of the input image to be scaled, whereas in the right figure, the datapoints forms an independent image to perform interpolation.">
    <link rel="shortcut icon" href="/favicon-32x32.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu238e2fe759432347fa5dd53661ac4381_131637_300x0_resize_box_3.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Zichen Wang</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/zichen34'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com/luckily1640'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/aboutme/' >
                
                
                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/writenotes/' >
                
                
                
                <span>WriteNotes</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#fgrid_sample">F.grid_sample</a>
      <ol>
        <li><a href="#ex-in-gnt">Ex in GNT</a></li>
      </ol>
    </li>
    <li><a href="#finterpolate">F.interpolate</a></li>
    <li><a href="#nnupsample">nn.Upsample</a></li>
    <li><a href="#downsample">Downsample</a></li>
    <li><a href="#trilinear-interp">Trilinear Interp</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/writenotes/lib/pytorch_sample_interpolate/">memo: PyTorch | Sample &amp; Interpolation</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jun 23, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    4 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="fgrid_sample">F.grid_sample</h2>
<p><code>F.grid_sample(tensor,p,mode)</code> 把 tensor 插补成与网格 p 有相同大小的 tensor。
网格p指定了在 input 上的采样点坐标，在采样点附近插值形成一个新像素，各 channel 上采样点相同。
grid 中的 (x,y) 已缩放到 [-1,1]，在函数内变换到 [0,W],[0,H] 索引像素
<a class="link" href="https://blog.csdn.net/qq_34914551/article/details/107559031"  target="_blank" rel="noopener"
    >PyTorch中grid_sample的使用方法-csdn</a></p>
<ul>
<li>
<p>mode = &lsquo;bilinear&rsquo; 是三线性插值:
<a class="link" href="https://zhuanlan.zhihu.com/p/77496615"  target="_blank" rel="noopener"
    >双线性插值（bilinear）的3D形式</a>(卿卿小徐的评论);
<a class="link" href="https://github.com/pytorch/pytorch/blob/f064c5aa33483061a48994608d890b968ae53fb5/aten/src/THNN/generic/SpatialGridSamplerBilinear.c#L65-L81"  target="_blank" rel="noopener"
    >c++源码</a></p>
</li>
<li>
<p>4D input 对应一个 batch 的图片 (B,C,H,W)。</p>
</li>
<li>
<p><code>align_corners = True</code> 认为input以像素为单位，各像素由其中心点代表，从而做双线性插值的时候，就用像素的四个角点；
(2023-10-08: 角点？邻点？)</p>
<ul>
<li>
<p><code>False</code> 是把 input 当作各像素角点的集合，此时 input 的边界 (W-1,H-1) 小于原来的图片边界 (W,H)，则grid采样点的坐标可能超出 input边界（比如采样点落在图片边缘，而双线性插值需要用周围 4 个点），所以需要在input外围padding，再与各neighbor点做插值。</p>
<p><a class="link" href="https://blog.csdn.net/weixin_44109545/article/details/120537016"  target="_blank" rel="noopener"
    >torch.nn.functional.grid_sample() 函数实例-csdn</a></p>
</li>
<li>
<p>As shown below, black points are input datapoints.
In the left figure, the datapoints fit the pixels corners of the input image to be scaled,
whereas in the right figure, the datapoints forms an independent image to perform interpolation.</p>
</li>
</ul>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 256 153"
      >
      <g transform='translate(8,16)'>
<path d='M 0,0 L 32,0' fill='none' stroke='currentColor'></path>
<path d='M 32,0 L 64,0' fill='none' stroke='currentColor'></path>
<path d='M 64,0 L 96,0' fill='none' stroke='currentColor'></path>
<path d='M 144,16 L 176,16' fill='none' stroke='currentColor'></path>
<path d='M 176,16 L 208,16' fill='none' stroke='currentColor'></path>
<path d='M 0,32 L 32,32' fill='none' stroke='currentColor'></path>
<path d='M 32,32 L 64,32' fill='none' stroke='currentColor'></path>
<path d='M 64,32 L 96,32' fill='none' stroke='currentColor'></path>
<path d='M 144,48 L 176,48' fill='none' stroke='currentColor'></path>
<path d='M 176,48 L 208,48' fill='none' stroke='currentColor'></path>
<path d='M 0,64 L 32,64' fill='none' stroke='currentColor'></path>
<path d='M 32,64 L 64,64' fill='none' stroke='currentColor'></path>
<path d='M 64,64 L 96,64' fill='none' stroke='currentColor'></path>
<path d='M 144,80 L 176,80' fill='none' stroke='currentColor'></path>
<path d='M 176,80 L 208,80' fill='none' stroke='currentColor'></path>
<path d='M 0,96 L 32,96' fill='none' stroke='currentColor'></path>
<path d='M 32,96 L 64,96' fill='none' stroke='currentColor'></path>
<path d='M 64,96 L 96,96' fill='none' stroke='currentColor'></path>
<path d='M 0,0 L 0,32' fill='none' stroke='currentColor'></path>
<path d='M 0,32 L 0,64' fill='none' stroke='currentColor'></path>
<path d='M 0,64 L 0,96' fill='none' stroke='currentColor'></path>
<path d='M 32,0 L 32,32' fill='none' stroke='currentColor'></path>
<path d='M 32,32 L 32,64' fill='none' stroke='currentColor'></path>
<path d='M 32,64 L 32,96' fill='none' stroke='currentColor'></path>
<path d='M 64,0 L 64,32' fill='none' stroke='currentColor'></path>
<path d='M 64,32 L 64,64' fill='none' stroke='currentColor'></path>
<path d='M 64,64 L 64,96' fill='none' stroke='currentColor'></path>
<path d='M 96,0 L 96,32' fill='none' stroke='currentColor'></path>
<path d='M 96,32 L 96,64' fill='none' stroke='currentColor'></path>
<path d='M 96,64 L 96,96' fill='none' stroke='currentColor'></path>
<path d='M 144,16 L 144,48' fill='none' stroke='currentColor'></path>
<path d='M 144,48 L 144,80' fill='none' stroke='currentColor'></path>
<path d='M 176,16 L 176,48' fill='none' stroke='currentColor'></path>
<path d='M 176,48 L 176,80' fill='none' stroke='currentColor'></path>
<path d='M 208,16 L 208,48' fill='none' stroke='currentColor'></path>
<path d='M 208,48 L 208,80' fill='none' stroke='currentColor'></path>
<circle cx='16' cy='16' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='16' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='16' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='48' cy='16' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='48' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='48' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='80' cy='16' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='80' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='80' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='144' cy='16' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='144' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='144' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='176' cy='16' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='176' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='176' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='208' cy='16' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='208' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='208' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='0' y='116' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='0' y='132' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='8' y='116' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='16' y='116' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='16' y='132' fill='currentColor' style='font-size:1em'>T</text>
<text text-anchor='middle' x='24' y='116' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='24' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='32' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='32' y='132' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='40' y='116' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='40' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='48' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='56' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='64' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='72' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='80' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='88' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='96' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='144' y='116' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='144' y='132' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='152' y='116' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='160' y='116' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='160' y='132' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='168' y='116' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='168' y='132' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='176' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='176' y='132' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='184' y='116' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='184' y='132' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='192' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='192' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='200' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='208' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='216' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='224' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='232' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='240' y='116' fill='currentColor' style='font-size:1em'>s</text>
</g>

    </svg>
  
</div>
<ul>
<li>
<p>A numerical example of difference: <a class="link" href="https://pytorch.org/docs/stable/generated/torch.nn.Upsample.html"  target="_blank" rel="noopener"
    >Docs - nn.Upsample</a></p>
</li>
<li>
<p>(2024-03-09) In the left figure, the <strong>corners of the grid</strong> formed by pixels and sampling points are aligned.
Whereas, the right figure isn&rsquo;t.</p>
</li>
</ul>
</li>
<li>
<p>像素中心点的位置与一个像素的大小有关，所以对于相同维度的输入，采样点坐标可能不同。
所以使用像素角点做为基准 (<code>align_corners = False</code>)，与像素尺寸无关，采样点位置是相对的。
<a class="link" href="https://pytorch.org/docs/stable/generated/torch.nn.functional.grid_sample.html"  target="_blank" rel="noopener"
    >Docs</a></p>
</li>
<li>
<p>线性插值是一维长度的加权平均，双线性插值是二维面积（两个方向）的加权平均：每个顶点的权重是其对角位置上的矩阵面积占比；三线性插值是三维体积的加权和。</p>
<p><a class="link" href="https://www.bilibili.com/video/BV1vx4y1L7P8"  target="_blank" rel="noopener"
    >【三维重建和NeRF常用的三线性插值，原理讲解+代码实现】-意の茗</a></p>
</li>
<li>
<p>双线性插值：在x方向和y方向上做线性回归并预测在目标点上的数值。所插值是周围4个neighbor的加权和，权重是两方向上neighbor到目标点距离与两点间距之比的乘积</p>
<p><a class="link" href="https://zhuanlan.zhihu.com/p/112030273"  target="_blank" rel="noopener"
    >grid_sample()函数及双线性采样 - 180天后再改名的文章 - 知乎</a></p>
</li>
</ul>
<ul>
<li>
<p>(2023-12-18) <code>F.grid_sample()</code> cannot sample images?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">cv2</span>
</span></span><span class="line"><span class="cl"><span class="n">src</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&#34;dtu/Rectified/scan11_train/rect_011_3_r5000.png&#34;</span><span class="p">)</span> <span class="c1"># ndarray, (h,w,3)</span>
</span></span><span class="line"><span class="cl"><span class="n">F</span><span class="o">.</span><span class="n">grid_sample</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">uv_src</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">192</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>And it will lead to: <code>RuntimeError: grid_sampler_2d_cpu not implemented for Byte</code></p>
<p>Therefore, the image requires to be normalized to [0,1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">PIL</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">torchvision</span> <span class="kn">import</span> <span class="n">transforms</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">160</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span><span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">normalized_y</span><span class="p">,</span> <span class="n">normalized_x</span> <span class="o">=</span> <span class="n">y</span><span class="o">/</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="o">/</span><span class="n">w</span>
</span></span><span class="line"><span class="cl"><span class="n">normalized_xy</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">normalized_x</span><span class="p">,</span> <span class="n">normalized_y</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">src</span> <span class="o">=</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&#34;dtu/Rectified/scan11_train/rect_009_6_r5000.png&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">src</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">()(</span><span class="n">src</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">samp</span><span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">grid_sample</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">normalized_xy</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># revert to an image</span>
</span></span><span class="line"><span class="cl"><span class="n">samp_scaled</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">samp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">samp_scaled</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h3 id="ex-in-gnt">Ex in GNT</h3>
<p><code>train_imgs</code> is a 4D tesnor.</p>
<p><code>featmaps</code> is a 5D tensor (N, Chanl, D, H, W,), the first dimension also vary determined by the indexing tensor</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># compute the projection of the query points to each reference image</span>
</span></span><span class="line"><span class="cl"><span class="n">pixel_locations</span><span class="p">,</span> <span class="n">mask_in_front</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_projections</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">train_cameras</span><span class="p">)</span>   <span class="c1"># pixel coords: (n_views, n_rays, n_samples, 2), (n_views, n_rays, n_samples)</span>
</span></span><span class="line"><span class="cl"><span class="n">normalized_pixel_locations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span>    <span class="c1"># pixel coords range: ([0,h],[0,w])-&gt; [-1,1] for F.grid_sample</span>
</span></span><span class="line"><span class="cl">    <span class="n">pixel_locations</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>  <span class="c1"># [n_views, n_rays, n_samples, 2]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># rgb sampling</span>
</span></span><span class="line"><span class="cl"><span class="n">rgbs_sampled</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">grid_sample</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">train_imgs</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">normalized_pixel_locations</span><span class="p">,</span> <span class="n">align_corners</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># (n_views, 3, n_rays, n_samples)</span>
</span></span><span class="line"><span class="cl"><span class="n">rgb_sampled</span> <span class="o">=</span> <span class="n">rgbs_sampled</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># [n_rays, n_samples, n_views, 3]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># deep feature sampling     # sample n_view feature maps for each 3D point. All chanls on the location in a feature map will be taken.</span>
</span></span><span class="line"><span class="cl"><span class="n">feat_sampled</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">grid_sample</span><span class="p">(</span><span class="n">featmaps</span><span class="p">,</span> <span class="n">normalized_pixel_locations</span><span class="p">,</span> <span class="n">align_corners</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># (n_views, out_chnls, H, W)-&gt;(n_views, out_chnls, n_rays,n_samples)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="finterpolate">F.interpolate</h2>
<p><code>F.interpolate(input, size, [scale_factor,] mode, )</code> 把 input 缩放到 size，或者各维度缩放 factor 倍。
插值算法为mode。可以处理3D,4D,5D input。4D input的维度：(B, chnls, H, W)
<a class="link" href="https://pytorch.org/docs/stable/generated/torch.nn.functional.interpolate.html"  target="_blank" rel="noopener"
    >Docs</a></p>
<hr>
<p>(2023-10-10)</p>
<h2 id="nnupsample">nn.Upsample</h2>
<p>This &ldquo;layer&rdquo; has no learnable parameters:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">upsampler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Upsample</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&#34;bilinear&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">dict</span><span class="p">(</span><span class="n">upsampler</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">())</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># out:  dict_items([])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>So it may be equal to <code>torch.nn.functional.interpolate</code>, which can be used as a layer in a model:
<a class="link" href="https://discuss.pytorch.org/t/which-function-is-better-for-upsampling-upsampling-or-interpolate/21811/8"  target="_blank" rel="noopener"
    >Which function is better for upsampling: upsampling or interpolate?</a></p>
</li>
<li>
<p><code>torch.nn.functional</code> <strong>layers</strong> require passing the learnable parameters from outside, since they don&rsquo;t contain <code>nn.Parameter</code> like <code>nn.Module</code> does.
<a class="link" href="https://discuss.pytorch.org/t/are-torch-nn-functional-layers-learnable/13687/2"  target="_blank" rel="noopener"
    >Are torch.nn.Functional layers learnable?</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">super</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">out_features</span><span class="p">,</span> <span class="n">in_features</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">out_features</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Corresponding to a nn.module:</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">linear</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">bias</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># return self.linear(input)</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<p>(2023-10-22)</p>
<h2 id="downsample">Downsample</h2>
<ol>
<li>
<p>Conv layer can perform evenly downsampling, referring to <a class="link" href="https://github.com/ma-xu/Context-Cluster/blob/3ccb0b6768236c14ab8e4ec3df2f215b46920cbf/models/context_cluster.py#L72"  target="_blank" rel="noopener"
    >Context Cluster</a>
Reducing points by fusing neighbors covered by kernels:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">proj</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">in_chans</span><span class="p">,</span> <span class="n">embed_dim</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="n">patch_size</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">stride</span><span class="o">=</span><span class="n">stride</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Pooling can also be used for placing centers, referring to <a class="link" href="https://github.com/ma-xu/Context-Cluster/blob/3ccb0b6768236c14ab8e4ec3df2f215b46920cbf/models/context_cluster.py#L129"  target="_blank" rel="noopener"
    >Context Cluster</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">centers_proposal</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveAvgPool2d</span><span class="p">((</span><span class="n">proposal_w</span><span class="p">,</span> <span class="n">proposal_h</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>F.interpolate</p>
</li>
</ol>
<hr>
<h2 id="trilinear-interp">Trilinear Interp</h2>
<p>(2024-02-28)</p>
<p>Perform 2-point interpolation in 3 directions sequentially:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 136 153"
      >
      <g transform='translate(8,16)'>
<path d='M 32,80 L 56,80' fill='none' stroke='currentColor'></path>
<path d='M 56,80 L 88,80' fill='none' stroke='currentColor'></path>
<path d='M 16,32 L 16,96' fill='none' stroke='currentColor'></path>
<path d='M 104,32 L 104,64' fill='none' stroke='currentColor'></path>
<path d='M 104,64 L 104,96' fill='none' stroke='currentColor'></path>
<path d='M 0,64 L 16,32' fill='none' stroke='currentColor'></path>
<path d='M 16,32 L 32,0' fill='none' stroke='currentColor'></path>
<path d='M 0,128 L 16,96' fill='none' stroke='currentColor'></path>
<path d='M 16,96 L 32,64' fill='none' stroke='currentColor'></path>
<path d='M 88,64 L 104,32' fill='none' stroke='currentColor'></path>
<path d='M 104,32 L 120,0' fill='none' stroke='currentColor'></path>
<path d='M 88,128 L 104,96' fill='none' stroke='currentColor'></path>
<path d='M 104,96 L 120,64' fill='none' stroke='currentColor'></path>
<circle cx='0' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='0' cy='128' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='32' cy='0' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='32' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='56' cy='80' r='6' stroke='currentColor' fill='#fff'></circle>
<circle cx='88' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='88' cy='128' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='120' cy='0' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='120' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
</g>

    </svg>
  
</div>
<p>Each point has 3 weights: u, v, w (or (1-u), (1-v), (1-w))</p>

</section>


    <footer class="article-footer">
    

    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>

    

    

    


    
    


    
    

</article>



    

    

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2024 Zichen Wang
    </section>
    
    <section class="powerby">
        
              <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a>
   <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
