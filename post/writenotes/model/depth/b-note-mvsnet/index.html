<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="MVSNet: Depth Inference for Unstructured Multi-view Stereo (ECCV 2018)">
<meta name="keywords" content="MVS"><title>Read: Depth - MVG | MVSNet</title>

<link rel='canonical' href='http://blog.zichen.uk/post/writenotes/model/depth/b-note-mvsnet/'>

<link rel="stylesheet" href="/scss/style.min.0e95b70faf4f470dc6ba88da538ece0f8cf22d03bab371e1b345205b81899732.css"><meta property='og:title' content="Read: Depth - MVG | MVSNet">
<meta property='og:description' content="MVSNet: Depth Inference for Unstructured Multi-view Stereo (ECCV 2018)">
<meta property='og:url' content='http://blog.zichen.uk/post/writenotes/model/depth/b-note-mvsnet/'>
<meta property='og:site_name' content='Zichen Wang'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='MVG' /><meta property='article:published_time' content='2023-12-03T00:49:00&#43;00:00'/><meta property='article:modified_time' content='2023-12-03T00:49:00&#43;00:00'/><meta property='og:image' content='https://ar5iv.labs.arxiv.org/html/1804.02505/assets/x1.png' />
<meta name="twitter:title" content="Read: Depth - MVG | MVSNet">
<meta name="twitter:description" content="MVSNet: Depth Inference for Unstructured Multi-view Stereo (ECCV 2018)"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://ar5iv.labs.arxiv.org/html/1804.02505/assets/x1.png' />
    <link rel="shortcut icon" href="/favicon-32x32.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_b598b46054b3fa80.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Zichen Wang</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/zichen34'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com/luckily1640'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/post/writenotes/' >
                
                
                
                <span>WriteNotes</span>
            </a>
        </li>
        
        
        <li >
            <a href='/post/writenotes/model/acadmodel/aboutme/' >
                
                
                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#notes">Notes</a>
      <ol>
        <li><a href="#task">Task</a></li>
        <li><a href="#implicit-camera-pose">Implicit Camera Pose</a></li>
        <li><a href="#estimate-by-variance">Estimate by Variance</a></li>
        <li><a href="#why-use-variance">Why use variance?</a></li>
        <li><a href="#cost-volume">Cost Volume</a></li>
        <li><a href="#code-understand">Code Understand</a></li>
        <li><a href="#point-cloud">Point Cloud</a></li>
        <li><a href="#actice-recall-exercise">Actice Recall Exercise</a></li>
      </ol>
    </li>
    <li><a href="#play">Play</a>
      <ol>
        <li><a href="#profiler">Profiler</a></li>
        <li><a href="#dtu">DTU</a></li>
        <li><a href="#read-gt-depth">Read GT Depth</a></li>
        <li><a href="#environment">Environment</a></li>
      </ol>
    </li>
    <li><a href="#related">Related</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/post/writenotes/model/depth/b-note-mvsnet/">
                
                    <img src="https://ar5iv.labs.arxiv.org/html/1804.02505/assets/x1.png" loading="lazy" alt="Featured image of post Read: Depth - MVG | MVSNet" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/read/" style="background-color: #2a9d8f; color: #fff;">
                Read
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/post/writenotes/model/depth/b-note-mvsnet/">Read: Depth - MVG | MVSNet</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            MVSNet: Depth Inference for Unstructured Multi-view Stereo (ECCV 2018)
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Dec 03, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    22 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
<section class="toc toc--inline">
    <h2 class="">Table of contents</h2>
    <div class="" >
        <nav id="TableOfContents">
  <ol>
    <li><a href="#notes">Notes</a>
      <ol>
        <li><a href="#task">Task</a></li>
        <li><a href="#implicit-camera-pose">Implicit Camera Pose</a></li>
        <li><a href="#estimate-by-variance">Estimate by Variance</a></li>
        <li><a href="#why-use-variance">Why use variance?</a></li>
        <li><a href="#cost-volume">Cost Volume</a></li>
        <li><a href="#code-understand">Code Understand</a></li>
        <li><a href="#point-cloud">Point Cloud</a></li>
        <li><a href="#actice-recall-exercise">Actice Recall Exercise</a></li>
      </ol>
    </li>
    <li><a href="#play">Play</a>
      <ol>
        <li><a href="#profiler">Profiler</a></li>
        <li><a href="#dtu">DTU</a></li>
        <li><a href="#read-gt-depth">Read GT Depth</a></li>
        <li><a href="#environment">Environment</a></li>
      </ol>
    </li>
    <li><a href="#related">Related</a></li>
  </ol>
</nav>

    </div>
</section>



    
    
    <p><a class="link" href="https://github.com/YoYo000/MVSNet"  target="_blank" rel="noopener"
    >Code</a>
| <a class="link" href="https://arxiv.org/abs/1804.02505"  target="_blank" rel="noopener"
    >Arxiv</a>
| <a class="link" href="https://scholar.google.com/scholar?cluster=16605177570806066111&amp;hl=en&amp;as_sdt=0,5"  target="_blank" rel="noopener"
    >GScholar</a>
| <a class="link" href="https://github.com/search?q=mvsnet%20pytorch&amp;type=repositories"  target="_blank" rel="noopener"
    >mvsnet pytorch</a></p>
<h2 id="notes">Notes
</h2><p>(2024-10-11)</p>
<ul>
<li>可微单应性变换: &ldquo;Differentiable&rdquo; means &ldquo;Matrix multiplication&rdquo;
<a class="link" href="https://www.bilibili.com/video/BV1put2ehEka?t=96.3"  target="_blank" rel="noopener"
    >多视图三维重建技术发展 - bilibili推荐</a>
<ul>
<li>slides 是用 XMind 做的</li>
</ul>
</li>
</ul>
<hr>
<h3 id="task">Task
</h3><p>The model predicts a <strong>single depth map</strong> at once instead of an entire scene:</p>
<ul>
<li>
<p>MVSNet can reconstruct a large scene by performing <strong>per-view</strong> depth map estimation repeatedly.</p>
<p>&ldquo;Per-view&rdquo; also appears in <a class="link" href="https://www-sop.inria.fr/reves/Basilic/2021/KPLD21/"  target="_blank" rel="noopener"
    >Point-Based Neural Rendering with Per-View Optimization - Inria</a>.</p>
</li>
<li>
<p>The estimated depth map of the reference view is a <strong>weighted sum</strong> of multiple <strong>predefined depth</strong> values,
where the weights are <strong>regressed from the variance</strong> of multi-view cost volumes by a 3D UNet-like network.</p>
</li>
<li>
<p>A cost volume is a <strong>structure-fixed container</strong> (file holder) in the <strong>reference camera space</strong>,
with each compartment holding a source view&rsquo;s feature map
that requires <strong>warping</strong> to align with the camera pose and depth before being inserted into each slot.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 432 121"
      >
      <g transform='translate(8,16)'>
<path d='M 152,0 L 168,0' fill='none' stroke='currentColor'></path>
<path d='M 168,0 L 184,0' fill='none' stroke='currentColor'></path>
<path d='M 184,0 L 200,0' fill='none' stroke='currentColor'></path>
<path d='M 200,0 L 216,0' fill='none' stroke='currentColor'></path>
<path d='M 216,0 L 232,0' fill='none' stroke='currentColor'></path>
<path d='M 168,80 L 184,80' fill='none' stroke='currentColor'></path>
<path d='M 184,80 L 200,80' fill='none' stroke='currentColor'></path>
<path d='M 200,80 L 216,80' fill='none' stroke='currentColor'></path>
<path d='M 216,80 L 232,80' fill='none' stroke='currentColor'></path>
<path d='M 232,80 L 248,80' fill='none' stroke='currentColor'></path>
<path d='M 0,32 L 0,48' fill='none' stroke='currentColor'></path>
<path d='M 16,0 L 16,80' fill='none' stroke='currentColor'></path>
<path d='M 152,0 L 152,48' fill='none' stroke='currentColor'></path>
<path d='M 168,32 L 168,80' fill='none' stroke='currentColor'></path>
<path d='M 184,32 L 184,80' fill='none' stroke='currentColor'></path>
<path d='M 200,32 L 200,80' fill='none' stroke='currentColor'></path>
<path d='M 216,32 L 216,80' fill='none' stroke='currentColor'></path>
<path d='M 232,32 L 232,80' fill='none' stroke='currentColor'></path>
<path d='M 248,32 L 248,80' fill='none' stroke='currentColor'></path>
<path d='M 0,32 L 16,0' fill='none' stroke='currentColor'></path>
<path d='M 0,48 L 16,80' fill='none' stroke='currentColor'></path>
<path d='M 152,48 L 168,80' fill='none' stroke='currentColor'></path>
<path d='M 152,0 L 168,32' fill='none' stroke='currentColor'></path>
<path d='M 168,0 L 184,32' fill='none' stroke='currentColor'></path>
<path d='M 184,0 L 200,32' fill='none' stroke='currentColor'></path>
<path d='M 200,0 L 216,32' fill='none' stroke='currentColor'></path>
<path d='M 216,0 L 232,32' fill='none' stroke='currentColor'></path>
<path d='M 232,0 L 248,32' fill='none' stroke='currentColor'></path>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='40' y='36' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='40' y='52' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='40' y='68' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='48' y='20' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='48' y='36' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='48' y='52' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='48' y='68' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='56' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='56' y='36' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='56' y='52' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='56' y='68' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='64' y='52' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='64' y='68' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='72' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='72' y='52' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='72' y='68' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='80' y='20' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='80' y='36' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='80' y='52' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='80' y='68' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='88' y='20' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='88' y='52' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='96' y='20' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='96' y='36' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='96' y='52' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='96' y='68' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='104' y='20' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='104' y='36' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='104' y='52' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='104' y='68' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='112' y='20' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='112' y='36' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='112' y='68' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='120' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='120' y='68' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='120' y='100' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='128' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='128' y='68' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='128' y='100' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='136' y='100' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='144' y='100' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='160' y='100' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='168' y='100' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='176' y='100' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='184' y='100' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='192' y='100' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='200' y='100' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='208' y='100' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='216' y='100' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='224' y='100' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='232' y='100' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='240' y='100' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='248' y='100' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='256' y='100' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='272' y='36' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='272' y='52' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='272' y='100' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='280' y='52' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='280' y='100' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='288' y='36' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='288' y='52' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='288' y='100' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='296' y='36' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='296' y='52' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='304' y='36' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='304' y='52' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='304' y='100' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='312' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='312' y='52' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='312' y='100' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='320' y='36' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='320' y='100' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='328' y='36' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='328' y='52' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='328' y='100' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='336' y='52' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='336' y='100' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='344' y='36' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='344' y='52' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='352' y='36' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='352' y='52' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='352' y='100' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='360' y='52' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='360' y='100' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='368' y='36' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='368' y='52' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='368' y='100' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='376' y='36' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='376' y='52' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='376' y='100' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='384' y='36' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='384' y='100' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='392' y='36' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='392' y='52' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='392' y='100' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='400' y='36' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='400' y='52' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='400' y='100' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='408' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='408' y='52' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='416' y='52' fill='currentColor' style='font-size:1em'>s</text>
</g>

    </svg>
  
</div>
</li>
<li>
<p>(2023-12-13) In contrast, NeRF lacks a <strong>unified spatial structure</strong> to facilitate multi-view geometry consistency.</p>
<details><summary>Per-ray sampling & Scene-specific</summary>
<ul>
<li>
<p>Each view samples depths and maintains a point cloud in its own frustum <strong>for rendering</strong> (not for reconstructing the global geometry),
and the fine-stage sampling results in each ray having different sampled points.</p>
<ul>
<li>(2024-02-19) The sampled points don&rsquo;t have standardized geometric structure,
because NeRF is a &ldquo;continuous&rdquo; filed, whose continuity is achieved by an MLP.
NeRF encompassed multi views into a <strong>Radiance</strong> filed, so the scene geometry is not directly modeled and constrained.</li>
</ul>
<p>Consequently, <strong>multi-view (geometry) inconsistency</strong> (floater) is incurred.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 408 137"
      >
      <g transform='translate(8,16)'>
<path d='M 328,16 L 352,16' fill='none' stroke='currentColor'></path>
<path d='M 288,32 L 304,32' fill='none' stroke='currentColor'></path>
<path d='M 304,32 L 320,32' fill='none' stroke='currentColor'></path>
<path d='M 56,48 L 72,48' fill='none' stroke='currentColor'></path>
<path d='M 72,48 L 88,48' fill='none' stroke='currentColor'></path>
<path d='M 88,48 L 96,48' fill='none' stroke='currentColor'></path>
<path d='M 168,96 L 200,96' fill='none' stroke='currentColor'></path>
<path d='M 32,32 L 32,48' fill='none' stroke='currentColor'></path>
<path d='M 48,0 L 48,80' fill='none' stroke='currentColor'></path>
<path d='M 184,16 L 184,32' fill='none' stroke='currentColor'></path>
<path d='M 184,32 L 184,64' fill='none' stroke='currentColor'></path>
<path d='M 184,64 L 184,80' fill='none' stroke='currentColor'></path>
<path d='M 344,64 L 344,80' fill='none' stroke='currentColor'></path>
<path d='M 344,80 L 344,96' fill='none' stroke='currentColor'></path>
<path d='M 32,32 L 48,0' fill='none' stroke='currentColor'></path>
<path d='M 64,32 L 72,16' fill='none' stroke='currentColor'></path>
<path d='M 72,16 L 80,0' fill='none' stroke='currentColor'></path>
<path d='M 200,80 L 208,64' fill='none' stroke='currentColor'></path>
<path d='M 208,64 L 224,32' fill='none' stroke='currentColor'></path>
<path d='M 224,32 L 232,16' fill='none' stroke='currentColor'></path>
<path d='M 192,112 L 200,96' fill='none' stroke='currentColor'></path>
<path d='M 312,80 L 320,64' fill='none' stroke='currentColor'></path>
<path d='M 320,64 L 328,48' fill='none' stroke='currentColor'></path>
<path d='M 352,64 L 364,40' fill='none' stroke='currentColor'></path>
<path d='M 32,48 L 48,80' fill='none' stroke='currentColor'></path>
<path d='M 64,64 L 72,80' fill='none' stroke='currentColor'></path>
<path d='M 72,80 L 80,96' fill='none' stroke='currentColor'></path>
<path d='M 168,96 L 176,112' fill='none' stroke='currentColor'></path>
<path d='M 136,16 L 144,32' fill='none' stroke='currentColor'></path>
<path d='M 144,32 L 160,64' fill='none' stroke='currentColor'></path>
<path d='M 160,64 L 168,80' fill='none' stroke='currentColor'></path>
<path d='M 328,16 L 352,64' fill='none' stroke='currentColor'></path>
<path d='M 352,16 L 364,40' fill='none' stroke='currentColor'></path>
<path d='M 184,80 L 184,88' fill='none' stroke='currentColor'></path>
<circle cx='72' cy='16' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='72' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='72' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='88' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='144' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='160' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='184' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='184' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='208' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='224' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='304' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='320' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='344' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='0' y='52' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='8' y='52' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='8' y='68' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='16' y='52' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='24' y='52' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='208' y='116' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='216' y='116' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='224' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='232' y='116' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='248' y='116' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='368' y='20' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='376' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='376' y='36' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='384' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='392' y='20' fill='currentColor' style='font-size:1em'>w</text>
</g>

    </svg>
  
</div>
</li>
<li>
<p>NeRF samples <strong>per ray</strong> rather than the whole space because
it employs the <strong>volume rendering</strong> method to generate <strong>view-dependent</strong> images.
The <strong>primary goal</strong> is achieving accurate pixels by optimizing the <strong>alignment</strong> of volume density σ and voxel color c
on an arbitrary piont due to the volume rendering equaiton,
while the overall geometry is not focused specifically.</p>
<p>In other words, since what NeRF learned is the <strong>match</strong> between density and voxel color,
even if the densities (geometry) are wrong, with colors compensated, the composition could be plausible.
Despite the multi-view consistency constraint during training,
the geometry estimation (surface) is inherently biased. (NeuS)</p>
<p>On the other hand, because the <strong>correspondence</strong> between volume density and voxel color is different for various scenes,
the MLP network of NeRF is scene-specific.</p>
</li>
<li>
<p>Similarly, PixelNeRF regress densities and colors from pixel-wise image features in the <strong>frustum of each viewpoint</strong> as well,
instead of the world space.
And multiple views&rsquo; results get aggregated by taking average finally.</p>
</li>
<li>
<p>Per-ray and fine-stage sampling decides NeRF is a <strong>scene-specific</strong> representation because each region is not reconstructed equally.
Although some generalizable NeRFs predict density and color from image features,
the precision won&rsquo;t be high if only image features are input without providing explicit geometry structures.</p>
</li>
</ul>
</details>
</li>
<li>
<p>(2023-12-15) The <strong>whole</strong> space to be reconstructed is split (divide-and-conquer strategy) with some assumption instead of estimating from null.
<a class="link" href="https://www.bilibili.com/video/BV1Ra4y197MG/"  target="_blank" rel="noopener"
    >CVPR2023|基于深度学习MVS的最新进展 GeoMVSNet - 3D视觉工坊</a></p>
</li>
<li>
<p>The resolution of a cost volume is <strong>fixed</strong> (point-mvsnet).
A cost volume is a voxel grid to some extent.</p>
</li>
</ul>
<p>The pipeline of MVSNet:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 520 297"
      >
      <g transform='translate(8,16)'>
<path d='M 128,16 L 152,16' fill='none' stroke='currentColor'></path>
<path d='M 112,48 L 136,48' fill='none' stroke='currentColor'></path>
<path d='M 112,80 L 136,80' fill='none' stroke='currentColor'></path>
<path d='M 80,96 L 104,96' fill='none' stroke='currentColor'></path>
<path d='M 208,96 L 232,96' fill='none' stroke='currentColor'></path>
<path d='M 360,96 L 384,96' fill='none' stroke='currentColor'></path>
<path d='M 64,128 L 88,128' fill='none' stroke='currentColor'></path>
<path d='M 120,128 L 136,128' fill='none' stroke='currentColor'></path>
<path d='M 168,128 L 176,128' fill='none' stroke='currentColor'></path>
<path d='M 192,128 L 216,128' fill='none' stroke='currentColor'></path>
<path d='M 248,128 L 264,128' fill='none' stroke='currentColor'></path>
<path d='M 320,128 L 336,128' fill='none' stroke='currentColor'></path>
<path d='M 344,128 L 368,128' fill='none' stroke='currentColor'></path>
<path d='M 400,128 L 416,128' fill='none' stroke='currentColor'></path>
<path d='M 464,128 L 488,128' fill='none' stroke='currentColor'></path>
<path d='M 64,160 L 88,160' fill='none' stroke='currentColor'></path>
<path d='M 192,160 L 216,160' fill='none' stroke='currentColor'></path>
<path d='M 344,160 L 368,160' fill='none' stroke='currentColor'></path>
<path d='M 96,192 L 120,192' fill='none' stroke='currentColor'></path>
<path d='M 112,224 L 136,224' fill='none' stroke='currentColor'></path>
<path d='M 112,256 L 136,256' fill='none' stroke='currentColor'></path>
<path d='M 32,128 L 32,160' fill='none' stroke='currentColor'></path>
<path d='M 48,96 L 48,128' fill='none' stroke='currentColor'></path>
<path d='M 64,128 L 64,160' fill='none' stroke='currentColor'></path>
<path d='M 72,48 L 72,80' fill='none' stroke='currentColor'></path>
<path d='M 72,208 L 72,240' fill='none' stroke='currentColor'></path>
<path d='M 88,16 L 88,48' fill='none' stroke='currentColor'></path>
<path d='M 88,128 L 88,160' fill='none' stroke='currentColor'></path>
<path d='M 88,240 L 88,272' fill='none' stroke='currentColor'></path>
<path d='M 96,192 L 96,224' fill='none' stroke='currentColor'></path>
<path d='M 104,96 L 104,128' fill='none' stroke='currentColor'></path>
<path d='M 112,48 L 112,80' fill='none' stroke='currentColor'></path>
<path d='M 112,224 L 112,256' fill='none' stroke='currentColor'></path>
<path d='M 136,48 L 136,80' fill='none' stroke='currentColor'></path>
<path d='M 136,224 L 136,256' fill='none' stroke='currentColor'></path>
<path d='M 152,16 L 152,48' fill='none' stroke='currentColor'></path>
<path d='M 152,80 L 152,112' fill='none' stroke='currentColor'></path>
<path d='M 152,144 L 152,176' fill='none' stroke='currentColor'></path>
<path d='M 192,128 L 192,160' fill='none' stroke='currentColor'></path>
<path d='M 216,128 L 216,160' fill='none' stroke='currentColor'></path>
<path d='M 232,96 L 232,128' fill='none' stroke='currentColor'></path>
<path d='M 344,128 L 344,160' fill='none' stroke='currentColor'></path>
<path d='M 368,128 L 368,160' fill='none' stroke='currentColor'></path>
<path d='M 384,96 L 384,128' fill='none' stroke='currentColor'></path>
<path d='M 432,128 L 432,160' fill='none' stroke='currentColor'></path>
<path d='M 448,96 L 448,128' fill='none' stroke='currentColor'></path>
<path d='M 32,128 L 48,96' fill='none' stroke='currentColor'></path>
<path d='M 72,48 L 88,16' fill='none' stroke='currentColor'></path>
<path d='M 32,160 L 48,128' fill='none' stroke='currentColor'></path>
<path d='M 72,80 L 88,48' fill='none' stroke='currentColor'></path>
<path d='M 64,128 L 80,96' fill='none' stroke='currentColor'></path>
<path d='M 112,48 L 128,16' fill='none' stroke='currentColor'></path>
<path d='M 88,128 L 104,96' fill='none' stroke='currentColor'></path>
<path d='M 136,48 L 152,16' fill='none' stroke='currentColor'></path>
<path d='M 88,160 L 104,128' fill='none' stroke='currentColor'></path>
<path d='M 136,80 L 152,48' fill='none' stroke='currentColor'></path>
<path d='M 136,208 L 152,176' fill='none' stroke='currentColor'></path>
<path d='M 192,128 L 208,96' fill='none' stroke='currentColor'></path>
<path d='M 216,128 L 232,96' fill='none' stroke='currentColor'></path>
<path d='M 216,160 L 232,128' fill='none' stroke='currentColor'></path>
<path d='M 344,128 L 360,96' fill='none' stroke='currentColor'></path>
<path d='M 368,128 L 384,96' fill='none' stroke='currentColor'></path>
<path d='M 368,160 L 384,128' fill='none' stroke='currentColor'></path>
<path d='M 432,128 L 448,96' fill='none' stroke='currentColor'></path>
<path d='M 432,160 L 448,128' fill='none' stroke='currentColor'></path>
<path d='M 72,240 L 88,272' fill='none' stroke='currentColor'></path>
<path d='M 72,208 L 88,240' fill='none' stroke='currentColor'></path>
<path d='M 96,224 L 112,256' fill='none' stroke='currentColor'></path>
<path d='M 96,192 L 112,224' fill='none' stroke='currentColor'></path>
<path d='M 120,192 L 136,224' fill='none' stroke='currentColor'></path>
<polygon points='144.000000,128.000000 132.000000,122.400002 132.000000,133.600006' fill='currentColor' transform='rotate(0.000000, 136.000000, 128.000000)'></polygon>
<polygon points='160.000000,112.000000 148.000000,106.400002 148.000000,117.599998' fill='currentColor' transform='rotate(90.000000, 152.000000, 112.000000)'></polygon>
<polygon points='160.000000,144.000000 148.000000,138.399994 148.000000,149.600006' fill='currentColor' transform='rotate(270.000000, 152.000000, 144.000000)'></polygon>
<polygon points='184.000000,128.000000 172.000000,122.400002 172.000000,133.600006' fill='currentColor' transform='rotate(0.000000, 176.000000, 128.000000)'></polygon>
<polygon points='272.000000,128.000000 260.000000,122.400002 260.000000,133.600006' fill='currentColor' transform='rotate(0.000000, 264.000000, 128.000000)'></polygon>
<polygon points='344.000000,128.000000 332.000000,122.400002 332.000000,133.600006' fill='currentColor' transform='rotate(0.000000, 336.000000, 128.000000)'></polygon>
<polygon points='424.000000,128.000000 412.000000,122.400002 412.000000,133.600006' fill='currentColor' transform='rotate(0.000000, 416.000000, 128.000000)'></polygon>
<polygon points='496.000000,128.000000 484.000000,122.400002 484.000000,133.600006' fill='currentColor' transform='rotate(0.000000, 488.000000, 128.000000)'></polygon>
<text text-anchor='middle' x='0' y='116' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='0' y='132' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='0' y='148' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='8' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='8' y='132' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='8' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='16' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='16' y='132' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='16' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='24' y='36' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='24' y='52' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='24' y='68' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='24' y='148' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='24' y='228' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='24' y='244' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='24' y='260' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='32' y='36' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='32' y='52' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='32' y='68' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='32' y='228' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='32' y='244' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='32' y='260' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='40' y='36' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='40' y='52' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='40' y='68' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='40' y='228' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='40' y='244' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='40' y='260' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='48' y='52' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='48' y='68' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='48' y='244' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='48' y='260' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='56' y='180' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='64' y='52' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='64' y='180' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='64' y='244' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='72' y='180' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='80' y='180' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='88' y='180' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='96' y='180' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='104' y='4' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='104' y='180' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='112' y='4' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='112' y='180' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='112' y='276' fill='currentColor' style='font-size:1em'>W</text>
<text text-anchor='middle' x='120' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='120' y='276' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='128' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='128' y='276' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='136' y='276' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='144' y='4' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='144' y='276' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='152' y='4' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='152' y='132' fill='currentColor' style='font-size:1em'>✚</text>
<text text-anchor='middle' x='152' y='276' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='160' y='4' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='168' y='4' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='168' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='168' y='276' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='176' y='4' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='176' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='176' y='36' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='176' y='276' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='184' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='184' y='276' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='192' y='4' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='192' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='192' y='36' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='192' y='180' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='192' y='196' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='192' y='276' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='200' y='20' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='200' y='36' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='200' y='180' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='200' y='196' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='200' y='276' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='208' y='4' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='208' y='20' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='208' y='36' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='208' y='180' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='208' y='196' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='216' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='216' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='216' y='36' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='216' y='180' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='216' y='196' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='224' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='224' y='36' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='224' y='180' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='224' y='196' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='232' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='232' y='36' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='232' y='180' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='232' y='196' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='240' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='240' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='240' y='36' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='240' y='196' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='248' y='4' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='248' y='196' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='256' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='256' y='36' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='264' y='4' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='264' y='20' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='264' y='36' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='264' y='148' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='272' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='272' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='272' y='36' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='272' y='148' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='280' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='280' y='36' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='280' y='116' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='280' y='132' fill='currentColor' style='font-size:1em'>U</text>
<text text-anchor='middle' x='280' y='148' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='288' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='288' y='36' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='288' y='116' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='288' y='132' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='288' y='148' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='296' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='296' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='296' y='148' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='304' y='132' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='304' y='148' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='312' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='312' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='320' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='320' y='148' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='328' y='68' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='336' y='68' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='336' y='84' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='336' y='180' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='344' y='68' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='344' y='84' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='344' y='180' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='352' y='68' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='352' y='84' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='352' y='180' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='360' y='68' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='360' y='84' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='368' y='84' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='368' y='180' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='376' y='68' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='376' y='84' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='376' y='180' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='384' y='68' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='384' y='180' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='392' y='68' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='392' y='180' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='400' y='68' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='424' y='68' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='424' y='180' fill='currentColor' style='font-size:1em'>E</text>
<text text-anchor='middle' x='432' y='68' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='432' y='84' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='432' y='180' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='440' y='68' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='440' y='84' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='440' y='180' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='448' y='68' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='448' y='84' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='448' y='180' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='456' y='68' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='456' y='180' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='464' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='472' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='480' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='488' y='116' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='496' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='504' y='116' fill='currentColor' style='font-size:1em'>e</text>
</g>

    </svg>
  
</div>
<hr>
<h3 id="implicit-camera-pose">Implicit Camera Pose
</h3><ol>
<li>
<p>&ldquo;Arbitrary camera geometries&rdquo; prevent the direct comparision among <strong>all</strong> multi-view feature maps (due to the enormous disparity in observations?).</p>
<p>In contrast, 2-view stereo is free from that problem because <strong>after</strong> pre-rectification,
the <strong>matching cost</strong> of a pair of feature maps is only attributed to the disparity between the pair of images. (?)</p>
<p><del>&ldquo;Arbitrary camera geometries&rdquo; means that the epipolar constraint served as the base of two-view stereo could fail,
e.g. when no overlapping regions exist in the 2 views.
In such a case, however, homography still holds.
<a class="link" href="https://people.scs.carleton.ca/~c_shu/Courses/comp4900d/notes/homography.pdf"  target="_blank" rel="noopener"
    >homography - Carleton University</a></del></p>
<p>Therefore, MVSNet transforms all feature maps into the <strong>reference-view camera space</strong>.</p>
</li>
<li>
<p>Homography warping <strong>injects camera geometries</strong> into the 2D CNN implicitly.</p>
<p>Because the convolution and homography (warping) both are linear operations, they can be <strong>switched</strong>.
Thus, warping the feature map is equivalent to warp the source images followed by convolution.
Consequently, the convolution layer (feature extractor) is trained on an image set that implies the camera geometries.</p>
<img src="MVSNet_homographies.jpg">
<ul>
<li>
<p>(2023-12-19) <strong>Note</strong>: The source image (or feature map) <strong>is not</strong> mapped onto the depth plane.
They&rsquo;re mapped into the reference camera viewpoint to <strong>watch</strong> the scene.</p>
<p>By applying <strong>different homographies</strong> solved with the predefined depth planes, the source image is warped uniquely.
Thus, the features at the <strong>same location</strong> vary.</p>
<img src="MVSNet_multi_views_depths.jpg">
<ul>
<li>
<p>Overall, as depth increases, the source images are go backward.</p>
</li>
<li>
<p>(2024-03-17) The above effect is like that a source image is seen from the reference view.
It&rsquo;s like watching TV from another angle.
This is because when restoring depth values for all pixels,
they are assigned with a common depth value to become 3D points (on a depth plane) <a class="link" href="https://github.com/xy-guo/MVSNet_pytorch/blob/e0f2ae3d7cb2dd13807b775f2075682eaa7f1521/models/module.py#L111-L118"  target="_blank" rel="noopener"
    >Code</a>.
During training, there are 192 assumed depth values to be assigned on pixels,
and then the network is required to predict which depth each pixel is, resulting in a correct pixel-wise depth.</p>
<p>With the correct depth map, applying homography will lead to overlapping for the common area between src and ref images.</p>
</li>
</ul>
<p>This <strong>differentiates</strong> homography from epipolar geometry, where a point is projected onto different views to retrieve feature vectors.</p>
<img src="MVSNet_epipolar.jpg" style="width:350">
<ul>
<li>
<p>(2023-12-20) As ray marches, for epipolar geometry, the projected pixel is moving along the epipolar line.
However, for homography, the source image keeps warping using the increasing depth,
resulting in the <strong>same effect</strong> that the projected location moves along the epipolar line.</p>
</li>
<li>
<p>And the <strong>directions</strong> of data flow are opposite.
Epipolar is from 3D points at different depths to a source image, whereas
homography is from different warped source images to a common 3D point.</p>
</li>
</ul>
</li>
<li>
<p>The reason of performing homography warping on feature map rather than source images could be reducing indexing time with a small resolution?</p>
<ul>
<li>
<p>(2023-12-15) Maybe to avoid performing too many convolutions.
A source image does convolution once and the feature map is warped 192 times.</p>
</li>
<li>
<p>(2023-12-23) Maybe the author got inspired by the CNN-based 2-view stereo matching,
where camera parameters are disregarded when applying CNN onto 2 pre-rectified images.
In contrast, MVSNet incorporates camera poses <strong>implicitly</strong> after CNN.
In other words, &ldquo;rectification&rdquo; is performed on feature maps instead of original images,
so as to encode the camera poses into the 2D CNN.</p>
<p>If warping the source image first, many black empty areas will appear and disrupt the following convolution.
Thus, perform CNN on source images first and then sample feature maps.</p>
<p>Because the cost volume is built in the <strong>reference camera frustum</strong> rather than the world space,
the coordinates transformation applied is homography $𝐊₁\[𝐑₁|𝐭₁\](𝐊ᵢ\[𝐑ᵢ|𝐭ᵢ\])⁻¹$ rather than only unprojection $(𝐊ᵢ\[𝐑ᵢ|𝐭ᵢ\])⁻¹$.
The &ldquo;implicit&rdquo; camera pose embedding manner is proposed to <strong>generalize</strong> the 2-view stereo to multi-view stereo.</p>
<blockquote>
<p>Our 3D cost volume is built upon the camera frustum instead of the regular Euclidean space.</p></blockquote>
</li>
</ul>
</li>
<li>
<p>Convolution fuses the neighboring pixels into one feature vector for dense matching.
A feature vector is a compact representation of a patch of pixels.</p>
<p>In this way, image size <strong>reduced but without losing context</strong> information required by matching.
Hence, the efficiency is higher than matching the original images directly.
The high-dimensional descriptor can lead to correct matching if they&rsquo;re well-optimized.</p>
</li>
<li>
<p>Every source view passes the identical 2D CNN, so the differences between cost volumes indicate
the probabilities of each depth for each pixel.</p>
</li>
<li>
<p>Each &ldquo;depth slot&rdquo; within a cost volume stores a 32-channel feature map, which will be regularized to a 1-channel probability map by 3D UNet and softmax.</p>
</li>
</ul>
</li>
</ol>
<hr>
<h3 id="estimate-by-variance">Estimate by Variance
</h3><p>The matching cost is measured by <strong>element-wise</strong> (pixel-wise, depth-wise, and channel-wise) <strong>variance</strong> of cost volumes,
such that the number of source views is not limited.</p>
<p>A property can be inferred from the <strong>mean of multiple views</strong>, serving as a synthesized representation.
For example, PixelNeRF used the average of projected features from all source views to regress rgbσ per point.
However, MVSNet maps the explicit difference (measured by variance) among the <strong>same-position feature vectors</strong> to a property,
i.e., probability of each hypothetical depth for a pixel.</p>
<ol>
<li>
<p>The feature vectors at the same location on the warped feature maps from <strong>different source images</strong>
don&rsquo;t correspond to the same 3D point,
because a 3D point projected onto <strong>different camera</strong> films gets different pixel coordinates.</p>
<p>Thus, the homologous feature vectors (&ldquo;allele&rdquo;) at the same relative position from the 3 input images are distinct evidently.</p>
<img src="MVSNet_warped_variance.jpg">
<ul>
<li>
<p>Cyan squares are all at the same location [100:150, 165:215].</p>
</li>
<li>
<p>The ground truth depth is around 776:</p>
<img src="MVSNet_GT_depth.jpg">
</li>
</ul>
</li>
<li>
<p>(2023-12-15) The variance for each channel of each matched feature vector from 3 cost volumes, for 192 depths is calculated as:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 488 201"
      >
      <g transform='translate(8,16)'>
<path d='M 24,48 L 56,48' fill='none' stroke='currentColor'></path>
<path d='M 72,48 L 88,48' fill='none' stroke='currentColor'></path>
<path d='M 176,48 L 208,48' fill='none' stroke='currentColor'></path>
<path d='M 224,48 L 240,48' fill='none' stroke='currentColor'></path>
<path d='M 360,48 L 392,48' fill='none' stroke='currentColor'></path>
<path d='M 408,48 L 424,48' fill='none' stroke='currentColor'></path>
<path d='M 8,16 L 8,48' fill='none' stroke='currentColor'></path>
<path d='M 8,48 L 8,80' fill='none' stroke='currentColor'></path>
<path d='M 24,64 L 24,112' fill='none' stroke='currentColor'></path>
<path d='M 40,80 L 40,96' fill='none' stroke='currentColor'></path>
<path d='M 40,96 L 40,144' fill='none' stroke='currentColor'></path>
<path d='M 48,16 L 48,32' fill='none' stroke='currentColor'></path>
<path d='M 48,64 L 48,80' fill='none' stroke='currentColor'></path>
<path d='M 64,64 L 64,112' fill='none' stroke='currentColor'></path>
<path d='M 80,80 L 80,96' fill='none' stroke='currentColor'></path>
<path d='M 80,96 L 80,144' fill='none' stroke='currentColor'></path>
<path d='M 88,16 L 88,32' fill='none' stroke='currentColor'></path>
<path d='M 88,64 L 88,80' fill='none' stroke='currentColor'></path>
<path d='M 104,64 L 104,112' fill='none' stroke='currentColor'></path>
<path d='M 120,80 L 120,96' fill='none' stroke='currentColor'></path>
<path d='M 120,96 L 120,144' fill='none' stroke='currentColor'></path>
<path d='M 160,16 L 160,48' fill='none' stroke='currentColor'></path>
<path d='M 160,48 L 160,80' fill='none' stroke='currentColor'></path>
<path d='M 176,64 L 176,112' fill='none' stroke='currentColor'></path>
<path d='M 192,80 L 192,96' fill='none' stroke='currentColor'></path>
<path d='M 192,96 L 192,144' fill='none' stroke='currentColor'></path>
<path d='M 200,16 L 200,32' fill='none' stroke='currentColor'></path>
<path d='M 200,64 L 200,80' fill='none' stroke='currentColor'></path>
<path d='M 216,64 L 216,112' fill='none' stroke='currentColor'></path>
<path d='M 232,80 L 232,96' fill='none' stroke='currentColor'></path>
<path d='M 232,96 L 232,144' fill='none' stroke='currentColor'></path>
<path d='M 240,16 L 240,32' fill='none' stroke='currentColor'></path>
<path d='M 240,64 L 240,80' fill='none' stroke='currentColor'></path>
<path d='M 256,64 L 256,112' fill='none' stroke='currentColor'></path>
<path d='M 272,80 L 272,96' fill='none' stroke='currentColor'></path>
<path d='M 272,96 L 272,144' fill='none' stroke='currentColor'></path>
<path d='M 344,16 L 344,48' fill='none' stroke='currentColor'></path>
<path d='M 344,48 L 344,80' fill='none' stroke='currentColor'></path>
<path d='M 360,64 L 360,112' fill='none' stroke='currentColor'></path>
<path d='M 376,80 L 376,96' fill='none' stroke='currentColor'></path>
<path d='M 376,96 L 376,144' fill='none' stroke='currentColor'></path>
<path d='M 384,16 L 384,32' fill='none' stroke='currentColor'></path>
<path d='M 384,64 L 384,80' fill='none' stroke='currentColor'></path>
<path d='M 400,64 L 400,112' fill='none' stroke='currentColor'></path>
<path d='M 416,80 L 416,96' fill='none' stroke='currentColor'></path>
<path d='M 416,96 L 416,144' fill='none' stroke='currentColor'></path>
<path d='M 424,16 L 424,32' fill='none' stroke='currentColor'></path>
<path d='M 424,64 L 424,80' fill='none' stroke='currentColor'></path>
<path d='M 440,64 L 440,112' fill='none' stroke='currentColor'></path>
<path d='M 456,80 L 456,96' fill='none' stroke='currentColor'></path>
<path d='M 456,96 L 456,144' fill='none' stroke='currentColor'></path>
<path d='M 8,80 L 24,112' fill='none' stroke='currentColor'></path>
<path d='M 24,112 L 40,144' fill='none' stroke='currentColor'></path>
<path d='M 8,48 L 24,80' fill='none' stroke='currentColor'></path>
<path d='M 24,80 L 40,112' fill='none' stroke='currentColor'></path>
<path d='M 8,16 L 24,48' fill='none' stroke='currentColor'></path>
<path d='M 24,48 L 40,80' fill='none' stroke='currentColor'></path>
<path d='M 48,80 L 64,112' fill='none' stroke='currentColor'></path>
<path d='M 64,112 L 80,144' fill='none' stroke='currentColor'></path>
<path d='M 56,64 L 64,80' fill='none' stroke='currentColor'></path>
<path d='M 64,80 L 80,112' fill='none' stroke='currentColor'></path>
<path d='M 48,16 L 80,80' fill='none' stroke='currentColor'></path>
<path d='M 88,80 L 104,112' fill='none' stroke='currentColor'></path>
<path d='M 104,112 L 120,144' fill='none' stroke='currentColor'></path>
<path d='M 88,48 L 104,80' fill='none' stroke='currentColor'></path>
<path d='M 104,80 L 120,112' fill='none' stroke='currentColor'></path>
<path d='M 88,16 L 120,80' fill='none' stroke='currentColor'></path>
<path d='M 160,80 L 176,112' fill='none' stroke='currentColor'></path>
<path d='M 176,112 L 192,144' fill='none' stroke='currentColor'></path>
<path d='M 160,48 L 176,80' fill='none' stroke='currentColor'></path>
<path d='M 176,80 L 192,112' fill='none' stroke='currentColor'></path>
<path d='M 160,16 L 176,48' fill='none' stroke='currentColor'></path>
<path d='M 176,48 L 192,80' fill='none' stroke='currentColor'></path>
<path d='M 200,80 L 216,112' fill='none' stroke='currentColor'></path>
<path d='M 216,112 L 232,144' fill='none' stroke='currentColor'></path>
<path d='M 208,64 L 216,80' fill='none' stroke='currentColor'></path>
<path d='M 216,80 L 232,112' fill='none' stroke='currentColor'></path>
<path d='M 200,16 L 232,80' fill='none' stroke='currentColor'></path>
<path d='M 240,80 L 256,112' fill='none' stroke='currentColor'></path>
<path d='M 256,112 L 272,144' fill='none' stroke='currentColor'></path>
<path d='M 240,48 L 256,80' fill='none' stroke='currentColor'></path>
<path d='M 256,80 L 272,112' fill='none' stroke='currentColor'></path>
<path d='M 240,16 L 272,80' fill='none' stroke='currentColor'></path>
<path d='M 344,80 L 360,112' fill='none' stroke='currentColor'></path>
<path d='M 360,112 L 376,144' fill='none' stroke='currentColor'></path>
<path d='M 344,48 L 360,80' fill='none' stroke='currentColor'></path>
<path d='M 360,80 L 376,112' fill='none' stroke='currentColor'></path>
<path d='M 344,16 L 360,48' fill='none' stroke='currentColor'></path>
<path d='M 360,48 L 376,80' fill='none' stroke='currentColor'></path>
<path d='M 384,80 L 400,112' fill='none' stroke='currentColor'></path>
<path d='M 400,112 L 416,144' fill='none' stroke='currentColor'></path>
<path d='M 392,64 L 400,80' fill='none' stroke='currentColor'></path>
<path d='M 400,80 L 416,112' fill='none' stroke='currentColor'></path>
<path d='M 384,16 L 416,80' fill='none' stroke='currentColor'></path>
<path d='M 424,80 L 440,112' fill='none' stroke='currentColor'></path>
<path d='M 440,112 L 456,144' fill='none' stroke='currentColor'></path>
<path d='M 424,48 L 440,80' fill='none' stroke='currentColor'></path>
<path d='M 440,80 L 456,112' fill='none' stroke='currentColor'></path>
<path d='M 424,16 L 456,80' fill='none' stroke='currentColor'></path>
<path d='M 48,32 L 48,40' fill='none' stroke='currentColor'></path>
<path d='M 48,56 L 48,64' fill='none' stroke='currentColor'></path>
<path d='M 200,32 L 200,40' fill='none' stroke='currentColor'></path>
<path d='M 200,56 L 200,64' fill='none' stroke='currentColor'></path>
<path d='M 384,32 L 384,40' fill='none' stroke='currentColor'></path>
<path d='M 384,56 L 384,64' fill='none' stroke='currentColor'></path>
<polygon points='32.000000,48.000000 20.000000,42.400002 20.000000,53.599998' fill='currentColor' transform='rotate(180.000000, 24.000000, 48.000000)'></polygon>
<polygon points='96.000000,48.000000 84.000000,42.400002 84.000000,53.599998' fill='currentColor' transform='rotate(0.000000, 88.000000, 48.000000)'></polygon>
<polygon points='184.000000,48.000000 172.000000,42.400002 172.000000,53.599998' fill='currentColor' transform='rotate(180.000000, 176.000000, 48.000000)'></polygon>
<polygon points='248.000000,48.000000 236.000000,42.400002 236.000000,53.599998' fill='currentColor' transform='rotate(0.000000, 240.000000, 48.000000)'></polygon>
<polygon points='368.000000,48.000000 356.000000,42.400002 356.000000,53.599998' fill='currentColor' transform='rotate(180.000000, 360.000000, 48.000000)'></polygon>
<polygon points='432.000000,48.000000 420.000000,42.400002 420.000000,53.599998' fill='currentColor' transform='rotate(0.000000, 424.000000, 48.000000)'></polygon>
<text text-anchor='middle' x='0' y='4' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='0' y='180' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='8' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='8' y='180' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='16' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='16' y='164' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='16' y='180' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='24' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='24' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='24' y='180' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='32' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='32' y='164' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='32' y='180' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='40' y='180' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='48' y='4' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='56' y='4' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='56' y='164' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='56' y='180' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='64' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='64' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='72' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='72' y='180' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='80' y='4' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='80' y='164' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='80' y='180' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='88' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='88' y='180' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='96' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='96' y='180' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='104' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='104' y='164' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='112' y='4' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='112' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='112' y='180' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='120' y='4' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='120' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='120' y='180' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='128' y='164' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='128' y='180' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='136' y='180' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='144' y='180' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='152' y='4' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='152' y='180' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='160' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='160' y='180' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='168' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='176' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='176' y='164' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='184' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='184' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='192' y='164' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='200' y='4' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='208' y='4' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='208' y='164' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='216' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='216' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='224' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='232' y='4' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='232' y='164' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='240' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='248' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='256' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='256' y='164' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='264' y='4' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='264' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='272' y='4' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='272' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='280' y='164' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='288' y='52' fill='currentColor' style='font-size:1em'>⋯</text>
<text text-anchor='middle' x='304' y='52' fill='currentColor' style='font-size:1em'>⋯</text>
<text text-anchor='middle' x='336' y='4' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='344' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='352' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='360' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='360' y='164' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='368' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='368' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='376' y='164' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='384' y='4' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='392' y='4' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='392' y='164' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='400' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='400' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='408' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='416' y='4' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='416' y='164' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='424' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='432' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='440' y='4' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='440' y='164' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='448' y='4' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='448' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='456' y='4' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='456' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='464' y='164' fill='currentColor' style='font-size:1em'>2</text>
</g>

    </svg>
  
</div>
<ul>
<li>
<p>The 192 32-channel <strong>variance vectors</strong> will be fused to 1-D scalars by a 3D CNN.</p>
<ul>
<li>
<p>Conv along the depth dimension, kernel size=2 and stride=1:
aggregate every two variance vector at <strong>adjacent depths</strong>.</p>
</li>
<li>
<p>Output channel is 1: combine the covered vectors by channel-wise weighted summation only <strong>once</strong>.</p>
</li>
</ul>
<p>In a kernel, weighted sum the same channels, and then sum up all channels to produce one of the output channels.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 488 233"
      >
      <g transform='translate(8,16)'>
<path d='M 0,16 L 16,16' fill='none' stroke='currentColor'></path>
<path d='M 16,16 L 32,16' fill='none' stroke='currentColor'></path>
<path d='M 32,16 L 48,16' fill='none' stroke='currentColor'></path>
<path d='M 72,16 L 80,16' fill='none' stroke='currentColor'></path>
<path d='M 80,16 L 96,16' fill='none' stroke='currentColor'></path>
<path d='M 112,16 L 128,16' fill='none' stroke='currentColor'></path>
<path d='M 128,16 L 144,16' fill='none' stroke='currentColor'></path>
<path d='M 144,16 L 160,16' fill='none' stroke='currentColor'></path>
<path d='M 184,16 L 192,16' fill='none' stroke='currentColor'></path>
<path d='M 192,16 L 208,16' fill='none' stroke='currentColor'></path>
<path d='M 264,16 L 280,16' fill='none' stroke='currentColor'></path>
<path d='M 280,16 L 296,16' fill='none' stroke='currentColor'></path>
<path d='M 296,16 L 312,16' fill='none' stroke='currentColor'></path>
<path d='M 336,16 L 344,16' fill='none' stroke='currentColor'></path>
<path d='M 344,16 L 360,16' fill='none' stroke='currentColor'></path>
<path d='M 376,16 L 392,16' fill='none' stroke='currentColor'></path>
<path d='M 392,16 L 408,16' fill='none' stroke='currentColor'></path>
<path d='M 408,16 L 424,16' fill='none' stroke='currentColor'></path>
<path d='M 448,16 L 456,16' fill='none' stroke='currentColor'></path>
<path d='M 456,16 L 472,16' fill='none' stroke='currentColor'></path>
<path d='M 0,32 L 16,32' fill='none' stroke='currentColor'></path>
<path d='M 16,32 L 32,32' fill='none' stroke='currentColor'></path>
<path d='M 32,32 L 48,32' fill='none' stroke='currentColor'></path>
<path d='M 72,32 L 80,32' fill='none' stroke='currentColor'></path>
<path d='M 80,32 L 96,32' fill='none' stroke='currentColor'></path>
<path d='M 112,32 L 128,32' fill='none' stroke='currentColor'></path>
<path d='M 128,32 L 144,32' fill='none' stroke='currentColor'></path>
<path d='M 144,32 L 160,32' fill='none' stroke='currentColor'></path>
<path d='M 184,32 L 192,32' fill='none' stroke='currentColor'></path>
<path d='M 192,32 L 208,32' fill='none' stroke='currentColor'></path>
<path d='M 264,32 L 280,32' fill='none' stroke='currentColor'></path>
<path d='M 280,32 L 296,32' fill='none' stroke='currentColor'></path>
<path d='M 296,32 L 312,32' fill='none' stroke='currentColor'></path>
<path d='M 336,32 L 344,32' fill='none' stroke='currentColor'></path>
<path d='M 344,32 L 360,32' fill='none' stroke='currentColor'></path>
<path d='M 376,32 L 392,32' fill='none' stroke='currentColor'></path>
<path d='M 392,32 L 408,32' fill='none' stroke='currentColor'></path>
<path d='M 408,32 L 424,32' fill='none' stroke='currentColor'></path>
<path d='M 448,32 L 456,32' fill='none' stroke='currentColor'></path>
<path d='M 456,32 L 472,32' fill='none' stroke='currentColor'></path>
<path d='M 88,64 L 120,64' fill='none' stroke='currentColor'></path>
<path d='M 120,64 L 136,64' fill='none' stroke='currentColor'></path>
<path d='M 136,64 L 200,64' fill='none' stroke='currentColor'></path>
<path d='M 352,64 L 384,64' fill='none' stroke='currentColor'></path>
<path d='M 384,64 L 400,64' fill='none' stroke='currentColor'></path>
<path d='M 400,64 L 464,64' fill='none' stroke='currentColor'></path>
<path d='M 24,80 L 80,80' fill='none' stroke='currentColor'></path>
<path d='M 96,80 L 120,80' fill='none' stroke='currentColor'></path>
<path d='M 120,80 L 136,80' fill='none' stroke='currentColor'></path>
<path d='M 288,80 L 344,80' fill='none' stroke='currentColor'></path>
<path d='M 360,80 L 384,80' fill='none' stroke='currentColor'></path>
<path d='M 384,80 L 400,80' fill='none' stroke='currentColor'></path>
<path d='M 8,96 L 16,96' fill='none' stroke='currentColor'></path>
<path d='M 32,96 L 80,96' fill='none' stroke='currentColor'></path>
<path d='M 96,96 L 120,96' fill='none' stroke='currentColor'></path>
<path d='M 272,96 L 280,96' fill='none' stroke='currentColor'></path>
<path d='M 296,96 L 344,96' fill='none' stroke='currentColor'></path>
<path d='M 360,96 L 384,96' fill='none' stroke='currentColor'></path>
<path d='M 40,176 L 56,176' fill='none' stroke='currentColor'></path>
<path d='M 304,176 L 320,176' fill='none' stroke='currentColor'></path>
<path d='M 40,192 L 56,192' fill='none' stroke='currentColor'></path>
<path d='M 304,192 L 320,192' fill='none' stroke='currentColor'></path>
<path d='M 0,16 L 0,32' fill='none' stroke='currentColor'></path>
<path d='M 8,48 L 8,96' fill='none' stroke='currentColor'></path>
<path d='M 8,96 L 8,128' fill='none' stroke='currentColor'></path>
<path d='M 16,16 L 16,32' fill='none' stroke='currentColor'></path>
<path d='M 24,48 L 24,80' fill='none' stroke='currentColor'></path>
<path d='M 24,80 L 24,128' fill='none' stroke='currentColor'></path>
<path d='M 32,16 L 32,32' fill='none' stroke='currentColor'></path>
<path d='M 40,176 L 40,192' fill='none' stroke='currentColor'></path>
<path d='M 48,16 L 48,32' fill='none' stroke='currentColor'></path>
<path d='M 56,176 L 56,192' fill='none' stroke='currentColor'></path>
<path d='M 80,16 L 80,32' fill='none' stroke='currentColor'></path>
<path d='M 88,48 L 88,64' fill='none' stroke='currentColor'></path>
<path d='M 88,64 L 88,128' fill='none' stroke='currentColor'></path>
<path d='M 96,16 L 96,32' fill='none' stroke='currentColor'></path>
<path d='M 112,16 L 112,32' fill='none' stroke='currentColor'></path>
<path d='M 120,48 L 120,64' fill='none' stroke='currentColor'></path>
<path d='M 120,64 L 120,80' fill='none' stroke='currentColor'></path>
<path d='M 120,80 L 120,96' fill='none' stroke='currentColor'></path>
<path d='M 128,16 L 128,32' fill='none' stroke='currentColor'></path>
<path d='M 136,48 L 136,64' fill='none' stroke='currentColor'></path>
<path d='M 136,64 L 136,80' fill='none' stroke='currentColor'></path>
<path d='M 144,16 L 144,32' fill='none' stroke='currentColor'></path>
<path d='M 160,16 L 160,32' fill='none' stroke='currentColor'></path>
<path d='M 192,16 L 192,32' fill='none' stroke='currentColor'></path>
<path d='M 200,48 L 200,64' fill='none' stroke='currentColor'></path>
<path d='M 208,16 L 208,32' fill='none' stroke='currentColor'></path>
<path d='M 264,16 L 264,32' fill='none' stroke='currentColor'></path>
<path d='M 272,48 L 272,96' fill='none' stroke='currentColor'></path>
<path d='M 272,96 L 272,128' fill='none' stroke='currentColor'></path>
<path d='M 280,16 L 280,32' fill='none' stroke='currentColor'></path>
<path d='M 288,48 L 288,80' fill='none' stroke='currentColor'></path>
<path d='M 288,80 L 288,128' fill='none' stroke='currentColor'></path>
<path d='M 296,16 L 296,32' fill='none' stroke='currentColor'></path>
<path d='M 304,176 L 304,192' fill='none' stroke='currentColor'></path>
<path d='M 312,16 L 312,32' fill='none' stroke='currentColor'></path>
<path d='M 320,176 L 320,192' fill='none' stroke='currentColor'></path>
<path d='M 344,16 L 344,32' fill='none' stroke='currentColor'></path>
<path d='M 352,48 L 352,64' fill='none' stroke='currentColor'></path>
<path d='M 352,64 L 352,128' fill='none' stroke='currentColor'></path>
<path d='M 360,16 L 360,32' fill='none' stroke='currentColor'></path>
<path d='M 376,16 L 376,32' fill='none' stroke='currentColor'></path>
<path d='M 384,48 L 384,64' fill='none' stroke='currentColor'></path>
<path d='M 384,64 L 384,80' fill='none' stroke='currentColor'></path>
<path d='M 384,80 L 384,96' fill='none' stroke='currentColor'></path>
<path d='M 392,16 L 392,32' fill='none' stroke='currentColor'></path>
<path d='M 400,48 L 400,64' fill='none' stroke='currentColor'></path>
<path d='M 400,64 L 400,80' fill='none' stroke='currentColor'></path>
<path d='M 408,16 L 408,32' fill='none' stroke='currentColor'></path>
<path d='M 424,16 L 424,32' fill='none' stroke='currentColor'></path>
<path d='M 456,16 L 456,32' fill='none' stroke='currentColor'></path>
<path d='M 464,48 L 464,64' fill='none' stroke='currentColor'></path>
<path d='M 472,16 L 472,32' fill='none' stroke='currentColor'></path>
<path d='M 8,40 L 8,48' fill='none' stroke='currentColor'></path>
<path d='M 24,40 L 24,48' fill='none' stroke='currentColor'></path>
<path d='M 88,40 L 88,48' fill='none' stroke='currentColor'></path>
<path d='M 120,40 L 120,48' fill='none' stroke='currentColor'></path>
<path d='M 136,40 L 136,48' fill='none' stroke='currentColor'></path>
<path d='M 200,40 L 200,48' fill='none' stroke='currentColor'></path>
<path d='M 272,40 L 272,48' fill='none' stroke='currentColor'></path>
<path d='M 288,40 L 288,48' fill='none' stroke='currentColor'></path>
<path d='M 352,40 L 352,48' fill='none' stroke='currentColor'></path>
<path d='M 384,40 L 384,48' fill='none' stroke='currentColor'></path>
<path d='M 400,40 L 400,48' fill='none' stroke='currentColor'></path>
<path d='M 464,40 L 464,48' fill='none' stroke='currentColor'></path>
<polygon points='16.000000,128.000000 4.000000,122.400002 4.000000,133.600006' fill='currentColor' transform='rotate(90.000000, 8.000000, 128.000000)'></polygon>
<polygon points='32.000000,128.000000 20.000000,122.400002 20.000000,133.600006' fill='currentColor' transform='rotate(90.000000, 24.000000, 128.000000)'></polygon>
<polygon points='96.000000,128.000000 84.000000,122.400002 84.000000,133.600006' fill='currentColor' transform='rotate(90.000000, 88.000000, 128.000000)'></polygon>
<polygon points='280.000000,128.000000 268.000000,122.400002 268.000000,133.600006' fill='currentColor' transform='rotate(90.000000, 272.000000, 128.000000)'></polygon>
<polygon points='296.000000,128.000000 284.000000,122.400002 284.000000,133.600006' fill='currentColor' transform='rotate(90.000000, 288.000000, 128.000000)'></polygon>
<polygon points='360.000000,128.000000 348.000000,122.400002 348.000000,133.600006' fill='currentColor' transform='rotate(90.000000, 352.000000, 128.000000)'></polygon>
<text text-anchor='middle' x='0' y='180' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='0' y='196' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='8' y='148' fill='currentColor' style='font-size:1em'>□</text>
<text text-anchor='middle' x='8' y='180' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='16' y='4' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='16' y='180' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='16' y='196' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='24' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='24' y='148' fill='currentColor' style='font-size:1em'>□</text>
<text text-anchor='middle' x='24' y='180' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='24' y='196' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='32' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='40' y='212' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='48' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='48' y='164' fill='currentColor' style='font-size:1em'>↓</text>
<text text-anchor='middle' x='48' y='212' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='56' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='56' y='148' fill='currentColor' style='font-size:1em'>⋯</text>
<text text-anchor='middle' x='56' y='212' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='64' y='36' fill='currentColor' style='font-size:1em'>⋯</text>
<text text-anchor='middle' x='64' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='64' y='212' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='72' y='4' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='72' y='164' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='80' y='4' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='80' y='164' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='88' y='148' fill='currentColor' style='font-size:1em'>□</text>
<text text-anchor='middle' x='128' y='4' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='136' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='144' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='160' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='160' y='196' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='168' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='168' y='196' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='176' y='36' fill='currentColor' style='font-size:1em'>⋯</text>
<text text-anchor='middle' x='176' y='196' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='176' y='212' fill='currentColor' style='font-size:1em'>⋯</text>
<text text-anchor='middle' x='184' y='4' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='184' y='196' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='192' y='4' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='192' y='196' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='200' y='196' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='208' y='196' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='216' y='196' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='232' y='4' fill='currentColor' style='font-size:1em'>⋯</text>
<text text-anchor='middle' x='264' y='180' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='264' y='196' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='272' y='4' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='272' y='148' fill='currentColor' style='font-size:1em'>□</text>
<text text-anchor='middle' x='272' y='180' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='280' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='280' y='180' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='280' y='196' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='288' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='288' y='148' fill='currentColor' style='font-size:1em'>□</text>
<text text-anchor='middle' x='288' y='180' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='288' y='196' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='304' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='304' y='212' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='312' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='312' y='164' fill='currentColor' style='font-size:1em'>↓</text>
<text text-anchor='middle' x='312' y='212' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='320' y='148' fill='currentColor' style='font-size:1em'>⋯</text>
<text text-anchor='middle' x='320' y='212' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='328' y='4' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='328' y='36' fill='currentColor' style='font-size:1em'>⋯</text>
<text text-anchor='middle' x='328' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='328' y='212' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='336' y='4' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='336' y='164' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='336' y='212' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='344' y='4' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='344' y='164' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='344' y='212' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='352' y='4' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='352' y='148' fill='currentColor' style='font-size:1em'>□</text>
<text text-anchor='middle' x='384' y='4' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='392' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='400' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='416' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='424' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='440' y='4' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='440' y='36' fill='currentColor' style='font-size:1em'>⋯</text>
<text text-anchor='middle' x='448' y='4' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='456' y='4' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='464' y='4' fill='currentColor' style='font-size:1em'>2</text>
</g>

    </svg>
  
</div>
</li>
<li>
<p>192 variance scalars will be normalized by softmax to 192 probabilities for each depth value.</p>
</li>
<li>
<p>Depth map is a summation of 192 preset depths weighted by probabilities.</p>
</li>
</ul>
</li>
<li>
<p>The variance of the &ldquo;position-matched&rdquo; feature vectors from a pair of source feature maps at each depth is interpreted as
each depth&rsquo;s probability for a pixel:</p>
<ol>
<li>
<p>A source image is warped using a homography, solved with a certain depth $dₙ$,
to <strong>supplement</strong> the reference view with information
from a lateral perspective, although the scale doesn&rsquo;t match:</p>
<img src="MVSNet_homography_warped_img.jpg">
<p>If the scale <strong>matches</strong>, the pixels on the ref and source views projected from a common 3D point will overlapped,
and the depth of that 3D point is found. (Refer to the test result in another <a class="link" href="http://blog.zichen.uk/post/writenotes/model/depth/b-test-mvs_ply/#aligned" >post</a>.)</p>
</li>
<li>
<p>The feature map of the source image is sampled into a warped feature map.</p>
</li>
<li>
<p>Feature vectors at the same location <del>are matched?</del> do not match a common 3D point.</p>
</li>
<li>
<p>The variance of the feature vectors pertaining to a depth is calculated</p>
<p>High variance means the patches that a point projected onto each view are distinct,
leading to different feature vectors.</p>
</li>
<li>
<p>3D CNN aggregates <strong>adjacent</strong> variance vectors along 3 directions into a scalar variance.</p>
<p>3D CNN is a <strong>smooth</strong> constraint to filter the noise in the cost volume caused by non-Lambertian surfaces and object occlusions.</p>
</li>
<li>
<p>Normalize 192 variance by Softmax to obtain the probability distribution of depths.</p>
</li>
<li>
<p>Why does the correct depth has the highest variance?</p>
</li>
</ol>
</li>
</ol>
<h3 id="why-use-variance">Why use variance?
</h3><p>high variance means high probability.</p>
<p>为什么高方差意味着高概率呢？？？</p>
<ul>
<li>把一组照片的 homography 效果做出来看看</li>
<li>Read: <a class="link" href="https://arxiv.org/abs/2201.01501"  target="_blank" rel="noopener"
    >Rethink depth esti</a> and <a class="link" href="" >IS-MVSNet</a></li>
<li>Google search: &ldquo;why does MVSNet use the variance to regress the probability of depths?&rdquo;</li>
</ul>
<p><del>Because the exact depth for a pixel results in other views&rsquo; &ldquo;deny&rdquo; since the matching pixel on other source images doesn&rsquo;t correspond to that depth due to the viewpoint shifts.</del></p>
<p><del>changing viewpoint will change distance from the observing point to the camera as well.
a feature vector represents a patch of pixels, the area with high rgb-variance means geometry changes.</del></p>
<p>(2023-12-16) Each variance vector is attributed to 3 feature vectors:</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th><img src="MVSNet_Variance_cost_volumes.jpg"></th>
          <th><img src="MVSNet_feature_variance.jpg"></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>epipolar</td>
          <td>homography</td>
      </tr>
  </tbody>
</table></div>
<ul>
<li>
<p>The epipolar reminds me the view fusion in GNT, where multi-view features are fused by &quot; <strong>subtraction</strong> attention&quot;.</p>
</li>
<li>
<p>(2023-12-20) However, MVSNet is not epipolar. The feature 3 vectors are at the <strong>same location</strong> with the underlying feature maps <strong>changing</strong>.</p>
<p>But essentially, homography is epipolar in terms of <strong>variance vectors</strong> ( <strong>not</strong> actual 3D points).
The feature vectors on the epipolar line are <strong>shifted to the location</strong> of the reference feature.</p>
<p>Succinctly, in epipolar, the projection changes (moves), while in homography, the feature map changes (warps).</p>
<p>I probably thought of (on 2023-12-16) that after warping, the feature vectors at the same location correspond to a same 3D point, like eipolar.
But that&rsquo;s not right even for the warping with the accurate depth value (776 mm) as shown in the above demo.
The image (or feature map) moved indeed after warping, but not got the exact position corresponding to the common 3D point.</p>
</li>
</ul>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 432 265"
      >
      <g transform='translate(8,16)'>
<path d='M 80,0 L 248,0' fill='none' stroke='currentColor'></path>
<path d='M 80,48 L 112,48' fill='none' stroke='currentColor'></path>
<path d='M 128,48 L 152,48' fill='none' stroke='currentColor'></path>
<path d='M 168,48 L 224,48' fill='none' stroke='currentColor'></path>
<path d='M 240,48 L 248,48' fill='none' stroke='currentColor'></path>
<path d='M 56,112 L 72,112' fill='none' stroke='currentColor'></path>
<path d='M 72,112 L 88,112' fill='none' stroke='currentColor'></path>
<path d='M 88,112 L 104,112' fill='none' stroke='currentColor'></path>
<path d='M 128,112 L 144,112' fill='none' stroke='currentColor'></path>
<path d='M 144,112 L 160,112' fill='none' stroke='currentColor'></path>
<path d='M 160,112 L 176,112' fill='none' stroke='currentColor'></path>
<path d='M 264,112 L 280,112' fill='none' stroke='currentColor'></path>
<path d='M 280,112 L 296,112' fill='none' stroke='currentColor'></path>
<path d='M 296,112 L 312,112' fill='none' stroke='currentColor'></path>
<path d='M 24,128 L 40,128' fill='none' stroke='currentColor'></path>
<path d='M 56,128 L 72,128' fill='none' stroke='currentColor'></path>
<path d='M 72,128 L 88,128' fill='none' stroke='currentColor'></path>
<path d='M 88,128 L 104,128' fill='none' stroke='currentColor'></path>
<path d='M 128,128 L 144,128' fill='none' stroke='currentColor'></path>
<path d='M 144,128 L 160,128' fill='none' stroke='currentColor'></path>
<path d='M 160,128 L 176,128' fill='none' stroke='currentColor'></path>
<path d='M 264,128 L 280,128' fill='none' stroke='currentColor'></path>
<path d='M 280,128 L 296,128' fill='none' stroke='currentColor'></path>
<path d='M 296,128 L 312,128' fill='none' stroke='currentColor'></path>
<path d='M 80,192 L 240,192' fill='none' stroke='currentColor'></path>
<path d='M 80,240 L 240,240' fill='none' stroke='currentColor'></path>
<path d='M 56,112 L 56,128' fill='none' stroke='currentColor'></path>
<path d='M 72,112 L 72,128' fill='none' stroke='currentColor'></path>
<path d='M 80,0 L 80,48' fill='none' stroke='currentColor'></path>
<path d='M 80,192 L 80,240' fill='none' stroke='currentColor'></path>
<path d='M 88,112 L 88,128' fill='none' stroke='currentColor'></path>
<path d='M 104,112 L 104,128' fill='none' stroke='currentColor'></path>
<path d='M 128,112 L 128,128' fill='none' stroke='currentColor'></path>
<path d='M 144,112 L 144,128' fill='none' stroke='currentColor'></path>
<path d='M 152,160 L 152,176' fill='none' stroke='currentColor'></path>
<path d='M 152,200 L 152,216' fill='none' stroke='currentColor'></path>
<path d='M 160,32 L 160,80' fill='none' stroke='currentColor'></path>
<path d='M 160,112 L 160,128' fill='none' stroke='currentColor'></path>
<path d='M 176,112 L 176,128' fill='none' stroke='currentColor'></path>
<path d='M 240,192 L 240,240' fill='none' stroke='currentColor'></path>
<path d='M 248,0 L 248,48' fill='none' stroke='currentColor'></path>
<path d='M 264,112 L 264,128' fill='none' stroke='currentColor'></path>
<path d='M 280,112 L 280,128' fill='none' stroke='currentColor'></path>
<path d='M 296,112 L 296,128' fill='none' stroke='currentColor'></path>
<path d='M 312,112 L 312,128' fill='none' stroke='currentColor'></path>
<path d='M 104,80 L 128,32' fill='none' stroke='currentColor'></path>
<path d='M 212,216 L 220,200' fill='none' stroke='currentColor'></path>
<path d='M 232,176 L 248,144' fill='none' stroke='currentColor'></path>
<path d='M 96,160 L 104,176' fill='none' stroke='currentColor'></path>
<path d='M 116,200 L 124,216' fill='none' stroke='currentColor'></path>
<path d='M 224,32 L 248,80' fill='none' stroke='currentColor'></path>
<path d='M 152,176 L 152,184' fill='none' stroke='currentColor'></path>
<path d='M 152,200 L 152,208' fill='none' stroke='currentColor'></path>
<polygon points='48.000000,128.000000 36.000000,122.400002 36.000000,133.600006' fill='currentColor' transform='rotate(0.000000, 40.000000, 128.000000)'></polygon>
<polygon points='108.000000,160.000000 96.000000,154.399994 96.000000,165.600006' fill='currentColor' transform='rotate(240.000000, 96.000000, 160.000000)'></polygon>
<polygon points='116.000000,80.000000 104.000000,74.400002 104.000000,85.599998' fill='currentColor' transform='rotate(120.000000, 104.000000, 80.000000)'></polygon>
<polygon points='160.000000,160.000000 148.000000,154.399994 148.000000,165.600006' fill='currentColor' transform='rotate(270.000000, 152.000000, 160.000000)'></polygon>
<polygon points='168.000000,80.000000 156.000000,74.400002 156.000000,85.599998' fill='currentColor' transform='rotate(90.000000, 160.000000, 80.000000)'></polygon>
<polygon points='260.000000,80.000000 248.000000,74.400002 248.000000,85.599998' fill='currentColor' transform='rotate(60.000000, 248.000000, 80.000000)'></polygon>
<polygon points='260.000000,144.000000 248.000000,138.399994 248.000000,149.600006' fill='currentColor' transform='rotate(300.000000, 248.000000, 144.000000)'></polygon>
<text text-anchor='middle' x='0' y='148' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='0' y='164' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='8' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='8' y='36' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='8' y='132' fill='currentColor' style='font-size:1em'>□</text>
<text text-anchor='middle' x='8' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='8' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='8' y='212' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='8' y='228' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='16' y='20' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='16' y='36' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='16' y='148' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='16' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='16' y='212' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='16' y='228' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='24' y='20' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='24' y='36' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='24' y='164' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='24' y='212' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='24' y='228' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='32' y='36' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='32' y='52' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='32' y='212' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='32' y='228' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='32' y='244' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='40' y='212' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='48' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='48' y='36' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='48' y='212' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='48' y='228' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='56' y='36' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='56' y='148' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='56' y='228' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='64' y='36' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='64' y='148' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='64' y='228' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='80' y='100' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='80' y='148' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='88' y='100' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='88' y='148' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='96' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='104' y='148' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='112' y='148' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='128' y='148' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='128' y='228' fill='currentColor' style='font-size:1em'>□</text>
<text text-anchor='middle' x='136' y='20' fill='currentColor' style='font-size:1em'>□</text>
<text text-anchor='middle' x='136' y='148' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='144' y='100' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='152' y='100' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='152' y='148' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='152' y='228' fill='currentColor' style='font-size:1em'>□</text>
<text text-anchor='middle' x='160' y='20' fill='currentColor' style='font-size:1em'>□</text>
<text text-anchor='middle' x='160' y='148' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='168' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='176' y='148' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='184' y='148' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='200' y='228' fill='currentColor' style='font-size:1em'>□</text>
<text text-anchor='middle' x='216' y='20' fill='currentColor' style='font-size:1em'>□</text>
<text text-anchor='middle' x='272' y='100' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='272' y='148' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='280' y='100' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='280' y='148' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='288' y='100' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='296' y='100' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='296' y='148' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='304' y='148' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='312' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='320' y='148' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='328' y='148' fill='currentColor' style='font-size:1em'>s</text>
</g>

    </svg>
  
</div>
<ul>
<li>However, if the epipoles are at infinite (no overlapping observation),
the variance matching is poor (under-determined system has inifinitely many solutions normally),
and a reference pixel is falsely matched resulting in false probabilities distribution:
Multiple depth values are plausible and gain similar probabilities.</li>
</ul>
<p>The correct warping correspond to the correct depth, and vice versa.</p>
<ul>
<li>
<p>(2023-12-20) 3D CNN is a classifier to find the most possible depth value among 192 hypotheses based on the input variance,
which is produced from a 2D CNN.</p>
<p>Therefore, the job of the 2D CNN is to make the features cooresponding to the correct depth having the biggest variance.
Such that the aggregated variance will still be the most salient after softmax.
And finally, it takes the highest weight.</p>
</li>
<li>
<p>(2023-12-20) If the above analysis that the homography is equivalent to epipolar geometry for building variance vectors is true,
then the reference pixel should find the matched pixel on the epipolar line projected from the correct depth.</p>
<p>The source feature map is warped differently according to various depth values.
The feature vectors at a common location of all the input images differs.
Their variance is the matching cost for a hypothetical depth.
Since a feature vector indicates the context around a pixel,
the high variance means the behind pixels are not similar.
So they should not be matched.
But they use softmax to identify the highest variance.</p>
<p>doubt: I still believe the variance should be minimized at the correct depth.
<a class="link" href="https://www.zhihu.com/question/297481800"  target="_blank" rel="noopener"
    >计算机视觉中cost-volume的概念具体指什么？ - 知乎</a></p>
<p>(2024-02-19) The PointMVSNet paper said MVSNet used &ldquo;soft argmin&rdquo; in sec3.1.</p>
</li>
</ul>
<hr>
<h3 id="cost-volume">Cost Volume
</h3><p>A cost volume 𝐕ᵢ corresponding to a source view&rsquo;s feature map 𝐅ᵢ constitutes <strong>multiple warped</strong> feature maps 𝐕ᵢ(d), which can be
obtained by specifying a depth and a [𝐑|𝐭] that transforms the reference camera to the source view camera.</p>
<p>As shown below, a cost volume for a source feature map contains 192 <strong>warped feature maps</strong> at corresponding depths,
while the cost volume for the reference feature map is a <strong>replication of itself</strong> 192 times.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 400 489"
      >
      <g transform='translate(8,16)'>
<path d='M 72,80 L 104,80' fill='none' stroke='currentColor'></path>
<path d='M 104,80 L 136,80' fill='none' stroke='currentColor'></path>
<path d='M 136,80 L 168,80' fill='none' stroke='currentColor'></path>
<path d='M 168,336 L 192,336' fill='none' stroke='currentColor'></path>
<path d='M 312,352 L 352,352' fill='none' stroke='currentColor'></path>
<path d='M 40,32 L 40,80' fill='none' stroke='currentColor'></path>
<path d='M 56,64 L 56,112' fill='none' stroke='currentColor'></path>
<path d='M 88,240 L 88,288' fill='none' stroke='currentColor'></path>
<path d='M 88,384 L 88,432' fill='none' stroke='currentColor'></path>
<path d='M 96,144 L 96,160' fill='none' stroke='currentColor'></path>
<path d='M 96,208 L 96,224' fill='none' stroke='currentColor'></path>
<path d='M 104,80 L 104,160' fill='none' stroke='currentColor'></path>
<path d='M 104,272 L 104,320' fill='none' stroke='currentColor'></path>
<path d='M 104,416 L 104,464' fill='none' stroke='currentColor'></path>
<path d='M 120,240 L 120,288' fill='none' stroke='currentColor'></path>
<path d='M 120,384 L 120,432' fill='none' stroke='currentColor'></path>
<path d='M 128,144 L 128,160' fill='none' stroke='currentColor'></path>
<path d='M 128,208 L 128,224' fill='none' stroke='currentColor'></path>
<path d='M 136,80 L 136,160' fill='none' stroke='currentColor'></path>
<path d='M 136,272 L 136,320' fill='none' stroke='currentColor'></path>
<path d='M 136,416 L 136,464' fill='none' stroke='currentColor'></path>
<path d='M 152,240 L 152,288' fill='none' stroke='currentColor'></path>
<path d='M 152,384 L 152,432' fill='none' stroke='currentColor'></path>
<path d='M 160,144 L 160,160' fill='none' stroke='currentColor'></path>
<path d='M 160,208 L 160,224' fill='none' stroke='currentColor'></path>
<path d='M 168,80 L 168,160' fill='none' stroke='currentColor'></path>
<path d='M 168,272 L 168,320' fill='none' stroke='currentColor'></path>
<path d='M 168,416 L 168,464' fill='none' stroke='currentColor'></path>
<path d='M 88,432 L 104,464' fill='none' stroke='currentColor'></path>
<path d='M 88,384 L 104,416' fill='none' stroke='currentColor'></path>
<path d='M 120,432 L 136,464' fill='none' stroke='currentColor'></path>
<path d='M 120,384 L 136,416' fill='none' stroke='currentColor'></path>
<path d='M 152,432 L 168,464' fill='none' stroke='currentColor'></path>
<path d='M 88,288 L 104,320' fill='none' stroke='currentColor'></path>
<path d='M 152,384 L 168,416' fill='none' stroke='currentColor'></path>
<path d='M 88,240 L 104,272' fill='none' stroke='currentColor'></path>
<path d='M 120,288 L 136,320' fill='none' stroke='currentColor'></path>
<path d='M 40,80 L 56,112' fill='none' stroke='currentColor'></path>
<path d='M 120,240 L 136,272' fill='none' stroke='currentColor'></path>
<path d='M 152,288 L 168,320' fill='none' stroke='currentColor'></path>
<path d='M 40,32 L 56,64' fill='none' stroke='currentColor'></path>
<path d='M 152,240 L 168,272' fill='none' stroke='currentColor'></path>
<polygon points='104.000000,160.000000 92.000000,154.399994 92.000000,165.600006' fill='currentColor' transform='rotate(90.000000, 96.000000, 160.000000)'></polygon>
<polygon points='104.000000,224.000000 92.000000,218.399994 92.000000,229.600006' fill='currentColor' transform='rotate(90.000000, 96.000000, 224.000000)'></polygon>
<polygon points='112.000000,160.000000 100.000000,154.399994 100.000000,165.600006' fill='currentColor' transform='rotate(90.000000, 104.000000, 160.000000)'></polygon>
<polygon points='136.000000,160.000000 124.000000,154.399994 124.000000,165.600006' fill='currentColor' transform='rotate(90.000000, 128.000000, 160.000000)'></polygon>
<polygon points='136.000000,224.000000 124.000000,218.399994 124.000000,229.600006' fill='currentColor' transform='rotate(90.000000, 128.000000, 224.000000)'></polygon>
<polygon points='144.000000,160.000000 132.000000,154.399994 132.000000,165.600006' fill='currentColor' transform='rotate(90.000000, 136.000000, 160.000000)'></polygon>
<polygon points='168.000000,160.000000 156.000000,154.399994 156.000000,165.600006' fill='currentColor' transform='rotate(90.000000, 160.000000, 160.000000)'></polygon>
<polygon points='168.000000,224.000000 156.000000,218.399994 156.000000,229.600006' fill='currentColor' transform='rotate(90.000000, 160.000000, 224.000000)'></polygon>
<polygon points='176.000000,160.000000 164.000000,154.399994 164.000000,165.600006' fill='currentColor' transform='rotate(90.000000, 168.000000, 160.000000)'></polygon>
<polygon points='200.000000,336.000000 188.000000,330.399994 188.000000,341.600006' fill='currentColor' transform='rotate(0.000000, 192.000000, 336.000000)'></polygon>
<polygon points='320.000000,352.000000 308.000000,346.399994 308.000000,357.600006' fill='currentColor' transform='rotate(180.000000, 312.000000, 352.000000)'></polygon>
<text text-anchor='middle' x='0' y='4' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='0' y='20' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='0' y='196' fill='currentColor' style='font-size:1em'>M</text>
<text text-anchor='middle' x='0' y='276' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='0' y='292' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='0' y='308' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='0' y='340' fill='currentColor' style='font-size:1em'>z</text>
<text text-anchor='middle' x='0' y='356' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='0' y='420' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='0' y='436' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='0' y='452' fill='currentColor' style='font-size:1em'>𝐅</text>
<text text-anchor='middle' x='8' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='8' y='20' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='8' y='196' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='8' y='276' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='8' y='292' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='8' y='308' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='8' y='356' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='8' y='420' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='8' y='436' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='8' y='452' fill='currentColor' style='font-size:1em'>₁</text>
<text text-anchor='middle' x='16' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='16' y='196' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='16' y='276' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='16' y='292' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='16' y='308' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='16' y='340' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='16' y='356' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='16' y='420' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='16' y='436' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='24' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='24' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='24' y='196' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='24' y='276' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='24' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='24' y='308' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='24' y='340' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='24' y='356' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='24' y='436' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='24' y='452' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='32' y='196' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='32' y='276' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='32' y='292' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='32' y='340' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='32' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='32' y='420' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='32' y='452' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='40' y='4' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='40' y='132' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='40' y='196' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='40' y='276' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='40' y='292' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='40' y='308' fill='currentColor' style='font-size:1em'>𝐕</text>
<text text-anchor='middle' x='40' y='340' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='40' y='356' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='40' y='420' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='40' y='436' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='40' y='452' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='48' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='48' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='48' y='276' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='48' y='308' fill='currentColor' style='font-size:1em'>ᵢ</text>
<text text-anchor='middle' x='48' y='420' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='48' y='436' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='48' y='452' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='56' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='56' y='20' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='56' y='132' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='56' y='196' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='56' y='308' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='56' y='340' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='56' y='356' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='56' y='420' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='56' y='436' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='56' y='452' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='64' y='132' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='64' y='196' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='64' y='308' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='64' y='340' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='64' y='356' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='64' y='420' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='64' y='452' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='72' y='4' fill='currentColor' style='font-size:1em'>𝐅</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='72' y='68' fill='currentColor' style='font-size:1em'>𝐊</text>
<text text-anchor='middle' x='72' y='132' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='72' y='196' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='72' y='308' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='72' y='356' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='72' y='452' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='80' y='4' fill='currentColor' style='font-size:1em'>₁</text>
<text text-anchor='middle' x='80' y='20' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='80' y='68' fill='currentColor' style='font-size:1em'>ᵢ</text>
<text text-anchor='middle' x='80' y='132' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='80' y='196' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='80' y='340' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='80' y='356' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='80' y='452' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='88' y='68' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='88' y='340' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='88' y='356' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='96' y='68' fill='currentColor' style='font-size:1em'>𝐑</text>
<text text-anchor='middle' x='96' y='132' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='96' y='196' fill='currentColor' style='font-size:1em'>▦</text>
<text text-anchor='middle' x='96' y='340' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='96' y='356' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='104' y='68' fill='currentColor' style='font-size:1em'>ᵢ</text>
<text text-anchor='middle' x='112' y='68' fill='currentColor' style='font-size:1em'>|</text>
<text text-anchor='middle' x='112' y='340' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='112' y='356' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='120' y='68' fill='currentColor' style='font-size:1em'>𝐭</text>
<text text-anchor='middle' x='120' y='340' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='120' y='356' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='128' y='68' fill='currentColor' style='font-size:1em'>ᵢ</text>
<text text-anchor='middle' x='128' y='132' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='128' y='196' fill='currentColor' style='font-size:1em'>▦</text>
<text text-anchor='middle' x='128' y='340' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='136' y='68' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='136' y='340' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='136' y='356' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='144' y='68' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='144' y='340' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='144' y='356' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='152' y='68' fill='currentColor' style='font-size:1em'>𝐊</text>
<text text-anchor='middle' x='152' y='340' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='152' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='160' y='68' fill='currentColor' style='font-size:1em'>₁</text>
<text text-anchor='middle' x='160' y='132' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='160' y='196' fill='currentColor' style='font-size:1em'>▦</text>
<text text-anchor='middle' x='160' y='356' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='168' y='68' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='168' y='356' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='176' y='68' fill='currentColor' style='font-size:1em'>𝐑</text>
<text text-anchor='middle' x='176' y='356' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='184' y='68' fill='currentColor' style='font-size:1em'>₁</text>
<text text-anchor='middle' x='184' y='132' fill='currentColor' style='font-size:1em'>⋯</text>
<text text-anchor='middle' x='192' y='68' fill='currentColor' style='font-size:1em'>|</text>
<text text-anchor='middle' x='192' y='292' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='192' y='356' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='192' y='436' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='200' y='68' fill='currentColor' style='font-size:1em'>𝐭</text>
<text text-anchor='middle' x='200' y='132' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='200' y='308' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='200' y='356' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='200' y='452' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='208' y='68' fill='currentColor' style='font-size:1em'>₁</text>
<text text-anchor='middle' x='208' y='132' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='208' y='292' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='208' y='308' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='208' y='356' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='208' y='436' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='208' y='452' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='216' y='68' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='216' y='132' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='216' y='292' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='216' y='308' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='216' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='216' y='436' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='216' y='452' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='224' y='68' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='224' y='292' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='224' y='308' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='224' y='356' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='224' y='436' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='224' y='452' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='232' y='68' fill='currentColor' style='font-size:1em'>⁻</text>
<text text-anchor='middle' x='232' y='292' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='232' y='308' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='232' y='356' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='232' y='436' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='232' y='452' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='240' y='68' fill='currentColor' style='font-size:1em'>¹</text>
<text text-anchor='middle' x='240' y='308' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='240' y='356' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='240' y='452' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='248' y='292' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='248' y='436' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='256' y='292' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='256' y='308' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='256' y='356' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='256' y='436' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='256' y='452' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='264' y='292' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='264' y='308' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='264' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='264' y='436' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='264' y='452' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='272' y='292' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='272' y='308' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='272' y='356' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='272' y='436' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='272' y='452' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='280' y='292' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='280' y='308' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='280' y='356' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='280' y='436' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='280' y='452' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='288' y='292' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='288' y='308' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='288' y='356' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='288' y='436' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='288' y='452' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='296' y='308' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='296' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='296' y='452' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='304' y='292' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='304' y='308' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='304' y='436' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='304' y='452' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='312' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='312' y='308' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='312' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='312' y='452' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='320' y='308' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='320' y='452' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='328' y='292' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='328' y='308' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='328' y='436' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='328' y='452' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='336' y='292' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='336' y='308' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='336' y='436' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='336' y='452' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='344' y='292' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='344' y='308' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='344' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='344' y='452' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='352' y='292' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='360' y='308' fill='currentColor' style='font-size:1em'>H</text>
<text text-anchor='middle' x='360' y='436' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='360' y='452' fill='currentColor' style='font-size:1em'>H</text>
<text text-anchor='middle' x='368' y='292' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='368' y='308' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='368' y='436' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='368' y='452' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='376' y='308' fill='currentColor' style='font-size:1em'>W</text>
<text text-anchor='middle' x='376' y='436' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='376' y='452' fill='currentColor' style='font-size:1em'>W</text>
<text text-anchor='middle' x='384' y='308' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='384' y='436' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='384' y='452' fill='currentColor' style='font-size:1em'>)</text>
</g>

    </svg>
  
</div>
<ul>
<li>
<p>A feature map has 32 channels, so a cost volume is a 4-D tensor: (C=32, D=192, H=128, W=160).</p>
</li>
<li>
<p>(2023-12-12) Homography isn&rsquo;t used to map the pixel of reference-view feature map to source-view feature map, but instead
<strong>warp the source feat to reference feat</strong> via sampling cooresponding matching points.</p>
</li>
</ul>
<hr>
<p>(2024-04-28)</p>
<ul>
<li>
<p>When searching &ldquo;深度&rdquo; in the QQ group, I found the comment of AURORA on mvsnet on 23/10/08:
“（MVSNet只在 DTU 数据集上训的，为啥在其他数据集上也有效果）因为 costvolume 相当于训练了一个 feature extractor”</p>
<p>I think the inputs are already feature maps. The network gotten trained is the 3D UNet,
that maps variance volume to probability volume.</p>
<p>Even if the 3D UNet is really a &ldquo;feature extractor&rdquo;, the feature is extracted from the variance volume.</p>
</li>
</ul>
<hr>
<h3 id="code-understand">Code Understand
</h3><p>A complete demo of homography warping: <a class="link" href="https://gist.github.com/zichen34/61d4d3c3f5efa3777b0a8848cd8f876e"  target="_blank" rel="noopener"
    >gist</a></p>
<p>According to the principle of homography, pixels on the reference view&rsquo;s feature map are <strong>mapped linearly</strong> onto each source view.
Thus, a warped source feature map is <strong>sampled</strong> (<code>F.grid_sample</code>) from the original source feature map at the <strong>mapped pixels</strong>.</p>
<ol>
<li>
<p>Construct <strong>coordinates of pixels</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">160</span>
</span></span><span class="line"><span class="cl"><span class="n">vu</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cartesian_prod</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">uv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">vu</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># (hw,2), As x varies, y is fixed</span>
</span></span><span class="line"><span class="cl"><span class="n">uv1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">uv</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uv</span><span class="p">),</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># (hw,3)</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Map coordinates on the reference image to a source image.</p>
<p>The mapping matrix is 𝐊ᵢ</p>
\[𝐑ᵢ|𝐭ᵢ\]<p> (𝐊₁[𝐑₁|𝐭₁])⁻¹.
Therefore, each view calculates its own <code>proj</code> 𝐊ᵢ</p>
\[𝐑ᵢ|𝐭ᵢ\]<p> in advance.</p>
<p>Use $[\\^𝐑|\\^𝐭]$ to represent the mapping for a pixel from the reference image to a source image, so that
the <strong>pixel-wise</strong> (u,v,1) and <strong>depth-wise</strong> (d) matmul is:</p>
$$
   \begin{bmatrix} u' d' \\\ v' d' \\\ d' \\\ 1  \end{bmatrix}=
   \begin{bmatrix} \\^𝐑 &| \\^𝐭 \\\ 0 &| 1 \end{bmatrix}
   \begin{bmatrix} ud \\\ vd \\\ d \\\ 1 \end{bmatrix} =
   \\^𝐑\_{3×3} \begin{bmatrix} u \\\ v \\\ 1 \end{bmatrix}⋅d +
   \begin{bmatrix} t₁ \\\ t₂ \\\ t₃ \\\ 1  \end{bmatrix}
   $$<ul>
<li>
<p>where [ud, vd, d,1]ᵀ is homogeneous coordinates for <strong>translation</strong>,
and [u, v, 1]ᵀ is homogeneous coordinates for <strong>perspective division</strong> to present a 3D scene on a 2D image.</p>
</li>
<li>
<p>The translation $\\^𝐭$ is <strong>not affected</strong> by d, so it&rsquo;s separated.<a class="link" href="https://github.com/xy-guo/MVSNet_pytorch/issues/10"  target="_blank" rel="noopener"
    >issue 10</a></p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">src_KRt</span> <span class="o">=</span> <span class="n">intrisics</span> <span class="o">@</span> <span class="n">extrinsics</span><span class="p">[:</span><span class="mi">3</span><span class="p">,:</span><span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">proj</span> <span class="o">=</span> <span class="n">src_KRt</span> <span class="o">@</span> <span class="n">torch</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="n">ref_KRt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">rot</span><span class="p">,</span> <span class="n">trans</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># (4,3), (4,1)</span>
</span></span><span class="line"><span class="cl"><span class="n">rot_uv1</span> <span class="o">=</span> <span class="n">rot</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">@</span> <span class="n">uv1</span><span class="o">.</span><span class="n">t</span><span class="p">()</span>  <span class="c1"># (3, hw)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># depth_values:</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="mf">425.</span> <span class="o">+</span> <span class="mf">1.06</span><span class="o">*</span><span class="mf">2.5</span><span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">192</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># (1,192,1)</span>
</span></span><span class="line"><span class="cl"><span class="n">rot_uvd</span> <span class="o">=</span> <span class="n">rot_uv1</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">192</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span><span class="n">d</span> <span class="c1"># (3,192,hw)</span>
</span></span><span class="line"><span class="cl"><span class="n">pix_proj</span> <span class="o">=</span> <span class="n">rot_uvd</span> <span class="o">+</span> <span class="n">trans</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">192</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>The above procedures of determining projection locations are not involving learnable feature vectors.
Thus, <code>with torch.no_grad():</code> runtime context isn&rsquo;t actually effective.
And the &ldquo;differentiable&rdquo; is achieved by <code>F.grid_sample()</code>.</li>
</ul>
</li>
<li>
<p>Sample the source feature map at the mapped coordinates</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">u_src</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">pix_proj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">pix_proj</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="c1"># (192, hw)</span>
</span></span><span class="line"><span class="cl"><span class="n">v_src</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">pix_proj</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">pix_proj</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">h</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">uv_src</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">u_src</span><span class="p">,</span> <span class="n">v_src</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>   <span class="c1"># (192, hw, 2)</span>
</span></span><span class="line"><span class="cl"><span class="n">warped_feat</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">grid_sample</span><span class="p">(</span><span class="n">src_feat</span><span class="p">,</span> <span class="n">uv_src</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="mi">192</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Merge all feature maps&rsquo; cost volume into their variance:</p>
$$
   \begin{aligned}
   \frac{ ∑_{i=1}^N  (𝐕ᵢ - \bar{𝐕})² }{N} &= \frac{∑_{i=1}^N (𝐕ᵢ² - 2𝐕ᵢ \bar{𝐕} + \bar{𝐕}² ) }{N} \\\
   &= \frac{∑_{i=1}^N 𝐕ᵢ²}{N} - \frac{∑_{i=1}^N 2𝐕ᵢ \bar{𝐕} }{N} + \frac{∑_{i=1}^N  \bar{𝐕}² }{N} \\\
   &= \frac{∑_{i=1}^N 𝐕ᵢ²}{N} - \frac{ 2\bar{𝐕} ∑_{i=1}^N 𝐕ᵢ }{N} + \frac{N \bar{𝐕}²}{N} \\\
   &= \frac{∑_{i=1}^N 𝐕ᵢ²}{N} - \bar{𝐕}²
   \end{aligned}
   $$<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">volume_sq_sum</span> <span class="o">/</span> <span class="n">n_src</span> <span class="o">-</span> <span class="p">(</span><span class="n">volume_sum</span> <span class="o">/</span> <span class="n">n_src</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>Compress the 3D</strong> 32-channel volume variance to 1-channel scalar for each depth through a 3D UNet:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 336 121"
      >
      <g transform='translate(8,16)'>
<text text-anchor='middle' x='0' y='4' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='8' y='4' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='24' y='4' fill='currentColor' style='font-size:1em'>→</text>
<text text-anchor='middle' x='40' y='4' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>↓</text>
<text text-anchor='middle' x='40' y='36' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='48' y='36' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='64' y='36' fill='currentColor' style='font-size:1em'>→</text>
<text text-anchor='middle' x='80' y='36' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='80' y='52' fill='currentColor' style='font-size:1em'>↓</text>
<text text-anchor='middle' x='80' y='68' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='88' y='36' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='88' y='68' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='104' y='68' fill='currentColor' style='font-size:1em'>→</text>
<text text-anchor='middle' x='120' y='68' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='120' y='84' fill='currentColor' style='font-size:1em'>↓</text>
<text text-anchor='middle' x='120' y='100' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='128' y='68' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='128' y='100' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='144' y='4' fill='currentColor' style='font-size:1em'>✚</text>
<text text-anchor='middle' x='144' y='36' fill='currentColor' style='font-size:1em'>✚</text>
<text text-anchor='middle' x='144' y='68' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='144' y='100' fill='currentColor' style='font-size:1em'>→</text>
<text text-anchor='middle' x='160' y='68' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='160' y='100' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='168' y='68' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='168' y='84' fill='currentColor' style='font-size:1em'>↑</text>
<text text-anchor='middle' x='168' y='100' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='184' y='68' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='200' y='68' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='208' y='36' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='208' y='52' fill='currentColor' style='font-size:1em'>↑</text>
<text text-anchor='middle' x='208' y='68' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='216' y='36' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='232' y='36' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='248' y='36' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='256' y='4' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='256' y='20' fill='currentColor' style='font-size:1em'>↑</text>
<text text-anchor='middle' x='256' y='36' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='272' y='4' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='288' y='4' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='304' y='4' fill='currentColor' style='font-size:1em'>→</text>
<text text-anchor='middle' x='320' y='4' fill='currentColor' style='font-size:1em'>1</text>
</g>

    </svg>
  
</div>
<ul>
<li>Note: The original UNet concats the feature maps on the same level,
whereas here the feature vectors are added up, like skip connections in restnet.</li>
</ul>
<p>Then, the logits will be normalized by softmax to become a <strong>vector of probabilities</strong>.</p>
</li>
<li>
<p>The depth of <strong>one pixel</strong> is a <strong>weighted sum</strong> (expectation) of 192 depth values.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 344 137"
      >
      <g transform='translate(8,16)'>
<path d='M 16,32 L 16,64' fill='none' stroke='currentColor'></path>
<path d='M 32,64 L 32,96' fill='none' stroke='currentColor'></path>
<path d='M 72,32 L 72,64' fill='none' stroke='currentColor'></path>
<path d='M 88,64 L 88,96' fill='none' stroke='currentColor'></path>
<path d='M 120,32 L 120,64' fill='none' stroke='currentColor'></path>
<path d='M 136,64 L 136,96' fill='none' stroke='currentColor'></path>
<path d='M 168,32 L 168,64' fill='none' stroke='currentColor'></path>
<path d='M 184,64 L 184,96' fill='none' stroke='currentColor'></path>
<path d='M 296,32 L 296,64' fill='none' stroke='currentColor'></path>
<path d='M 312,64 L 312,96' fill='none' stroke='currentColor'></path>
<path d='M 16,64 L 32,96' fill='none' stroke='currentColor'></path>
<path d='M 16,32 L 32,64' fill='none' stroke='currentColor'></path>
<path d='M 72,64 L 88,96' fill='none' stroke='currentColor'></path>
<path d='M 72,32 L 88,64' fill='none' stroke='currentColor'></path>
<path d='M 120,64 L 136,96' fill='none' stroke='currentColor'></path>
<path d='M 120,32 L 136,64' fill='none' stroke='currentColor'></path>
<path d='M 168,64 L 184,96' fill='none' stroke='currentColor'></path>
<path d='M 168,32 L 184,64' fill='none' stroke='currentColor'></path>
<path d='M 296,64 L 312,96' fill='none' stroke='currentColor'></path>
<path d='M 296,32 L 312,64' fill='none' stroke='currentColor'></path>
<text text-anchor='middle' x='0' y='4' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='0' y='20' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='0' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='8' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='8' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='16' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='16' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='16' y='116' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='24' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='24' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='24' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='32' y='4' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='32' y='116' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='40' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='40' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='48' y='4' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='48' y='68' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='48' y='116' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='56' y='4' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='64' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='72' y='116' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='80' y='20' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='80' y='116' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='88' y='116' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='96' y='68' fill='currentColor' style='font-size:1em'>✚</text>
<text text-anchor='middle' x='120' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='120' y='116' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='128' y='20' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='128' y='116' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='136' y='116' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='144' y='68' fill='currentColor' style='font-size:1em'>✚</text>
<text text-anchor='middle' x='144' y='116' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='152' y='116' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='176' y='20' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='176' y='116' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='184' y='116' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='192' y='68' fill='currentColor' style='font-size:1em'>✚</text>
<text text-anchor='middle' x='192' y='116' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='216' y='68' fill='currentColor' style='font-size:1em'>⋯</text>
<text text-anchor='middle' x='272' y='68' fill='currentColor' style='font-size:1em'>✚</text>
<text text-anchor='middle' x='296' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='296' y='116' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='304' y='20' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='304' y='116' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='312' y='20' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='312' y='116' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='320' y='20' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='320' y='116' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='328' y='116' fill='currentColor' style='font-size:1em'>1</text>
</g>

    </svg>
  
</div>
<ul>
<li>
<p>Kind of like <strong>&ldquo;alpha compositing&rdquo;</strong>, where the opacity corresponds to the probability and
the color of each filter is the depth value here.</p>
</li>
<li>
<p>Or it can be interpreted as a <strong>linear interpolation</strong> for 192 depth values.</p>
</li>
<li>
<p>Each pixel has a distinct <strong>depth-probability distribution</strong> derived from feature maps.</p>
</li>
</ul>
</li>
<li>
<p>Photometric consistency</p>
<p><code>prob_volume</code> → <code>prob_volume_sum4</code>: 4 * average of every 4 depths&rsquo; prob
→ retrieve the &ldquo;4 times average prob&rdquo; from <code>prob_volume_sum4</code> according to the <code>depth_index</code>,
which is a weighted sum (expectation) of 0 ~ 192 using the <code>prob_volume</code>.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 424 233"
      >
      <g transform='translate(8,16)'>
<path d='M 104,48 L 152,48' fill='none' stroke='currentColor'></path>
<path d='M 40,160 L 104,160' fill='none' stroke='currentColor'></path>
<path d='M 272,160 L 288,160' fill='none' stroke='currentColor'></path>
<path d='M 0,16 L 0,48' fill='none' stroke='currentColor'></path>
<path d='M 16,48 L 16,80' fill='none' stroke='currentColor'></path>
<path d='M 24,16 L 24,48' fill='none' stroke='currentColor'></path>
<path d='M 24,96 L 24,144' fill='none' stroke='currentColor'></path>
<path d='M 40,48 L 40,80' fill='none' stroke='currentColor'></path>
<path d='M 72,16 L 72,48' fill='none' stroke='currentColor'></path>
<path d='M 88,48 L 88,80' fill='none' stroke='currentColor'></path>
<path d='M 168,144 L 168,176' fill='none' stroke='currentColor'></path>
<path d='M 184,16 L 184,48' fill='none' stroke='currentColor'></path>
<path d='M 184,176 L 184,208' fill='none' stroke='currentColor'></path>
<path d='M 192,96 L 192,112' fill='none' stroke='currentColor'></path>
<path d='M 192,144 L 192,176' fill='none' stroke='currentColor'></path>
<path d='M 200,48 L 200,80' fill='none' stroke='currentColor'></path>
<path d='M 208,176 L 208,208' fill='none' stroke='currentColor'></path>
<path d='M 240,144 L 240,176' fill='none' stroke='currentColor'></path>
<path d='M 256,176 L 256,208' fill='none' stroke='currentColor'></path>
<path d='M 312,144 L 312,176' fill='none' stroke='currentColor'></path>
<path d='M 328,176 L 328,208' fill='none' stroke='currentColor'></path>
<path d='M 0,48 L 16,80' fill='none' stroke='currentColor'></path>
<path d='M 0,16 L 16,48' fill='none' stroke='currentColor'></path>
<path d='M 24,48 L 40,80' fill='none' stroke='currentColor'></path>
<path d='M 24,16 L 40,48' fill='none' stroke='currentColor'></path>
<path d='M 72,48 L 88,80' fill='none' stroke='currentColor'></path>
<path d='M 72,16 L 88,48' fill='none' stroke='currentColor'></path>
<path d='M 168,176 L 184,208' fill='none' stroke='currentColor'></path>
<path d='M 168,144 L 184,176' fill='none' stroke='currentColor'></path>
<path d='M 192,176 L 208,208' fill='none' stroke='currentColor'></path>
<path d='M 192,144 L 208,176' fill='none' stroke='currentColor'></path>
<path d='M 240,176 L 256,208' fill='none' stroke='currentColor'></path>
<path d='M 184,48 L 200,80' fill='none' stroke='currentColor'></path>
<path d='M 240,144 L 256,176' fill='none' stroke='currentColor'></path>
<path d='M 184,16 L 200,48' fill='none' stroke='currentColor'></path>
<path d='M 312,176 L 328,208' fill='none' stroke='currentColor'></path>
<path d='M 312,144 L 328,176' fill='none' stroke='currentColor'></path>
<polygon points='112.000000,160.000000 100.000000,154.399994 100.000000,165.600006' fill='currentColor' transform='rotate(0.000000, 104.000000, 160.000000)'></polygon>
<polygon points='160.000000,48.000000 148.000000,42.400002 148.000000,53.599998' fill='currentColor' transform='rotate(0.000000, 152.000000, 48.000000)'></polygon>
<polygon points='200.000000,112.000000 188.000000,106.400002 188.000000,117.599998' fill='currentColor' transform='rotate(90.000000, 192.000000, 112.000000)'></polygon>
<polygon points='296.000000,160.000000 284.000000,154.399994 284.000000,165.600006' fill='currentColor' transform='rotate(0.000000, 288.000000, 160.000000)'></polygon>
<path d='M 24,144 A 16,16 0 0,0 40,160' fill='none' stroke='currentColor'></path>
<text text-anchor='middle' x='0' y='4' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='8' y='4' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='16' y='4' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='32' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='40' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='40' y='116' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='40' y='148' fill='currentColor' style='font-size:1em'>T</text>
<text text-anchor='middle' x='48' y='4' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='48' y='52' fill='currentColor' style='font-size:1em'>⋯</text>
<text text-anchor='middle' x='48' y='116' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='48' y='148' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='56' y='4' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='56' y='116' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='56' y='148' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='64' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='72' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='72' y='148' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='80' y='116' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='88' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='88' y='148' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='96' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='96' y='148' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='104' y='36' fill='currentColor' style='font-size:1em'>*</text>
<text text-anchor='middle' x='104' y='116' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='112' y='36' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='120' y='36' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='120' y='116' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='120' y='164' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='120' y='180' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='128' y='36' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='128' y='116' fill='currentColor' style='font-size:1em'>;</text>
<text text-anchor='middle' x='128' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='128' y='180' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='136' y='36' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='136' y='164' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='136' y='180' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='144' y='36' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='144' y='164' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='144' y='180' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='152' y='36' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='160' y='36' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='176' y='4' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='184' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='192' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='200' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='208' y='4' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='208' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='208' y='116' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='216' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='216' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='216' y='180' fill='currentColor' style='font-size:1em'>⋯</text>
<text text-anchor='middle' x='224' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='224' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='224' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='232' y='4' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='232' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='240' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='240' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='240' y='116' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='248' y='4' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='248' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='256' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='256' y='20' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='256' y='116' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='264' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='264' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='272' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='272' y='20' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='280' y='4' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='288' y='4' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='296' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='304' y='4' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='304' y='116' fill='currentColor' style='font-size:1em'>P</text>
<text text-anchor='middle' x='304' y='132' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='312' y='116' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='312' y='132' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='320' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='320' y='132' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='328' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='328' y='132' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='336' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='336' y='132' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='344' y='116' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='344' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='352' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='352' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='360' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='360' y='132' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='368' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='368' y='132' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='376' y='116' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='376' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='384' y='116' fill='currentColor' style='font-size:1em'>c</text>
</g>

    </svg>
  
</div>
<ul>
<li>The quality of depth estimation is measured by the sum of 4 nearby probabilities for a predicted depth.
If this probability sum is high, the estimation is reliable.</li>
</ul>
</li>
<li>
<p>Refine Network</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 288 73"
      >
      <g transform='translate(8,16)'>
<path d='M 48,0 L 240,0' fill='none' stroke='currentColor'></path>
<path d='M 32,48 L 40,48' fill='none' stroke='currentColor'></path>
<path d='M 80,48 L 88,48' fill='none' stroke='currentColor'></path>
<path d='M 128,48 L 136,48' fill='none' stroke='currentColor'></path>
<path d='M 176,48 L 184,48' fill='none' stroke='currentColor'></path>
<path d='M 216,48 L 224,48' fill='none' stroke='currentColor'></path>
<path d='M 240,0 L 240,32' fill='none' stroke='currentColor'></path>
<polygon points='48.000000,48.000000 36.000000,42.400002 36.000000,53.599998' fill='currentColor' transform='rotate(0.000000, 40.000000, 48.000000)'></polygon>
<polygon points='96.000000,48.000000 84.000000,42.400002 84.000000,53.599998' fill='currentColor' transform='rotate(0.000000, 88.000000, 48.000000)'></polygon>
<polygon points='144.000000,48.000000 132.000000,42.400002 132.000000,53.599998' fill='currentColor' transform='rotate(0.000000, 136.000000, 48.000000)'></polygon>
<polygon points='192.000000,48.000000 180.000000,42.400002 180.000000,53.599998' fill='currentColor' transform='rotate(0.000000, 184.000000, 48.000000)'></polygon>
<polygon points='232.000000,48.000000 220.000000,42.400002 220.000000,53.599998' fill='currentColor' transform='rotate(0.000000, 224.000000, 48.000000)'></polygon>
<polygon points='248.000000,32.000000 236.000000,26.400000 236.000000,37.599998' fill='currentColor' transform='rotate(90.000000, 240.000000, 32.000000)'></polygon>
<text text-anchor='middle' x='0' y='4' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='0' y='20' fill='currentColor' style='font-size:1em'>⊕</text>
<text text-anchor='middle' x='8' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='16' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='16' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='16' y='36' fill='currentColor' style='font-size:1em'>↓</text>
<text text-anchor='middle' x='16' y='52' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='24' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='24' y='20' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='32' y='4' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='56' y='52' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='64' y='52' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='104' y='52' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='112' y='52' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='152' y='52' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='160' y='52' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='200' y='52' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='240' y='52' fill='currentColor' style='font-size:1em'>✚</text>
<text text-anchor='middle' x='256' y='52' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='272' y='52' fill='currentColor' style='font-size:1em'>1</text>
</g>

    </svg>
  
</div>
<ul>
<li>T&amp;T dataset doesn&rsquo;t provide normal information to generate mesh surface,
and render images for each viewpoint, so the depth map cannot be finetuned by the reference image.</li>
</ul>
</li>
</ol>
<hr>
<h3 id="point-cloud">Point Cloud
</h3><ol>
<li>
<p>Filter Depth Map based on photometric (probability map&gt;0.8),
and geometric (re-projection error less than 1 pixel) consistencies</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 272 185"
      >
      <g transform='translate(8,16)'>
<path d='M 0,16 L 0,80' fill='none' stroke='currentColor'></path>
<path d='M 32,80 L 32,144' fill='none' stroke='currentColor'></path>
<path d='M 88,80 L 88,144' fill='none' stroke='currentColor'></path>
<path d='M 120,16 L 120,80' fill='none' stroke='currentColor'></path>
<path d='M 40,48 L 56,16' fill='none' stroke='currentColor'></path>
<path d='M 40,80 L 56,48' fill='none' stroke='currentColor'></path>
<path d='M 88,80 L 120,16' fill='none' stroke='currentColor'></path>
<path d='M 88,144 L 120,80' fill='none' stroke='currentColor'></path>
<path d='M 0,80 L 32,144' fill='none' stroke='currentColor'></path>
<path d='M 0,16 L 32,80' fill='none' stroke='currentColor'></path>
<path d='M 64,64 L 72,80' fill='none' stroke='currentColor'></path>
<path d='M 64,0 L 80,32' fill='none' stroke='currentColor'></path>
<path d='M 80,32 L 88,48' fill='none' stroke='currentColor'></path>
<polygon points='52.000000,80.000000 40.000000,74.400002 40.000000,85.599998' fill='currentColor' transform='rotate(120.000000, 40.000000, 80.000000)'></polygon>
<polygon points='68.000000,16.000000 56.000000,10.400000 56.000000,21.600000' fill='currentColor' transform='rotate(300.000000, 56.000000, 16.000000)'></polygon>
<polygon points='76.000000,64.000000 64.000000,58.400002 64.000000,69.599998' fill='currentColor' transform='rotate(240.000000, 64.000000, 64.000000)'></polygon>
<polygon points='92.000000,32.000000 80.000000,26.400000 80.000000,37.599998' fill='currentColor' transform='rotate(60.000000, 80.000000, 32.000000)'></polygon>
<circle cx='56' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='64' cy='0' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='8' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='16' y='100' fill='currentColor' style='font-size:1em'>□</text>
<text text-anchor='middle' x='16' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='24' y='164' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='104' y='100' fill='currentColor' style='font-size:1em'>□</text>
<text text-anchor='middle' x='104' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='112' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='120' y='164' fill='currentColor' style='font-size:1em'>c</text>
</g>

    </svg>
  
</div>
<ul>
<li>
<p>The function for &ldquo;geometric consistency&rdquo;:</p>
<ol>
<li>
<p>Input: 10 source views of a reference view,</p>
</li>
<li>
<p>Output: <strong>A mask</strong> for the reference image.</p>
</li>
</ol>
</li>
<li>
<p>Geometric consistency implementations:</p>
<ol>
<li>
<p><code>check_geo_consistency()</code> in <a class="link" href="https://github.com/kwea123/CasMVSNet_pl/blob/a09e5ba230a18be54b9f6b1d714c3dc58acd8a00/eval.py#L153-L156"  target="_blank" rel="noopener"
    >kwea123/CasMVSNet_pl/eval.py</a></p>
</li>
<li>
<p><code>check_geometric_consistency()</code> in <a class="link" href="https://github.com/xy-guo/MVSNet_pytorch/blob/e0f2ae3d7cb2dd13807b775f2075682eaa7f1521/eval.py#L173-L188"  target="_blank" rel="noopener"
    >xy-guo/MVSNet_pytorch/eval.py</a></p>
</li>
</ol>
</li>
</ul>
</li>
<li>
<p>Fuse multi-view depth maps based on visibility, and then unproject the unified depth map.</p>
</li>
</ol>
<hr>
<h3 id="actice-recall-exercise">Actice Recall Exercise
</h3><p>(2025-04-10)</p>
<ul>
<li>
<p><strong>不要画</strong>相机，不要想象相机，MVSNet 方法的 setting 中，所涉及到的对象只有 <strong>图片</strong>(平面)，只是从不同方向去看图片。</p>
</li>
<li>
<p>方法的核心是代价体</p>
</li>
</ul>
<hr>
<h2 id="play">Play
</h2><h3 id="profiler">Profiler
</h3><p>The training is slow, almost as slow as NeRF. Why?</p>
<p>There is a <code>profile()</code> function provided.</p>
<hr>
<p>(2023-12-09)</p>
<h3 id="dtu">DTU
</h3><p>The preprocessed DTU includes 79 training <strong>scans</strong> (scenes) and 22 testing scans.
Each scan has the same 49 <strong>camera poses</strong> with 7 different <strong>light conditions</strong>.</p>
<p>Therefore, each scan has 79×49×7 = 27097 pictures serving as reference images.
Each reference image is assigned with 10 images taken with nearest poses under the same light condition.</p>
<p>During training, 3 source images are used to estimate the depth map of the corresponding reference image,
while 5 source images are used during testing.</p>
<p>The <strong>depth range</strong> is determined based on the <code>depth_min</code> (425.0) and <code>depth_interval * interval_scale</code> (2.5 × 1.06) between two adjacent fronto-parallel planes.
For example, if there are 192 planes, the max depth is
425 + (2.5 × 1.06) × (192-1) = 931.15</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">         <span class="p">|</span>------<span class="p">|</span>------<span class="p">|</span>------ ... ---<span class="p">|</span>
</span></span><span class="line"><span class="cl">depth: 425.0  427.65  430.3         931.1488
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="link" href="https://github.com/xy-guo/MVSNet_pytorch/blob/e0f2ae3d7cb2dd13807b775f2075682eaa7f1521/models/module.py#L117C11-L117C11"  target="_blank" rel="noopener"
    >Code</a>
warps the source feat map in a backward way by <strong>reversing</strong> the target coordinates back to the source feat map and then sampling,
rather than computing the target coordinates directly from the homography represented with planes.</p>
<p>The pixel transferring from the (target) reference plane to a source plane is performed by <strong>3 steps</strong>:
rotate first, then assign depths, finally add translation.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">       rot@           *d                 +t
</span></span><span class="line"><span class="cl"><span class="o">(</span>u,v,1<span class="o">)</span> -&gt; <span class="o">(</span>u<span class="s1">&#39;,v&#39;</span>,w<span class="s1">&#39;) -&gt; (u&#39;</span>d, v<span class="s1">&#39;d, w&#39;</span>d<span class="o">)</span> -&gt; <span class="o">(</span>u<span class="s1">&#39;d, v&#39;</span>d, w<span class="err">&#39;</span>d<span class="o">)</span> + t
</span></span></code></pre></td></tr></table>
</div>
</div>$$
\begin{bmatrix} u \\\ v \\\ 1 \end{bmatrix} →
\begin{bmatrix} u' \\\ v' \\\ w' \end{bmatrix} →
\begin{bmatrix} u'd \\\ v'd \\\ w'd \end{bmatrix} →
\begin{bmatrix} u'd+t \\\ v'd+t \\\ w'd+t \end{bmatrix} →
\begin{bmatrix} \frac{u'd+t}{w'd+t} \\\ \frac{v'd+t}{w'd+t} \\\ 1 \end{bmatrix}
$$<p>Refer to eq.(11) in <a class="link" href="https://zhuanlan.zhihu.com/p/363830541"  target="_blank" rel="noopener"
    >Multi-View Stereo中的平面扫描(plane sweep) - ewrfcas的文章 - 知乎</a></p>
$$
R
$$<hr>
<h3 id="read-gt-depth">Read GT Depth
</h3><p>(2023-12-19)</p>
<ol>
<li>
<p>Find the ground-truth depth map for an input image (512, 640).</p>
<p>The preprocessced DTU (&ldquo;dtu_training.rar&rdquo;) only contains 1/4 depth maps with size 128x160, aligned with the size of feature maps.
So, each file (&ldquo;DTU_Depths_raw/scan1_train/depth_map_0000.pfm&rdquo;) is 80K.</p>
<p>While the folder &ldquo;DTU_Depths_raw/&rdquo; (&ldquo;Depth_raw.zip&rdquo; used in MVSNeRF) includes full-size pfm
with the same resolution 1200x1600 as the DTU images.
An example: &ldquo;DTU_Depths_raw/scan1/depth_map_0000.pfm&rdquo;: 7.32M</p>
</li>
<li>
<p>Read depth map with function <a class="link" href="https://github.com/xy-guo/MVSNet_pytorch/blob/e0f2ae3d7cb2dd13807b775f2075682eaa7f1521/datasets/data_io.py#L6C1-L41C23"  target="_blank" rel="noopener"
    ><code>read_pfm()</code></a>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">imageio</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">datasets.data_io</span> <span class="kn">import</span> <span class="n">read_pfm</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">depth_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&#34;../DTU_Depths_raw/scan4_train/depth_map_0008.pfm&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">depth_pfm</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">read_pfm</span><span class="p">(</span><span class="n">depth_path</span><span class="p">)</span>  <span class="c1"># (128,160), 1.0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">depth_png</span> <span class="o">=</span> <span class="n">imageio</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&#34;../DTU_Depths_raw/scan4_train/depth_visual_0008.png&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">orig_rgb</span> <span class="o">=</span> <span class="n">imageio</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&#34;../mvs_training/dtu/Rectified/scan4_train/rect_009_3_r5000.png&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">orig_rgb</span> <span class="o">=</span> <span class="n">orig_rgb</span><span class="p">[::</span><span class="mi">4</span><span class="p">,::</span><span class="mi">4</span><span class="p">,:]</span>   <span class="c1"># reduce 4 times</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">q_x</span><span class="p">,</span> <span class="n">q_y</span> <span class="o">=</span>  <span class="nb">int</span><span class="p">(</span><span class="mi">190</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">125</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>   <span class="c1"># query point</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">q_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">q_y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">depth_pfm</span><span class="p">[</span><span class="n">q_x</span><span class="p">,</span> <span class="n">q_y</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">q_x</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="n">q_y</span><span class="o">-</span><span class="mf">12.5</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">q_y</span><span class="o">+</span><span class="mf">12.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">q_y</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="n">q_x</span><span class="o">-</span><span class="mf">12.5</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">q_x</span><span class="o">+</span><span class="mf">12.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">depth_pfm</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># plt.imshow(depth_png, alpha=1)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">orig_rgb</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">depth_path</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">:])</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<hr>
<p>### LLFF</p>
<p><strong>Analyses</strong>:</p>
<p>What&rsquo;s the key of its generalizability?</p>
<hr>
<h3 id="environment">Environment
</h3><p>(2024-02-21)</p>
<p>Referring to this <a class="link" href="https://github.com/YoYo000/MVSNet/issues/101"  target="_blank" rel="noopener"
    >issue#101</a>
and <a class="link" href="https://github.com/YoYo000/MVSNet/issues/149"  target="_blank" rel="noopener"
    >issue#149</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">conda create --name MVSNet <span class="nv">python</span><span class="o">=</span>3.7  <span class="nv">cudatoolkit</span><span class="o">=</span>9.0 <span class="nv">cudnn</span><span class="o">=</span>7.6.4 -c conda-forge
</span></span><span class="line"><span class="cl">pip install -r requirements.txt <span class="c1"># tf==1.15.0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Download pretrained model: <a class="link" href="" ></a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">gdown 1-1JyFT9ClqPO0kz0d_5I1_IHX05paS4h
</span></span></code></pre></td></tr></table>
</div>
</div><p>Validate:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">python mvsnet/validate.py --regularization <span class="s1">&#39;3DCNNs&#39;</span> --validate_set dtu --max_w <span class="m">640</span> --max_h <span class="m">512</span> --max_d <span class="m">128</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--pretrained_model_ckpt_path <span class="s1">&#39;tf_model_dtu/3DCNNs/model.ckpt-150000.data-00000-of-00001&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--dtu_data_root <span class="s1">&#39;~/Downloads/mvs_training/dtu&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--validation_result_path <span class="s1">&#39;validation&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="related">Related
</h2><p><a class="link" href="https://www.youtube.com/live/zmE_kj-Gh84?si=0gNhafDu8zdhqM5x"  target="_blank" rel="noopener"
    >Mutli-view stereo多視角立體重建技術介紹 - AI葵</a></p>
<ol>
<li>
<p><a class="link" href="https://whubaichuan.github.io/data/MVSNet.pdf"  target="_blank" rel="noopener"
    >MVSNet系列 - MEGVII 黄百川</a></p>
</li>
<li>
<p><a class="link" href="https://zhuanlan.zhihu.com/p/460190156"  target="_blank" rel="noopener"
    >【代码精读】开山之作MVSNet PyTorch版本超详细分析 - doubleZ的文章 - 知乎</a></p>
</li>
<li>
<p><a class="link" href="https://blog.csdn.net/qq_41794040/article/details/127917341"  target="_blank" rel="noopener"
    >【论文精读5】MVSNet系列论文详解-Point-MVSNet - CSDN博客</a></p>
</li>
<li>
<p><a class="link" href="https://www.bilibili.com/read/cv8776533/"  target="_blank" rel="noopener"
    >多视图几何三维重建实战系列- Cascade-MVSNet - 哔哩哔哩</a></p>
</li>
<li>
<p>Follow-up 2019-2020. <a class="link" href="https://zhuanlan.zhihu.com/p/148569782"  target="_blank" rel="noopener"
    >基于深度学习的三维重建——MVSNet系列论文解读 - 机器人3D感知的文章 - 知乎</a></p>
</li>
</ol>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/mvg/">MVG</a>
        
    </section>


    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
	const mainArticleElement = document.querySelector(".main-article");
        renderMathInElement(mainArticleElement, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>

    

    

    


    

    


    
    


    
    


    
    

    

    


</article>



    
        <div class="article-list--compact links">
    
        <article>
            <a href="https://github.com/YoYo000/MVSNet" target="_blank" rel="noopener">
                <div class="article-details">
                    <h2 class="article-title">MVSNet - GitHub</h2>
                    <footer class="article-time">
                        
                            Official Repo from Yao Yao
                        
                    </footer>
                </div>
        
                
                    
                    
                    <div class="article-image">
                        <img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" loading="lazy">
                    </div>
                
            </a>
        </article>
    
        <article>
            <a href="https://github.com/xy-guo/MVSNet_pytorch" target="_blank" rel="noopener">
                <div class="article-details">
                    <h2 class="article-title">MVSNet_pytorch</h2>
                    <footer class="article-time">
                        
                            Xiaoyang Guo
                        
                    </footer>
                </div>
        
                
                    
                    
                    <div class="article-image">
                        <img src="https://avatars.githubusercontent.com/u/10137867?v=4" loading="lazy">
                    </div>
                
            </a>
        </article>
    
</div>
    

    

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2025 Zichen Wang
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
