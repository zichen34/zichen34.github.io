<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="Mathematical Supplement for the gsplat Library">
<title>Read: 3DGS | Math Derivation</title>

<link rel='canonical' href='http://blog.zichen.uk/post/writenotes/model/splats/b-note-3dgs-math/'>

<link rel="stylesheet" href="/scss/style.min.0e95b70faf4f470dc6ba88da538ece0f8cf22d03bab371e1b345205b81899732.css"><meta property='og:title' content="Read: 3DGS | Math Derivation">
<meta property='og:description' content="Mathematical Supplement for the gsplat Library">
<meta property='og:url' content='http://blog.zichen.uk/post/writenotes/model/splats/b-note-3dgs-math/'>
<meta property='og:site_name' content='Zichen Wang'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Splatting' /><meta property='article:published_time' content='2024-01-01T12:45:00&#43;00:00'/><meta property='article:modified_time' content='2024-01-01T12:45:00&#43;00:00'/><meta property='og:image' content='https://janakiev.com/assets/covariance-matrix_files/covariance_visualization.jpg' />
<meta name="twitter:title" content="Read: 3DGS | Math Derivation">
<meta name="twitter:description" content="Mathematical Supplement for the gsplat Library"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://janakiev.com/assets/covariance-matrix_files/covariance_visualization.jpg' />
    <link rel="shortcut icon" href="/favicon-32x32.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_b598b46054b3fa80.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Zichen Wang</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/zichen34'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com/luckily1640'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/post/writenotes/' >
                
                
                
                <span>WriteNotes</span>
            </a>
        </li>
        
        
        <li >
            <a href='/post/writenotes/model/acadmodel/aboutme/' >
                
                
                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#projection">Projection</a>
      <ol>
        <li><a href="#ndc-mapping">NDC Mapping</a></li>
        <li><a href="#project-mean-vector-ğ›">Project mean vector ğ›</a></li>
        <li><a href="#project-covariance">Project Covariance</a></li>
      </ol>
    </li>
    <li><a href="#rasterizing">Rasterizing</a>
      <ol>
        <li><a href="#sorting-kernels">Sorting Kernels</a></li>
        <li><a href="#alpha-blending">Alpha Blending</a></li>
      </ol>
    </li>
    <li><a href="#gradient-wrt-composite">Gradient wrt Composite</a>
      <ol>
        <li><a href="#color-opacity">Color, Opacity</a></li>
      </ol>
    </li>
    <li><a href="#gradient-wrt-projection">Gradient wrt Projection</a>
      <ol>
        <li><a href="#center">Center</a></li>
        <li><a href="#covariance">Covariance</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/post/writenotes/model/splats/b-note-3dgs-math/">
                
                    <img src="https://janakiev.com/assets/covariance-matrix_files/covariance_visualization.jpg" loading="lazy" alt="Featured image of post Read: 3DGS | Math Derivation" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/read/" style="background-color: #2a9d8f; color: #fff;">
                Read
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/post/writenotes/model/splats/b-note-3dgs-math/">Read: 3DGS | Math Derivation</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            Mathematical Supplement for the gsplat Library
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jan 01, 2024</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    44 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
<section class="toc toc--inline">
    <h2 class="">Table of contents</h2>
    <div class="" >
        <nav id="TableOfContents">
  <ol>
    <li><a href="#projection">Projection</a>
      <ol>
        <li><a href="#ndc-mapping">NDC Mapping</a></li>
        <li><a href="#project-mean-vector-ğ›">Project mean vector ğ›</a></li>
        <li><a href="#project-covariance">Project Covariance</a></li>
      </ol>
    </li>
    <li><a href="#rasterizing">Rasterizing</a>
      <ol>
        <li><a href="#sorting-kernels">Sorting Kernels</a></li>
        <li><a href="#alpha-blending">Alpha Blending</a></li>
      </ol>
    </li>
    <li><a href="#gradient-wrt-composite">Gradient wrt Composite</a>
      <ol>
        <li><a href="#color-opacity">Color, Opacity</a></li>
      </ol>
    </li>
    <li><a href="#gradient-wrt-projection">Gradient wrt Projection</a>
      <ol>
        <li><a href="#center">Center</a></li>
        <li><a href="#covariance">Covariance</a></li>
      </ol>
    </li>
  </ol>
</nav>

    </div>
</section>



    
    
    <p><a class="link" href="https://github.com/nerfstudio-project/gsplat"  target="_blank" rel="noopener"
    >Code</a>
| <a class="link" href="https://arxiv.org/abs/2312.02121"  target="_blank" rel="noopener"
    >arXiv</a>
| <a class="link" href="https://people.eecs.berkeley.edu/~vye/"  target="_blank" rel="noopener"
    >Vickie Ye</a></p>
<ul>
<li>Surfaced by <a class="link" href="https://zhuanlan.zhihu.com/p/670457696"  target="_blank" rel="noopener"
    >NeRF&amp;Beyond 12.5æ—¥æŠ¥(CustomNeRFï¼ŒVideoRFï¼Œç½‘æ ¼å¼•å¯¼ç¼–è¾‘ï¼ŒSANeRF-HQï¼ŒGPS-Gaussianï¼Œä¸¤ä¸ªGaussianAvatarï¼ŒSpalTAMï¼Œgsplatï¼‰ - Jasoné™ªä½ ç»ƒç»æŠ€çš„æ–‡ç«  - çŸ¥ä¹</a> <br></li>
<li>Feature image from: <a class="link" href="https://janakiev.com/blog/covariance-matrix/"  target="_blank" rel="noopener"
    >Understanding the Covariance Matrix - Janakiev</a></li>
</ul>
<hr>
<p><strong>Updates</strong>:</p>
<p>(2024-06-17)</p>
<ul>
<li>
<p>I suspect I may have previously mixed up the directions of &ldquo;back&rdquo; and &ldquo;front&rdquo; after reviewing the ewa splatting paper.</p>
<p>The &ldquo;back&rdquo; is supposed to be close to the <strong>eye</strong> (camera), which looks at the &ldquo;front&rdquo;.
As said in the ewa paper:</p>
<blockquote>
<p>the final image is computed by compositing the sheets back to front.</p></blockquote>
<p>So, I changed all the &ldquo;front&rdquo; to &ldquo;back&rdquo; in this post, and vice versa.</p>
</li>
</ul>
<hr>
<h2 id="projection">Projection
</h2><details><summary>Old Notes on 2023-12-05</summary>
<p>NDC is the <strong>de-homogeneous</strong> clip coordinates and ranges [-1,1].</p>
<p><strong>De-homogeneous</strong> means the <strong>z value</strong> has been divided.</p>
<p>Mapping the coordinates of point (x,y,z) in <strong>camera space</strong> to clip coordinates, i.e., a cube of [-1,1] can be decomposed to <strong>two operations</strong>:
perspective projection and scaling ranges, and then compound them.</p>
$$
\begin{array}{ccc}
\begin{bmatrix}x_{clip} \\\ y_{clip} \\\ z_{clip} \\\ w_{clip} \end{bmatrix} = 
\begin{bmatrix} â–¡ & â–¡ & â–¡ & â–¡ \\\ â–¡ & â–¡ & â–¡ & â–¡ \\\ â–¡ & â–¡ & â–¡ & â–¡ \\\ â–¡ & â–¡ & â–¡ & â–¡ \end{bmatrix}
\begin{bmatrix}x \\\ y \\\  z \\\ 1 \end{bmatrix}
\end{array}
$$<p>The individual perspective projection:</p>
$$
\begin{bmatrix} fâ‚“ & 0 & 0 \\\ 0 & f_y & 0 \\\ 0 & 0 &1 \end{bmatrix}
\begin{bmatrix} x \\\ y \\\ z \end{bmatrix}
$$<p>After that, the plane coordinates are (u, v), wher
$u = \frac{fâ‚“x}{z}, v=\frac{f_yy}{z}$.</p>
<p>Then scaling the ranges:</p>
<ol>
<li>
<p>Scale the range of u from [-w/2,w/2] to [-1,1] through a linear mapping: Î± u + Î²</p>
<p>Î± and Î² be solved based on two points.</p>
$$
   \begin{array}{cc}
   \begin{cases} Î± (-w/2) + Î² = -1 \\\ Î± w/2 + Î² = 1  \end{cases} â‡’
   \begin{cases} Î± = 2/w \\\ Î² = 0  \end{cases}
   \end{array}
   $$</li>
<li>
<p>Similarly, scale the range of v from [-h/2,h/2] to [-1,1] through a linear mapping: Î± v + Î²</p>
<p>Thus, $Î±= 2/h,  Î²=0$</p>
<p>So far, the first 2 rows are determined:</p>
$$
   \begin{array}{ccc}
   \begin{bmatrix}x_{clip} \\\ y_{clip} \\\ z_{clip} \\\ w_{clip} \end{bmatrix} = 
   \begin{bmatrix} 2fâ‚“/w & 0 & 0 & 0 \\\ 0 & 2f_y/h & 0 & 0 \\\ â–¡ & â–¡ & â–¡ & â–¡ \\\ â–¡ & â–¡ & â–¡ & â–¡ \end{bmatrix}
   \begin{bmatrix}x \\\ y \\\  z \\\ 1 \end{bmatrix}
   \end{array}
   $$</li>
<li>
<p>When scaling z, it has nothing to do with x and y. Thus, the 3rd row is 0 0 â–¡ â–¡.</p>
<p>Beacuse NDC is the <strong>de-homogeneous</strong> clip coordinates, which requires <strong>divide by z</strong> to become NDC.
Therefore, the 4-th row is 0 0 1 0.</p>
$$
   \begin{array}{ccc}
   \begin{bmatrix}x_{clip} \\\ y_{clip} \\\ z_{clip} \\\ w_{clip} \end{bmatrix} = 
   \begin{bmatrix} 2fâ‚“/w & 0 & 0 & 0 \\\ 0 & 2f_y/h & 0 & 0 \\\ 
    0 & 0 & A & B \\\ 0 & 0 & 1 & 0 \end{bmatrix}
   \begin{bmatrix}x \\\ y \\\  z \\\ 1 \end{bmatrix}
   \end{array}
   $$<p>With denoting the two unknowns as A and B, the <strong>NDC of z dimension</strong> is:
$\frac{A z + B}{z}$.</p>
<p>According to the range constraint [-1,1], the A and B can be solved from:</p>
$$
   \begin{array}{cc}
   \begin{cases} \frac{A n + B }{n} = -1 \\\ \frac{A f + B }{f} = 1 \end{cases} â‡’
   \begin{cases} A = (f+n)/(f-n) \\\ B = -2fn/(f-n) \end{cases}
   \end{array}
   $$</li>
</ol>
<p>Finally, the mapping from the camera coordinates of a point to corresponding clip coordinates is:</p>
$$
\begin{array}{ccc}
\begin{bmatrix}x_{clip} \\\ y_{clip} \\\ z_{clip} \\\ w_{clip} \end{bmatrix} = 
\begin{bmatrix} 2fâ‚“/w & 0 & 0 & 0 \\\ 0 & 2f_y/h & 0 & 0 \\\ 
 0 & 0 & \frac{f+n}{f-n} & \frac{-2fn}{f-n} \\\ 0 & 0 & 1 & 0 \end{bmatrix}
\begin{bmatrix}x \\\ y \\\  z \\\ 1 \end{bmatrix}
\end{array}
$$</details>
<hr>
<h3 id="ndc-mapping">NDC Mapping
</h3><p>(2024-01-01)</p>
<p>The perspective division (a 3D <strong>pixel</strong> coordinates are divided by the 3rd dimension)
should be performed as the <strong>final step</strong> in the transformation pipeline, as it&rsquo;s a <strong>non-linear</strong> operation.</p>
<p>Given a 3D point (x,y,z)áµ€ located in the <strong>camera space</strong>,
the perspective projection and scaling are carried out in sequence to obtain its clip coordinates (not NDC yet).</p>
$$
\begin{array}{c}
\text{[Scaling Matrix] [Perspective Projection] [Camera space] = [Clip space]} \\\ \\\
\begin{bmatrix}
â–¡ & â–¡ & â–¡ & â–¡ \\\ 
â–¡ & â–¡ & â–¡ & â–¡ \\\ 
â–¡ & â–¡ & â–¡ & â–¡ \\\ 
â–¡ & â–¡ & â–¡ & â–¡ 
\end{bmatrix}
\begin{bmatrix}
fâ‚“ & 0   & câ‚“  & 0 \\\
0  & f_y & c_y & 0 \\\
0  & 0   & 1   & 0 \\\
0  & 0   & 0   & 1
\end{bmatrix}
\begin{bmatrix} x \\\ y \\\ z \\\ 1 \end{bmatrix} = 
\begin{bmatrix} x_c \\\ y_c \\\ z_c \\\ w_c \end{bmatrix}
\end{array}
$$<p>The scaling matrix is built with the goal of mapping the view frustum to a [-1,1] <strong>NDC-space cube</strong> encompassing only valid points,
whose clip coordinates satisfy: $-w_c < x_c,y_c,z_c < w_c$.
Specifically, the projected coordinates are scaled and then perform perspective division to become the NDC.</p>
<ol>
<li>
<p>Perspective projection:</p>
$$
   \begin{bmatrix}
   fâ‚“ & 0   & câ‚“  & 0 \\\
   0  & f_y & c_y & 0 \\\
   0  & 0   & 1   & 0 \\\
   0  & 0   & 0   & 1
   \end{bmatrix}
   \begin{bmatrix}  x \\\ y \\\ z \\\ 1  \end{bmatrix} = 
   \begin{bmatrix} fâ‚“x + câ‚“ z \\\ f_y y + c_y z \\\ z \\\ 1 \end{bmatrix}
   $$


<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 352 153"
      >
      <g transform='translate(8,16)'>
<path d='M 40,16 L 168,16' fill='none' stroke='currentColor'></path>
<path d='M 40,112 L 168,112' fill='none' stroke='currentColor'></path>
<path d='M 40,16 L 40,112' fill='none' stroke='currentColor'></path>
<path d='M 168,16 L 168,112' fill='none' stroke='currentColor'></path>
<text text-anchor='middle' x='16' y='4' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='16' y='132' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='24' y='4' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='24' y='132' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='32' y='4' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='32' y='132' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='40' y='4' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='40' y='132' fill='currentColor' style='font-size:1em'>H</text>
<text text-anchor='middle' x='48' y='4' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='48' y='68' fill='currentColor' style='font-size:1em'>â€¦</text>
<text text-anchor='middle' x='48' y='132' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='64' y='52' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='64' y='68' fill='currentColor' style='font-size:1em'>â€¦</text>
<text text-anchor='middle' x='72' y='52' fill='currentColor' style='font-size:1em'>â‚“</text>
<text text-anchor='middle' x='80' y='68' fill='currentColor' style='font-size:1em'>â€¦</text>
<text text-anchor='middle' x='96' y='68' fill='currentColor' style='font-size:1em'>â€¦</text>
<text text-anchor='middle' x='104' y='36' fill='currentColor' style='font-size:1em'>â‹®</text>
<text text-anchor='middle' x='104' y='52' fill='currentColor' style='font-size:1em'>â‹®</text>
<text text-anchor='middle' x='104' y='68' fill='currentColor' style='font-size:1em'>âˆ™</text>
<text text-anchor='middle' x='104' y='84' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='112' y='52' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='112' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='120' y='52' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='120' y='84' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='128' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='136' y='84' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='160' y='4' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='168' y='4' fill='currentColor' style='font-size:1em'>W</text>
<text text-anchor='middle' x='176' y='4' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='184' y='4' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='192' y='4' fill='currentColor' style='font-size:1em'>)</text>
</g>

    </svg>
  
</div>
</li>
<li>
<p>Scaling projected coordinates u and v to [-1, 1]</p>
<p>To scale u, the 1st row of the scaling matrix is A 0 B 0.</p>
<p>Perform scaling first, followed by perspective division, to obtain the x in NDC space:
$\frac{A (fâ‚“ x + câ‚“ z) + Bz}{z} = A (\frac{fâ‚“ x}{z} + câ‚“) + B âˆˆ [-1,1]$</p>
<p>Since $(\frac{fâ‚“ x}{z} + câ‚“) = u âˆˆ [0,W]$</p>
$$
   \begin{cases}
   A0 + B = -1 \\\  AW + B = 1
   \end{cases} â‡’
   \begin{cases}  A = \frac{2}{W} \\\ B = -1 \end{cases}
   $$<p>Therefore, the first 2 rows are:</p>
$$
   \begin{bmatrix}
   2/W & 0 & -1 & 0 \\\ 
   0 & 2/H & -1 & 0 \\\ 
   â–¡ & â–¡ & â–¡ & â–¡ \\\ 
   â–¡ & â–¡ & â–¡ & â–¡ 
   \end{bmatrix}
   \begin{bmatrix} fâ‚“x + câ‚“ z \\\ f_y y + c_y z \\\ z \\\ 1 \end{bmatrix}
   $$</li>
<li>
<p>Scaling frustum $z âˆˆ [n, f]$ to [-1,1]</p>
<p>z is independent to x and y, so the 3rd row only has 2 unknows: 0 0 A B.</p>
<p>Scaling first, then perspective division, thereby the z in <strong>NDC space</strong> is:
$\frac{A z + B}{z} âˆˆ [-1, 1]$</p>
<p>Substituting z = n and f:</p>
$$
   \begin{cases}
   \frac{A n + B}{n} = -1 \\\  \frac{A f + B}{f} = 1
   \end{cases} â‡’
   \begin{cases} A = \frac{f+n}{f-n} \\\  B = \frac{-2fn}{f-n} \end{cases}
   $$<p>Finally, since the denominators are z (i.e., the w of a point&rsquo;s clip coordinates is z), the 4th row is 0 0 1 0:</p>
$$
   \begin{bmatrix}
   2/W & 0 & -1 & 0 \\\ 
   0 & 2/H & -1 & 0 \\\ 
   0 & 0 & \frac{f+n}{f-n} & \frac{-2fn}{f-n} \\\ 
   0 & 0 & 1 & 0 
   \end{bmatrix}
   \begin{bmatrix}
   fâ‚“x + câ‚“ z \\\ f_y y + c_y z \\\ z \\\ 1
   \end{bmatrix} = 
   \begin{bmatrix}
   \frac{2 (fâ‚“x + câ‚“ z)}{W} - z \\\
   \frac{2 (f_y y + c_y z) }{H} - z \\\
   \frac{f+n}{f-n} z - \frac{2fn}{f-n} \\\
   z
   \end{bmatrix}
   $$<p>The result coordinates are in the <strong>clip space</strong>, which will become ND coordinates after perspective division,
and only points within the cube of [-1,1] in NDC space will be rendered.</p>
<p>(2024-07-09)</p>
<ul>
<li>
<p>ç›¸æœºç³»ä¸‹ç‚¹çš„åæ ‡ä¹˜ä»¥ä¸‹é¢é‚£ä¸ª Projection çŸ©é˜µï¼Œä½†è¿˜æ²¡åšé€è§†é™¤æ³•ï¼Œè¿™æ—¶ z æ–¹å‘çš„å–å€¼èŒƒå›´æ˜¯ <del>[-z, z]</del>ï¼Œä¹Ÿå°±æ˜¯ clip space åæ ‡ç³»ã€‚</p>
<p>(2024-07-21)</p>
<ul>
<li>After projection matrix, the range of depth in the clip space is $[\frac{f+n}{f-n} n - \frac{2fn}{f-n}, \frac{f+n}{f-n} f - \frac{2fn}{f-n}]$.</li>
</ul>
<p>In the clip space, those points whose x and y are larger than their z (or smaller than -z), will be filtered out.</p>
<p>Clipping åšå®Œä¹‹åï¼Œå†åšé€è§†é™¤æ³•ï¼Œè¿™æ ·3ä¸ªæ–¹å‘çš„åæ ‡èŒƒå›´å°±éƒ½æ˜¯ [-1,1] äº†ï¼Œä¹Ÿå°±æ˜¯ ND åæ ‡ç³»äº†ã€‚</p>
</li>
</ul>
</li>
</ol>
<p>In summary, the <strong>Projection Matrix</strong> (<code>GL_PROJECTION</code>) transforming camera-space (x,y,z)áµ€ to clip coordinates is:  <p id="ndc-matrix"></p></p>
$$
P =
\begin{bmatrix}
\frac{2}{W} & 0 & -1 & 0 \\\ 
0 & \frac{2}{H} & -1 & 0 \\\ 
0 & 0 & \frac{f+n}{f-n} & \frac{-2fn}{f-n} \\\ 
0 & 0 & 1 & 0 
\end{bmatrix}
\begin{bmatrix}
fâ‚“ & 0   & câ‚“  & 0 \\\
0  & f_y & c_y & 0 \\\
0  & 0   & 1   & 0 \\\
0  & 0   & 0   & 1
\end{bmatrix} = 
\begin{bmatrix}
\frac{2fâ‚“}{W} & 0 & (\frac{2câ‚“}{W}) -1 & 0 \\\
0 & \frac{2f_y}{H} & (\frac{2c_y}{H}) -1 & 0 \\\
0 & 0 & \frac{f+n}{f-n} & \frac{-2fn}{f-n} \\\ 
0 & 0 & 1 & 0 
\end{bmatrix}
$$<ul>
<li>
<p>When cx and cy are W/2 and H/2, it&rsquo;s in the form of <a class="link" href="https://arxiv.org/abs/2312.02121"  target="_blank" rel="noopener"
    >Ye&rsquo;s article</a>.</p>
</li>
<li>
<p>When cx and cy are r and t, it&rsquo;s in the form of <a class="link" href="https://www.songho.ca/opengl/gl_projectionmatrix.html"  target="_blank" rel="noopener"
    >songho</a>.</p>
</li>
</ul>
<p>(2025-05-15T23:16)</p>
<ul>
<li>
<p>é€è§†é™¤æ³•ä¹‹åçš„ x,y,z æ‰æ˜¯ [-1,1]ï¼Œå³ NDC åæ ‡ï¼Œæ²¡æœ‰åšé€è§†é™¤æ³•ä¹‹å‰æ˜¯ Clip åæ ‡</p>
<ol>
<li>
<p>Projection Matrix ä½œç”¨åœ¨ç‚¹åœ¨ Camera space ä¸‹çš„åæ ‡ä¸Šï¼Œå¾—åˆ° Clip åæ ‡</p>
</li>
<li>
<p>Clip åæ ‡å†åšé€è§†é™¤æ³•æ‰æ˜¯ NDC åæ ‡ï¼Œ NDC åæ ‡çš„å–å€¼èŒƒå›´éœ€è¦æ˜¯ [-1,1]</p>
</li>
<li>
<p>å› ä¸º NDC åæ ‡æ˜¯é€šè¿‡é™¤ä»¥ $Z_{Cam}$ å¾—æ¥ï¼Œæ‰€ä»¥ $Z_{Cam}$ å°±å†³å®šäº†ä¸€ä¸ªç‚¹æ˜¯å¦ä½äº ND ç©ºé—´å†…ï¼ˆè¢«æ¸²æŸ“ï¼‰</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 472 57"
      >
      <g transform='translate(8,16)'>
<path d='M 0,32 L 184,32' fill='none' stroke='currentColor'></path>
<path d='M 184,32 L 280,32' fill='none' stroke='currentColor'></path>
<path d='M 280,32 L 456,32' fill='none' stroke='currentColor'></path>
<path d='M 184,16 L 184,32' fill='none' stroke='currentColor'></path>
<path d='M 280,16 L 280,32' fill='none' stroke='currentColor'></path>
<circle cx='184' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='280' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='8' y='4' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='16' y='4' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='24' y='4' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='32' y='4' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='40' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='48' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='56' y='4' fill='currentColor' style='font-size:1em'>/</text>
<text text-anchor='middle' x='64' y='4' fill='currentColor' style='font-size:1em'>z</text>
<text text-anchor='middle' x='72' y='4' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='80' y='4' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='88' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='96' y='4' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='112' y='4' fill='currentColor' style='font-size:1em'>&lt;</text>
<text text-anchor='middle' x='128' y='4' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='136' y='4' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='176' y='4' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='184' y='4' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='280' y='4' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='320' y='4' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='328' y='4' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='336' y='4' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='344' y='4' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='352' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='360' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='368' y='4' fill='currentColor' style='font-size:1em'>/</text>
<text text-anchor='middle' x='376' y='4' fill='currentColor' style='font-size:1em'>z</text>
<text text-anchor='middle' x='384' y='4' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='392' y='4' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='400' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='408' y='4' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='424' y='4' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='440' y='4' fill='currentColor' style='font-size:1em'>1</text>
</g>

    </svg>
  
</div>
</li>
</ol>
</li>
</ul>
<hr>
<p>(2024-01-02)</p>
<h3 id="project-mean-vector-ğ›">Project mean vector ğ›
</h3><p><a href="https://youtu.be/-ymmkfjMIeI" id="ogldev"><img src="/post/writenotes/model/splats/b-note-3dgs-math/Frustum_Culling_Terrain_Rendering_episode_9_4-33.jpg"
	width="1000"
	height="563"
	
	loading="lazy"
	
		alt="img"
	
	
		class="gallery-image" 
		data-flex-grow="177"
		data-flex-basis="426px"
	
></a></p>
<p>A mean vector ğ› in world space is changed to pixel space as follows:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 528 137"
      >
      <g transform='translate(8,16)'>
<path d='M 48,64 L 96,64' fill='none' stroke='currentColor'></path>
<path d='M 176,64 L 224,64' fill='none' stroke='currentColor'></path>
<path d='M 312,64 L 384,64' fill='none' stroke='currentColor'></path>
<path d='M 448,64 L 464,64' fill='none' stroke='currentColor'></path>
<polygon points='104.000000,64.000000 92.000000,58.400002 92.000000,69.599998' fill='currentColor' transform='rotate(0.000000, 96.000000, 64.000000)'></polygon>
<polygon points='232.000000,64.000000 220.000000,58.400002 220.000000,69.599998' fill='currentColor' transform='rotate(0.000000, 224.000000, 64.000000)'></polygon>
<polygon points='392.000000,64.000000 380.000000,58.400002 380.000000,69.599998' fill='currentColor' transform='rotate(0.000000, 384.000000, 64.000000)'></polygon>
<polygon points='472.000000,64.000000 460.000000,58.400002 460.000000,69.599998' fill='currentColor' transform='rotate(0.000000, 464.000000, 64.000000)'></polygon>
<text text-anchor='middle' x='0' y='52' fill='currentColor' style='font-size:1em'>W</text>
<text text-anchor='middle' x='0' y='68' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='8' y='52' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='8' y='68' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='8' y='84' fill='currentColor' style='font-size:1em'>ğ›</text>
<text text-anchor='middle' x='16' y='52' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='16' y='68' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='24' y='52' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='24' y='68' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='32' y='52' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='32' y='68' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='56' y='20' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='56' y='36' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='64' y='4' fill='currentColor' style='font-size:1em'>ğ“</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='64' y='36' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='72' y='36' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='80' y='20' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='80' y='36' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='88' y='36' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='96' y='36' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='112' y='52' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='112' y='68' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='120' y='52' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='120' y='68' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='128' y='52' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='128' y='68' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='128' y='84' fill='currentColor' style='font-size:1em'>ğ­</text>
<text text-anchor='middle' x='136' y='52' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='136' y='68' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='144' y='52' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='144' y='68' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='152' y='52' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>P</text>
<text text-anchor='middle' x='168' y='36' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='176' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='184' y='36' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='192' y='4' fill='currentColor' style='font-size:1em'>ğ</text>
<text text-anchor='middle' x='192' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='192' y='36' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='200' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='200' y='36' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='208' y='36' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='216' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='216' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='224' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='224' y='36' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='232' y='36' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='240' y='20' fill='currentColor' style='font-size:1em'>j</text>
<text text-anchor='middle' x='256' y='52' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='256' y='68' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='264' y='52' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='264' y='68' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='272' y='52' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='272' y='68' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='272' y='84' fill='currentColor' style='font-size:1em'>ğ­</text>
<text text-anchor='middle' x='280' y='52' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='280' y='68' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='280' y='84' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='288' y='68' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='288' y='100' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='296' y='100' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='304' y='20' fill='currentColor' style='font-size:1em'>P</text>
<text text-anchor='middle' x='304' y='84' fill='currentColor' style='font-size:1em'>â†‘</text>
<text text-anchor='middle' x='304' y='100' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='312' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='312' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='312' y='100' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='320' y='4' fill='currentColor' style='font-size:1em'>Ï•</text>
<text text-anchor='middle' x='320' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='320' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='320' y='100' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='320' y='116' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='328' y='4' fill='currentColor' style='font-size:1em'>â‚–</text>
<text text-anchor='middle' x='328' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='328' y='36' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='328' y='100' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='328' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='336' y='4' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='336' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='336' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='336' y='100' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='336' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='344' y='4' fill='currentColor' style='font-size:1em'>ğ­</text>
<text text-anchor='middle' x='344' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='344' y='36' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='344' y='100' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='344' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='352' y='4' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='352' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='352' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='352' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='360' y='4' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='360' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='360' y='36' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='360' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='368' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='368' y='36' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='368' y='100' fill='currentColor' style='font-size:1em'>â†’</text>
<text text-anchor='middle' x='368' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='376' y='20' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='376' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='384' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='392' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='400' y='52' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='400' y='68' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='400' y='100' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='400' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='408' y='52' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='408' y='68' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='408' y='100' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='408' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='416' y='52' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='416' y='68' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='416' y='100' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='424' y='68' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='424' y='100' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='432' y='68' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='432' y='100' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='440' y='20' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='440' y='100' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='448' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='456' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='464' y='20' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='472' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='480' y='52' fill='currentColor' style='font-size:1em'>P</text>
<text text-anchor='middle' x='480' y='68' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='488' y='52' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='488' y='68' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='488' y='84' fill='currentColor' style='font-size:1em'>ğ›</text>
<text text-anchor='middle' x='496' y='52' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='496' y='68' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='496' y='84' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='504' y='52' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='504' y='68' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='512' y='52' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='512' y='68' fill='currentColor' style='font-size:1em'>d</text>
</g>

    </svg>
  
</div>
<ul>
<li>
<p>ğ­ refers to coordinates of ğ› in the <strong>camera space</strong> as:</p>
$$
  ğ­ = \begin{bmatrix} ğ‘_{w2c} & ğ­_{w2c} \\\ 0 & 1  \end{bmatrix} \begin{bmatrix} \bm Î¼ \\\ 1 \end{bmatrix}
  $$<ul>
<li>
<p>Note the translation vector is denoted as $ğ­_{w2c}$.</p>
</li>
<li>
<p>And the extrinsics is represented as $ğ“_{w2c}$.</p>
</li>
<li>
<p>The clip coordinates of ğ› is $ğ­' = ğğ­$</p>
</li>
<li>
<p>The nonlinear perspective division is approximated by the <strong>projective transformation</strong> $Ï•â‚–(ğ­')$.</p>
</li>
</ul>
</li>
</ul>
<ol>
<li>
<p>Points&rsquo; <strong>coordinates</strong> conversion from world space to <strong>clip</strong> space:</p>
$$
   \begin{aligned}
   ğ­' &= ğâ‹… ğ“_{w2c}â‹… [^ğ›_1] \\\
   &=\begin{bmatrix}
   \frac{2fâ‚“}{W} & 0 & (2câ‚“/W) -1 & 0 \\\
   0 & \frac{2f_y}{H} & (2c_y/H) -1 & 0 \\\
   0 & 0 & \frac{f+n}{f-n} & \frac{-2fn}{f-n} \\\ 
   0 & 0 & 1 & 0   \end{bmatrix}
   \begin{bmatrix} R_{w2c} & t_{w2c} \\\ 0 & 1  \end{bmatrix}
   \begin{bmatrix} Î¼â‚“ \\\ Î¼_y \\\ Î¼_z \\\ 1      \end{bmatrix} =
   \begin{bmatrix} tâ‚“' \\\ t_y' \\\ t_z' \\\ t_w' \end{bmatrix}
   \end{aligned}
   $$<ul>
<li>$t_w'$ is the point&rsquo;s camera-space depth $t_z$, which is &gt; 0.</li>
</ul>
</li>
<li>
<p>Frustum clipping (clip-space culling) <strong>filters</strong> points that won&rsquo;t appear in the <strong>frustum</strong>
based on <strong>clip coordinates</strong> before perspective division:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 504 281"
      >
      <g transform='translate(8,16)'>
<path d='M 24,80 L 64,80' fill='none' stroke='currentColor'></path>
<path d='M 64,80 L 80,80' fill='none' stroke='currentColor'></path>
<path d='M 80,80 L 96,80' fill='none' stroke='currentColor'></path>
<path d='M 96,80 L 112,80' fill='none' stroke='currentColor'></path>
<path d='M 64,160 L 96,160' fill='none' stroke='currentColor'></path>
<path d='M 96,160 L 128,160' fill='none' stroke='currentColor'></path>
<path d='M 128,160 L 152,160' fill='none' stroke='currentColor'></path>
<path d='M 64,240 L 152,240' fill='none' stroke='currentColor'></path>
<path d='M 24,80 L 24,160' fill='none' stroke='currentColor'></path>
<path d='M 40,128 L 40,160' fill='none' stroke='currentColor'></path>
<path d='M 56,160 L 56,192' fill='none' stroke='currentColor'></path>
<path d='M 64,160 L 64,240' fill='none' stroke='currentColor'></path>
<path d='M 80,48 L 80,80' fill='none' stroke='currentColor'></path>
<path d='M 80,80 L 80,128' fill='none' stroke='currentColor'></path>
<path d='M 128,144 L 128,160' fill='none' stroke='currentColor'></path>
<path d='M 128,160 L 128,224' fill='none' stroke='currentColor'></path>
<path d='M 152,160 L 152,240' fill='none' stroke='currentColor'></path>
<path d='M 176,16 L 176,32' fill='none' stroke='currentColor'></path>
<path d='M 176,64 L 176,80' fill='none' stroke='currentColor'></path>
<path d='M 40,128 L 64,80' fill='none' stroke='currentColor'></path>
<path d='M 64,80 L 80,48' fill='none' stroke='currentColor'></path>
<path d='M 24,160 L 64,240' fill='none' stroke='currentColor'></path>
<path d='M 40,160 L 56,192' fill='none' stroke='currentColor'></path>
<path d='M 40,128 L 56,160' fill='none' stroke='currentColor'></path>
<path d='M 24,80 L 64,160' fill='none' stroke='currentColor'></path>
<path d='M 80,128 L 96,160' fill='none' stroke='currentColor'></path>
<path d='M 96,160 L 128,224' fill='none' stroke='currentColor'></path>
<path d='M 80,48 L 96,80' fill='none' stroke='currentColor'></path>
<path d='M 96,80 L 128,144' fill='none' stroke='currentColor'></path>
<path d='M 112,80 L 152,160' fill='none' stroke='currentColor'></path>
<polygon points='184.000000,16.000000 172.000000,10.400000 172.000000,21.600000' fill='currentColor' transform='rotate(270.000000, 176.000000, 16.000000)'></polygon>
<polygon points='184.000000,64.000000 172.000000,58.400002 172.000000,69.599998' fill='currentColor' transform='rotate(270.000000, 176.000000, 64.000000)'></polygon>
<circle cx='80' cy='176' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='272' cy='128' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='0' y='212' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='0' y='260' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='8' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='8' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='8' y='196' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='8' y='212' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='8' y='260' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='16' y='68' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='16' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='16' y='196' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='16' y='212' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='16' y='260' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='24' y='180' fill='currentColor' style='font-size:1em'>â‹…</text>
<text text-anchor='middle' x='24' y='196' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='24' y='212' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='24' y='260' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='32' y='116' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='32' y='212' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='32' y='260' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='40' y='212' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='40' y='260' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='48' y='260' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='56' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='56' y='260' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='64' y='36' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='64' y='260' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='72' y='36' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='80' y='36' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='80' y='212' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='80' y='228' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='80' y='260' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='88' y='212' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='88' y='228' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='88' y='260' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='96' y='228' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='96' y='260' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='104' y='228' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='104' y='260' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='112' y='68' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='112' y='260' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='120' y='260' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='136' y='4' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='136' y='52' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='136' y='100' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='136' y='260' fill='currentColor' style='font-size:1em'>â”</text>
<text text-anchor='middle' x='144' y='4' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='144' y='52' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='144' y='100' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='152' y='52' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='152' y='100' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='152' y='260' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='160' y='4' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='160' y='52' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='160' y='100' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='160' y='260' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='168' y='4' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='168' y='100' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='176' y='4' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='176' y='52' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='176' y='100' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='176' y='260' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='184' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='184' y='52' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='184' y='260' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='192' y='4' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='192' y='52' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='192' y='100' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='192' y='260' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='200' y='4' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='200' y='36' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='200' y='52' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='200' y='84' fill='currentColor' style='font-size:1em'>P</text>
<text text-anchor='middle' x='200' y='100' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='200' y='260' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='208' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='208' y='52' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='208' y='84' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='208' y='100' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='208' y='260' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='216' y='4' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='216' y='36' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='216' y='52' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='216' y='84' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='216' y='100' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='216' y='260' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='224' y='4' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='224' y='84' fill='currentColor' style='font-size:1em'>j</text>
<text text-anchor='middle' x='224' y='100' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='224' y='260' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='232' y='4' fill='currentColor' style='font-size:1em'>â‚™</text>
<text text-anchor='middle' x='232' y='36' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='232' y='52' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='232' y='100' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='232' y='260' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='240' y='4' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='240' y='36' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='240' y='52' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='240' y='84' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='240' y='260' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='248' y='52' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='248' y='100' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='248' y='260' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='256' y='4' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='256' y='36' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='256' y='52' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='256' y='84' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='256' y='100' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='256' y='164' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='256' y='260' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='264' y='4' fill='currentColor' style='font-size:1em'>â‚™</text>
<text text-anchor='middle' x='264' y='36' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='264' y='52' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='264' y='84' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='264' y='100' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='264' y='148' fill='currentColor' style='font-size:1em'>z</text>
<text text-anchor='middle' x='264' y='164' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='272' y='4' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='272' y='36' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='272' y='84' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='272' y='100' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='272' y='148' fill='currentColor' style='font-size:1em'>â‚™</text>
<text text-anchor='middle' x='272' y='164' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='280' y='52' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='280' y='84' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='280' y='100' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='280' y='148' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='288' y='4' fill='currentColor' style='font-size:1em'>z</text>
<text text-anchor='middle' x='288' y='52' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='288' y='84' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='288' y='100' fill='currentColor' style='font-size:1em'>z</text>
<text text-anchor='middle' x='288' y='132' fill='currentColor' style='font-size:1em'>âŒ</text>
<text text-anchor='middle' x='288' y='148' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='288' y='164' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='296' y='4' fill='currentColor' style='font-size:1em'>â‚™</text>
<text text-anchor='middle' x='296' y='52' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='296' y='100' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='296' y='164' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='304' y='4' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='304' y='52' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='304' y='100' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='312' y='100' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='312' y='164' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='320' y='4' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='320' y='52' fill='currentColor' style='font-size:1em'>z</text>
<text text-anchor='middle' x='320' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='328' y='4' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='328' y='52' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='328' y='100' fill='currentColor' style='font-size:1em'>âˆˆ</text>
<text text-anchor='middle' x='328' y='164' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='336' y='4' fill='currentColor' style='font-size:1em'>âˆˆ</text>
<text text-anchor='middle' x='336' y='52' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='336' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='344' y='4' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='344' y='52' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='344' y='100' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='344' y='164' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='352' y='4' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='352' y='100' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='352' y='164' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='360' y='4' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='360' y='52' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='360' y='100' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='360' y='164' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='368' y='52' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='376' y='4' fill='currentColor' style='font-size:1em'>âˆ</text>
<text text-anchor='middle' x='376' y='52' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='376' y='100' fill='currentColor' style='font-size:1em'>âˆ</text>
<text text-anchor='middle' x='384' y='4' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='384' y='52' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='384' y='100' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='392' y='4' fill='currentColor' style='font-size:1em'>â†’</text>
<text text-anchor='middle' x='392' y='52' fill='currentColor' style='font-size:1em'>âˆˆ</text>
<text text-anchor='middle' x='400' y='4' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='400' y='52' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='408' y='4' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='408' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='416' y='4' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='416' y='20' fill='currentColor' style='font-size:1em'>â†‘</text>
<text text-anchor='middle' x='416' y='36' fill='currentColor' style='font-size:1em'>â†‘</text>
<text text-anchor='middle' x='416' y='52' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='424' y='4' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='424' y='36' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='432' y='4' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='432' y='20' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='432' y='36' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='432' y='52' fill='currentColor' style='font-size:1em'>âˆ</text>
<text text-anchor='middle' x='440' y='4' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='440' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='440' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='440' y='52' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='448' y='20' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='448' y='36' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='456' y='36' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='464' y='20' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='464' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='472' y='36' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='480' y='36' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='488' y='36' fill='currentColor' style='font-size:1em'>â—</text>
</g>

    </svg>
  
</div>
<p><a class="link" href="https://www.cs.utexas.edu/~fussell/courses/cs354-fall2015/lectures/lecture9.pdf"  target="_blank" rel="noopener"
    >View Frustum Clipping - UofTexas - Lec9</a></p>
<ul>
<li>
<p>View frustum clipping aims to reduce computation.
Essentially, it filters points by <strong>comparing</strong> the clip coordinate $w_c$ with $x_c, y_c, z_c$ for <strong>each</strong> point.</p>
</li>
<li>
<p>In the previous derivation, clip coordinates are the <strong>scaled</strong> projection coordinates: (A*ProjCoord+B).
<strong>NDC space is defined by</strong> $w$, as
the NDC cube is constrained by bounds where the clip coordinates <strong>divided by</strong> ğ‘¤ equals 1 (ğ‘¤ is the benchmark),
such as $\frac{A (f_x x+c_x z) + Bz}{w} = 1$</p>
<p>In other words, the NDC planes <strong>wrap</strong> around points whose clip coordinates $x_c,y_c,z_c$ <strong>less than or equal to</strong> $w_c$.
In addition, $w_c$ <strong>must be</strong> the camera-space depth z for the final perspective division.
Thus, if the clip coordinate of a point is <strong>bigger than w</strong> or less than $-w$,
the &ldquo;quotient&rdquo; will be outside of [-1,1], i.e., the point is not located in the camera-space view frustum or the NDC-space cube.</p>
<p>Frustum clipping retains points that satisfy: $-w_c \leq x_c, y_c, z_c \leq w_c$.
Conversely, those points whose w (equals camera-space depth) is smaller than x,y,z will be filtered out.</p>
<p>Although ND Coordinates are <strong>also</strong> able to identify points for clipping,
to reduce the number of perspective divisions (executed at final), clipping is performed in the clip space for <strong>efficiency</strong>.</p>
</li>
<li>
<p>On the other hand, since the <strong>ND Coordinates</strong> of the Left, Right, Bottom, Top, Near, and Far <strong>frustum planes</strong> are -1 and 1,
the <strong>clip</strong> coordinates of points located within the <strong>Frustum</strong> satisfy the relation:
$-1 < \frac{x_c}{w_c}, \frac{y_c}{w_c}, \frac{z_c}{w_c} <1$</p>
</li>
<li>
<p>Consequently, only points in the frustum (i.e., NDC-space cube: $-1 < xâ‚™, yâ‚™, zâ‚™ < 1$) are survived.</p>
</li>
</ul>
<p>(2024-01-03)</p>
<ul>
<li>It is the view frustum <strong>clipping</strong> that makes ND coordinates can be regarded as a <strong>cube space</strong>,
because out-of-the-cube points have been disregared.</li>
</ul>
<p>(2024-06-22)</p>
<ul>
<li>Can I use the mnemonic: If the z-coord of a point is <strong>larger</strong> than its x,y, it will be killed?
(I should refer that <a class="link" href="#ogldev" >video</a> to see the code.)</li>
</ul>
</li>
<li>
<p>Performing <strong>perspective division</strong> on the clip coordinates resulting in NDC, whose all components ranges in [-1,1]:</p>
$$ NDC = 
   \begin{bmatrix}
   tâ‚“'/t_w' \\\ t_y'/t_w' \\\ t_z'/t_w' \\\ 1
   \end{bmatrix} âˆˆ [-1,1] $$<ul>
<li>(2024-02-08) NDC is 3D, including zâ‚™ coord besides the 2D pixel coords.</li>
</ul>
</li>
<li>
<p>Scaling NDC to obtain pixel coordinates ğ›&rsquo; (viewport transformation):
<a class="link" href="https://www.songho.ca/opengl/gl_transform.html#wincoord"  target="_blank" rel="noopener"
    >songho</a></p>
$$
   [-1, 1] \overset{Ã—W}{â†’} [-W, W] \overset{+1}{â†’} [-W+1,W+1] 
   \overset{Ã·2}{â†’} [\frac{-W+1}{2}, \frac{W+1}{2}] \\\
   \overset{+c_x}{â†’}  [0.5, W+0.5] (\text{ if $c_x =\frac{W}{2}$})
   $$<p>Therefore, the final pixel coordinate ğ›&rsquo; of a world-space mean vector ğ› is:  <p id="mu-pix"></p></p>
$$ \bm \mu' = 
   \begin{bmatrix}
   (Wâ‹…tâ‚“'/t_w' + 1) /2 + c_x \\\  (Hâ‹…t_y'/t_w' + 1) / 2 + c_y
   \end{bmatrix} $$</li>
</ol>
<hr>
<h3 id="project-covariance">Project Covariance
</h3><p>(2024-01-03)</p>
<ol>
<li>
<p>Because the perspective projection is <strong>not a linear operation</strong> due to division, the 2D projection of a 3D Gaussian is <strong>not a 2D Gaussian</strong>:</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th><img src="https://thumbs.dreamstime.com/z/snowball-throw-snow-ball-throwing-icon-as-floating-thrown-frozen-winter-ice-crystal-sphere-object-white-background-78174619.jpg?ct=jpeg" width="30%"></th>
          <th><img src="https://image.shutterstock.com/image-photo/spotlight-on-blackboard-260nw-73578277.jpg"></th>
          <th><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0f/Conic_section_with_torch_light.svg/330px-Conic_section_with_torch_light.svg.png" ></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>snowball splat diffuse</td>
          <td>Is it a 2D Gaussian?</td>
          <td><a class="link" href="https://en.wikipedia.org/wiki/Conic_section"  target="_blank" rel="noopener"
    >Conic sections</a></td>
      </tr>
  </tbody>
</table></div>
</li>
<li>
<p><em>EWA Splatting</em> <strong>doesn&rsquo;t scale</strong> the projected coordinates to the [-1,1] NDC-space cube.
It directly transforms points from camera space onto screen (or viewing-ray space) by dividing z.
The result coordinates range in [0,W] and [0,H].</p>
</li>
<li>
<p>Projective transformation Ï•(ğ­) in <strong>EWA Splatting</strong>:
Converting an <strong>arbitrary</strong> point&rsquo;s camera-space coordinates $ğ­=(tâ‚“,t_y,t_z)áµ€$ to the coordinates in <strong>3D ray space</strong>
(pixel coordinates x0,x1 + &ldquo;new depth&rdquo; x2) has 2 steps:</p>
<ul>
<li>Pixel coords = perspective projection + perspective division.</li>
<li>The new depth is set to the L2 norm of the point&rsquo;s camera-space coordinates.</li>
</ul>
$$
   Ï•(ğ­) = \begin{bmatrix} \frac{fâ‚“ tâ‚“}{t_z} + câ‚“ \\\ \frac{f_y t_y}{t_z} + c_y \\\ \sqrt{t_x^2 + t_y^2 + t_z^2} \end{bmatrix} =
   \begin{bmatrix} x_0 \\\ x_1 \\\ x_2 \end{bmatrix}
   $$<p>Because <a class="link" href="https://zichen34.github.io/writenotes/model/splat/b-note-ewa_splatting/#projective-transformation-%CF%95"  target="_blank" rel="noopener"
    >EWA Splatting</a> doesn&rsquo;t consider frustum clipping, the approximation is based on the camera coordinates ğ­.</p>
<ul>
<li>
<p>(2024-02-16) The clip coordinates shouldn&rsquo;t be used in EWA splatting because the Gaussian center is used in the Jacobian that
approximates the perspective projection, where the camera-space coordinates are supposed to be used.</p>
<p>Whereas, 3DGS (or gsplat) requires to determine whether the point (Gaussian center) is in the frustrum to be rendered,
the clip coordinates are utilized for frustum clipping.
Therefore, the world coordinates ğ± are involved into 2 procedures:
the covertion for covariance matrix from world space to ray space (ğ‰ğ–ğšºğ–áµ€ğ‰áµ€),
and the projection for Gaussian center from world space onto the screen.</p>
<p>Consequently, the derivative of Loss w.r.t. the world coordinates ($\frac{âˆ‚L}{âˆ‚ğ±}$) has 2 portions.</p>
</li>
</ul>
<p>However, <code>gsplat</code> uses the <strong>clip space</strong> to filter points outside the camera frustum.
So, after perspective projection and scaling for NDC with matrix ğ, points are transferred into clip space as ğ­&rsquo; for clipping.</p>
<p>After clipping, the nonlinear perspective <strong>division</strong> and xâ‚‚ reassignment in Ï•(ğ­),
are approximated with an affine transformation based on the <strong>clip coordinates</strong> ğ­&rsquo;.
Therefore, the projective transformation $Ï•(ğ­)$ that maps camera space to ray space becomes a mapping from clip space to the ray space $Ï•(ğ­')$.</p>
$$
   \begin{aligned}
   ğ­ &â†’ ğ­'=ğğ­ = 
   \begin{bmatrix}
   \frac{2 (fâ‚“ t_x + câ‚“ t_z)}{W} - t_z \\\
   \frac{2 (f_y t_y + c_y t_z) }{H} - t_z \\\
   \frac{f+n}{f-n} z - \frac{2fn}{f-n} \\\
   t_z
   \end{bmatrix}
   = \begin{bmatrix}t_x' \\\ t_y' \\\ t_z' \\\ t_z\end{bmatrix} 
   \\\
   &â†’ Ï•(ğ­') = 
   \begin{bmatrix} tâ‚“'/t_z' \\\ 
   t_y'/t_z' \\\ â€–ğ­'â€–â‚‚ \end{bmatrix} 
   = \begin{bmatrix} x_0 \\\ x_1 \\\ x_2 \end{bmatrix}
   \end{aligned}
   $$<p>The affine approximation is the first 2 terms of $Ï•(ğ­')$&rsquo;s Taylor expansion evaluated at a Gaussian&rsquo;s mean vector
$ğ­â‚–' = (t_{k,x}', t_{k,y}', t_{k,z}')áµ€$ in the <strong>clip space</strong>:</p>
$$
   \begin{aligned}
   & Ï•(ğ­') â‰ˆ Ï•â‚–(ğ­') = Ï•(ğ­â‚–') + ğ‰_{ğ­â‚–'} â‹… (ğ­' - ğ­â‚–') \\\
   & =
     \begin{bmatrix}
     t_{k,x}'/t_{k,z}' \\\ 
     t_{k,y}'/t_{k,z}' \\\
     â€–ğ­â‚–'â€–Â²
     \end{bmatrix} + 
   \begin{bmatrix} 1/t_{k,z}' & 0 & -t_{k,x}/{t_{k,z}'}^2 \\\
   0 & 1/t_{k,z}' & -t_{k,y}/{t_{k,z}'}^2 \\\
   t_{k,x}'/â€–ğ­â‚–'â€–â‚‚ & t_{k,y}'/â€–ğ­â‚–'â€–â‚‚ & t_{k,z}'/â€–ğ­â‚–'â€–â‚‚
   \end{bmatrix}
   (ğ­' - ğ­â‚–')
   \end{aligned}
   $$<hr>
<p>If using the <strong>camera-space</strong> coordinates ğ­ to express the projective transformation as Ï•(ğ­), focal lengths will be exposed:</p>
$$
   \begin{aligned}
   Ï•(ğ­) â‰ˆ Ï•â‚–(ğ­) &= Ï•(ğ­â‚–)+ ğ‰_{ğ­â‚–} â‹… (ğ­ - ğ­â‚–) \\\
   &=\begin{bmatrix} 
   2(fâ‚“ t_{k,x}/t_{k,z} + câ‚“)/W -1 \\\ 
   2(f_y t_{k,y}/t_{k,z} + c_y)/H -1 \\\ 
   â€–ğ­â‚–â€–â‚‚ 
   \end{bmatrix} + 
   ğ‰_{ğ­â‚–} â‹… (ğ­ - ğ­â‚–)
   \end{aligned}
   $$<p>If $c_x=W/2,\ c_y=H/2$, then $Ï•â‚–(ğ­) = 
   \begin{bmatrix} \frac{2f_x t_{k,x}}{Wâ‹… t_{k,z}} \\\ \frac{2f_y t_{k,y}}{Hâ‹… t_{k,z}} \\\ â€–ğ­â‚–â€–â‚‚ \end{bmatrix}$</p>
<p>and the Jacobian $ğ‰_{ğ­â‚–}$ will be:</p>
$$
   ğ‰_{ğ­â‚–} = \begin{bmatrix}
   (2/W)â‹…fâ‚“/t_{k,z} & 0 & (2/W)â‹…-fâ‚“ t_{k,x} / {t_{k,z}}^2  \\\
   0  & (2/H)â‹…f_y/t_{k,z} & (2/H)â‹…-f_y t_{k,y} / {t_{k,z}}^2  \\\
   t_{k,x}/â€–ğ­â‚–â€–â‚‚ & t_{k,y}/â€–ğ­â‚–â€–â‚‚ & t_{k,z}/â€–ğ­â‚–â€–â‚‚
   \end{bmatrix}
   $$<ul>
<li>
<p>If the camera-film coords xâˆˆ[0,W] and yâˆˆ[0,H] are not scaled to [-1,1], the scaling factors 2/W and 2/H won&rsquo;t exist.</p>
<p>Thus, the Jacobian evaluated at center ğ­â‚– in the camera space is:</p>
$$
     ğ‰_{ğ­â‚–} = \begin{bmatrix}
     fâ‚“/t_{k,z} & 0 & -fâ‚“ t_{k,x} / {t_{k,z}}^2  \\\
     0  & f_y/t_{k,z} & -f_y t_{k,y} / {t_{k,z}}^2  \\\
     t_{k,x}/â€–ğ­â‚–â€–â‚‚ & t_{k,y}/â€–ğ­â‚–â€–â‚‚ & t_{k,z}/â€–ğ­â‚–â€–â‚‚
     \end{bmatrix}
     $$</li>
<li>
<p>By expressing the projective transformation Ï•â‚–() with the camera coordinates ğ­, the relation between <strong>ray-space</strong> coordinates and <strong>camera-space</strong> coordinates is constructed.
Thereby, the derivative of Gaussian center Ï•â‚–(ğ­â‚–) in the ray space is derived from camera-space coordinates ğ­â‚–,
with the clip coordinates ğ­â‚–&rsquo; <strong>skipped</strong>.</p>
</li>
</ul>
<p><del>For the case of 2D projection, only x and y dimensions of the covariance matrix need consideration, with the 3rd row and column are omitted.</del>
Because of the affine approximation, the projective transformation Ï•(ğ­&rsquo;) becomes a <strong>linear</strong> operation.
Thereby, a 3D Gaussian after perspective division is a <strong>2D Gaussian</strong>.</p>
<ul>
<li>Figuratively, points surrounding the 3D Gaussian center in clip space will fall into an ellipse on the 2D screen.</li>
<li>In the 3DGS code, the 2D ellipse is further simplified as a circle to count the overlapped tiles.</li>
</ul>
</li>
<li>
<p>The covariance matrix ğšºâ‚–&rsquo; of the 2D Gaussian in the <strong>pixel space</strong> corresponding to the 3D Gaussian (ğšºâ‚–) in the world space
can be derived based on properties of Gaussians as:</p>
$$\bm Î£â‚–' = ğ‰â‚– ğ‘_{w2c} \bm Î£â‚– ğ‘_{w2c}áµ€ ğ‰â‚–áµ€$$</li>
<li>
<p>Because covariance matrix ğšº&rsquo; is <strong>symmetric</strong>, it can be decomposed to a stretching vector (diagonal matrix) and a rotation matrix by SVD,
<strong>analogous</strong> to describing the configurations of an ellipsoid
^<a class="link" href="https://www.cs.umd.edu/~zwicker/publications/EWASplatting-TVCG02.pdf"  target="_blank" rel="noopener"
    >3DGS</a>.
(Essentially, the covariance matrix depicts a data distribution.)</p>
<p>The rotation matrix is converted to a quaternion during optimization.</p>
</li>
</ol>
<p>In summary: A <strong>3D Gaussian</strong> (ğ›â‚–,ğšºâ‚–) in world (object) space is transformed into 3D <strong>ray space</strong> (or the screen with the 3rd dim omitted), resulting in:</p>
<ul>
<li>
<p>Mean vector: $\bm Î¼â‚–' = Ï•(ğ­â‚–')$, where $ğ­â‚–' = ğâ‹… [^{ğ‘_{w2c} \ ğ­_{w2c}}_{0 \quad\ 1}] â‹…[^{\bm Î¼â‚–}_1]$ is clip coordinates.</p>
</li>
<li>
<p>Covariance matrix: $\bm Î£â‚–' = ğ‰â‚–â‹… ğ‘_{w2c}â‹… \bm Î£â‚–â‹… ğ‘_{w2c}áµ€â‹… ğ‰â‚–áµ€$</p>
</li>
<li>
<p>A point ğ­&rsquo; in clip space within the Gaussian distribution is projected to ray space: $Ï•â‚–(ğ­') = Ï•(ğ­â‚–') + ğ‰â‚–â‹…(ğ­' - ğ­â‚–')$.
The discrepancy between the approximated and the real projected locations is $Ï•â‚–(ğ­')-Ï•(ğ­')$.</p>
</li>
</ul>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 280 153"
      >
      <g transform='translate(8,16)'>
<path d='M 120,16 L 152,16' fill='none' stroke='currentColor'></path>
<path d='M 40,64 L 88,64' fill='none' stroke='currentColor'></path>
<path d='M 184,64 L 232,64' fill='none' stroke='currentColor'></path>
<path d='M 8,80 L 8,128' fill='none' stroke='currentColor'></path>
<path d='M 32,32 L 32,80' fill='none' stroke='currentColor'></path>
<path d='M 104,32 L 104,48' fill='none' stroke='currentColor'></path>
<path d='M 168,32 L 168,48' fill='none' stroke='currentColor'></path>
<path d='M 8,80 L 32,32' fill='none' stroke='currentColor'></path>
<path d='M 8,128 L 32,80' fill='none' stroke='currentColor'></path>
<polygon points='48.000000,64.000000 36.000000,58.400002 36.000000,69.599998' fill='currentColor' transform='rotate(180.000000, 40.000000, 64.000000)'></polygon>
<path d='M 120,16 A 16,16 0 0,0 104,32' fill='none' stroke='currentColor'></path>
<path d='M 152,16 A 16,16 0 0,1 168,32' fill='none' stroke='currentColor'></path>
<path d='M 104,48 A 16,16 0 0,1 88,64' fill='none' stroke='currentColor'></path>
<path d='M 168,48 A 16,16 0 0,0 184,64' fill='none' stroke='currentColor'></path>
<text text-anchor='middle' x='0' y='20' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='8' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='16' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='24' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='24' y='68' fill='currentColor' style='font-size:1em'>â¬¯</text>
<text text-anchor='middle' x='24' y='116' fill='currentColor' style='font-size:1em'>ğ›</text>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='32' y='100' fill='currentColor' style='font-size:1em'>ğ±</text>
<text text-anchor='middle' x='32' y='116' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='40' y='116' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='48' y='116' fill='currentColor' style='font-size:1em'>ğšº</text>
<text text-anchor='middle' x='56' y='116' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='104' y='4' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='112' y='4' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='120' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='120' y='52' fill='currentColor' style='font-size:1em'>ğ›</text>
<text text-anchor='middle' x='128' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='128' y='36' fill='currentColor' style='font-size:1em'>ğ­</text>
<text text-anchor='middle' x='128' y='52' fill='currentColor' style='font-size:1em'>á¶œ</text>
<text text-anchor='middle' x='136' y='36' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='136' y='52' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='144' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='144' y='52' fill='currentColor' style='font-size:1em'>ğšº</text>
<text text-anchor='middle' x='152' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='152' y='52' fill='currentColor' style='font-size:1em'>á¶œ</text>
<text text-anchor='middle' x='160' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='168' y='4' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='176' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='224' y='20' fill='currentColor' style='font-size:1em'>O</text>
<text text-anchor='middle' x='224' y='36' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='232' y='36' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='240' y='20' fill='currentColor' style='font-size:1em'>j</text>
<text text-anchor='middle' x='240' y='36' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='248' y='36' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='248' y='68' fill='currentColor' style='font-size:1em'>â¬¯</text>
<text text-anchor='middle' x='248' y='84' fill='currentColor' style='font-size:1em'>ğ—</text>
<text text-anchor='middle' x='248' y='100' fill='currentColor' style='font-size:1em'>ğ›</text>
<text text-anchor='middle' x='256' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='256' y='36' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='256' y='100' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='264' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='264' y='100' fill='currentColor' style='font-size:1em'>ğšº</text>
</g>

    </svg>
  
</div>
<hr>
<h2 id="rasterizing">Rasterizing
</h2><h3 id="sorting-kernels">Sorting Kernels
</h3><p>(2024-01-09)</p>
<p>Sort Gaussians within each 16x16 tile based on depth</p>
<p><img src="/post/writenotes/model/splats/b-note-3dgs-math/Splat_depth_sort.jpg"
	width="918"
	height="500"
	
	loading="lazy"
	
		alt="img"
	
	
		class="gallery-image" 
		data-flex-grow="183"
		data-flex-basis="440px"
	
></p>
<ul>
<li>
<p>Every pixel has a perpendicular dot line, and the discs <strong>intersected</strong> with the line are visible to the pixel.</p>
</li>
<li>
<p>The <strong>depths</strong> of those discs are $xâ‚‚ = â€–ğ­'â€–â‚‚ = \sqrt{ {tâ‚€'}Â² + {tâ‚'}Â² + {tâ‚‚'}Â²}$,
L2 norm of the clip coordinates.</p>
</li>
<li>
<p>The disc <strong>closer</strong> to the screen is more prominent.</p>
</li>
<li>
<p>Different images are obtained given different viewing rays, as the <strong>opacities</strong> of the discs change in tandem with viewing rays.
(Specifically, the opacity of a disc is an integral for the Gaussian in the 3D ray space along a viewing ray.)</p>
<p>In contrast, volume rendering method changes point-wise <strong>colors</strong> on different viewing rays.</p>
</li>
</ul>
<p>(2024-01-22)</p>
<ul>
<li>
<p>In splatting, image formation still relies on alpha compositing.
Distinct from NeRF where a pixel-ray originates from the camera optical center,
in splatting, a pixel emits a <strong>perpendicular</strong> ray from the screen.
And it is the incoming <strong>viewing rays</strong> determine varying alpha (opacity) of the filters on the pixel-ray path.
Such that the screen displays diverse colors with various viewing rays.</p>
<p>(2024-04-20)</p>
<ul>
<li>
<p>I think the &ldquo;screen&rdquo; is indeed the <strong>camera film</strong>.
The &ldquo;viewing ray&rdquo; <strong>doesn&rsquo;t hit</strong> the screen&quot;.
The viewing ray is just required to <strong>pass through</strong> 3D Gaussians to calculate each Gaussian&rsquo;s opacity
by integrating the 3D Gaussian over the intersecting segment.</p>
<p>Rendering a pixel in the splatting method also emitting a ray from a pixel and compositing discs on the ray.
The difference is that the opacity has been precomputed by splatting procedure: integrating the viewing ray.</p>
<p>Thus, it is the screen, i.e., pixels that shoot lines.</p>
<p><img src="/post/writenotes/model/splats/b-note-3dgs-math/Splatting_and_Rendering.jpg"
	width="1380"
	height="683"
	
	loading="lazy"
	
		alt="img"
	
	
		class="gallery-image" 
		data-flex-grow="202"
		data-flex-basis="484px"
	
></p>
<p>In the implementation of 3DGS, the splatting process is omitted,
since the opacity of each Gaussian is accquired by optimizing it iteratively.</p>
<p>Splatting is just one of the ways to get the opacity.
As long as the opacities are obtained, any rendering method can be applied to form an image, e.g., rasterization, ray marching/tracing.</p>
</li>
</ul>
</li>
</ul>
<hr>
<h3 id="alpha-blending">Alpha Blending
</h3><p>(2024-01-05)</p>
<p>EWA splatting equation for N kernels existing in the space:</p>
$$
\underset{\substack{â†‘\\\ \text{Pixel}\\\ \text{color}}}{C} = 
âˆ‘_{kâˆˆN} 
\underset{\substack{â†‘\\\ \text{Kernel}\\\ \text{weight}}}{wâ‚–}â‹…
\underset{\substack{â†‘\\\ \text{Kernel} \\\ \text{color}}}{câ‚–}â‹…
\underset{\substack{â†‘\\\ \text{Accumulated} \\\ \text{transmittance}}}{oâ‚–}â‹… 
(\underset{\substack{â†‘\\\ \text{Kernel}\\\ \text{opacity}}}{qâ‚–}âŠ—
\underset{\substack{â†‘\\\ \text{Loss-pass}\\\ \text{filter}}}{h})
(\underset{\substack{â†‘\\\ \text{2D} \\\ \text{coords}}}{ğ±})
$$<p>In 3DGS, each <strong>3D</strong> Gassian in the object space has 4 <strong>learnable</strong> parameters:</p>
<ol>
<li>
<p>Color (câ‚–): SH for &ldquo;directional appearance component of the radiance field&rdquo;</p>
</li>
<li>
<p>Opacity ($qâ‚–âŠ— h$). It results in accu. transmittance oâ‚– as $âˆ_{mâ‰¤k}(1-\text{opacity}â‚˜)$.</p>
</li>
<li>
<p>Position ğ›: determines the kernel&rsquo;s weight wâ‚–, as wâ‚– is an <strong>evaluation</strong> of the projected kernel (2D Gaussian distribution) at the pixel.</p>
</li>
<li>
<p>Covariance matrix: the stretching matrix and rotaion matrix (quaternion) jointly determine wâ‚– as well.</p>
</li>
</ol>
<p>The splatting equation can be reformulated as <strong>alpha compositing</strong> used in 3DGS:</p>
$$C = âˆ‘_{nâ‰¤N} Tâ‚™â‹…Î±â‚™â‹…câ‚™, \text{ where } Tâ‚™ = âˆ_{m < n}(1-Î±â‚˜)$$<ul>
<li>
<p>Alpha can be expressed with sigma, which is an exponent of e, akin to NeRF.</p>
$$Î±â‚™ = oâ‚™ â‹… \exp(-Ïƒâ‚™), \text{where } Ïƒâ‚™ = Â½\bm Î”â‚™áµ€ \bm Î£'â»Â¹ \bm Î”â‚™$$<ul>
<li>
<p>oâ‚™ is a kernel&rsquo;s opacity, i.e., the above qâ‚–âŠ— h. And the negative exponential term is a scalar scaling factor.
Ïƒâ‚™ is Mahalanobis distance.</p>
<p>(2024-02-16)</p>
<ul>
<li>
<p>Gaussian&rsquo;s opacity oâ‚™ is fixed after splatting with a specific viewing ray,
so during alpha compositing, the variation in alpha among different Gaussian results from
the different positions of a target rendering pixel relative to various Gaussians.</p>
<p>When performing alpha compositing, the alpha of a Gaussian is the Gaussian&rsquo;s opacity scaled by the &ldquo;probability&rdquo;
for the position of the rendering pixel in the Gaussian distribution.</p>
</li>
</ul>
</li>
<li>
<p>However, the alpha value in NeRF is $Î±áµ¢ = 1- exp(-Ïƒáµ¢Î´áµ¢)$ and serves as the <strong>opacity</strong> in $âˆ‘áµ¢â‚Œâ‚á´º Táµ¢ Î±áµ¢ cáµ¢$.
Alpha is a converted point opacity ranging in [0,1].</p>
</li>
</ul>
</li>
<li>
<p>In other words, alpha $Î±â‚™$ equals a kernel&rsquo;s opacity oâ‚™ <strong>scaled</strong> by a weight Gâ‚™ (the above wâ‚–),
i.e., the <strong>evaluation</strong> of 2D Gaussian Gâ‚™ at the viewing pixel:</p>
$$Î±â‚™ = oâ‚™ â‹… Gâ‚™, \text{where } Gâ‚™ = e^{-\frac{\bm Î”â‚™áµ€ \bm Î”â‚™}{2\bm Î£'}}$$<ul>
<li>
<p>oâ‚™ is the opacity (the footprint qâ‚™) of the n-th 3D Gaussian.
In EWA splatting, the qâ‚™ is an <strong>integral of the Gaussian</strong> in the 3D ray space along the viewing ray: $qâ‚™(ğ±) = âˆ«râ‚™'(ğ±,xâ‚‚)dxâ‚‚$.</p>
</li>
<li>
<p>oâ‚™ in 3DGS will get <strong>optimized</strong> directly via gradient descent during training.</p>
</li>
<li>
<p>Gâ‚™ is a 2D Gaussian with the normalization factor omitted.
Its mean and covariance matrix will get optimized.</p>
</li>
<li>
<p>Î”â‚™ is the displacement of a pixel center from the 2D Gaussian&rsquo;s mean.</p>
<p><img src="/post/writenotes/model/splats/b-note-3dgs-math/alpha_opacity.jpg"
	width="671"
	height="439"
	
	loading="lazy"
	
		alt="img"
	
	
		class="gallery-image" 
		data-flex-grow="152"
		data-flex-basis="366px"
	
></p>
</li>
</ul>
</li>
<li>
<p>Initially, the opacity of an arbitrary 3D location in the <strong>object space</strong> is considered as
an expectation of the <strong>contributions</strong> from all 3D Gaussians on that location.</p>
<p>After performing 3 steps:
â¶ substituting the perspectively <strong>projected</strong> (&ldquo;squashed&rdquo;) kernel within the 3D ray space into the rendering equation,
â· <strong>switching</strong> the sequence of integral and expectation,
â¸ and applying <strong>simplifying</strong> assumptions,
the opacity becomes a 1-D (depth) <strong>integral</strong> along the viewing ray for <strong>each</strong> kernel in the 3D ray space.</p>
<p>In summary, the changes of <strong>opacity</strong> before and after perspective projection:</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>Aspect</th>
          <th>Original form</th>
          <th>Post-projection</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Venue</td>
          <td>Object space</td>
          <td>3D ray space, or screen</td>
      </tr>
      <tr>
          <td>Intuition</td>
          <td>Opacity combination</td>
          <td>Discs stack</td>
      </tr>
      <tr>
          <td>Scope</td>
          <td>Location-wise</td>
          <td>Ellipsoid-wise</td>
      </tr>
      <tr>
          <td>Operation</td>
          <td>Expectation</td>
          <td>Integral</td>
      </tr>
      <tr>
          <td>Formula</td>
          <td>$f_c(ğ®) = âˆ‘_{kâ‰¤N} wâ‚– râ‚–(ğ®)$</td>
          <td>Footprint $qâ‚–(ğ±) = âˆ«_{xâ‚‚=0}^L râ‚–'(ğ±,xâ‚‚) dxâ‚‚$</td>
      </tr>
      <tr>
          <td>Basis</td>
          <td>Gauss. mixture</td>
          <td>Scene locality</td>
      </tr>
  </tbody>
</table></div>
<ul>
<li>Locality: 3D positions are grouped into different ellipsoids.</li>
</ul>
</li>
<li>
<p>(2024-01-06) A 3D Gaussian (datapoint) in the camera space (or clip space) is &ldquo;perspectively&rdquo; projected (thrown) onto the screen
(or the ray space, as its x2 is <strong>independtly assigned</strong> beside the screen coordinates x0,x1),
and results in a 2D Gaussian (with applying the Taylor expansion to approximate the nonlinear perspective effects).</p>
<p>The <strong>viewing</strong> ray in camera space will be projected into the 3D ray space remaining a <strong>straight</strong> line segment (due to the linear approximation),
and then the 3D line is projected onto the screen <strong>orthogonally</strong>.</p>
<p>Orthogonal projection is because the 3D Gaussians have <strong>already</strong> been projected onto the screen
(the <strong>location</strong> has been determined as x,y divided by z and covariance matrix ğšº&rsquo;= ğ‰ğ– ğšºğ–áµ€ ğ‰áµ€) yielding 2D Gaussians,
so each pixel is only derived from those projected kernels (2D Gaussians) that <strong>overlaps</strong> with it (&ldquo;Overlapping&rdquo; refer to 3DGS.),
like a <strong>stack of filters</strong> in alpha compositing.
That implies the alpha compositing is performed in the screen space, or the ray sapce,
as the ray space is equivalent with screen (EWA paper: &ldquo;the transformation from volume-data to ray space is equivalent to perspective projection.&rdquo;).</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 408 185"
      >
      <g transform='translate(8,16)'>
<path d='M 0,80 L 0,144' fill='none' stroke='currentColor'></path>
<path d='M 16,48 L 16,112' fill='none' stroke='currentColor'></path>
<path d='M 32,16 L 32,80' fill='none' stroke='currentColor'></path>
<path d='M 0,80 L 16,48' fill='none' stroke='currentColor'></path>
<path d='M 16,48 L 32,16' fill='none' stroke='currentColor'></path>
<path d='M 0,112 L 16,80' fill='none' stroke='currentColor'></path>
<path d='M 16,80 L 32,48' fill='none' stroke='currentColor'></path>
<path d='M 0,144 L 16,112' fill='none' stroke='currentColor'></path>
<path d='M 16,112 L 32,80' fill='none' stroke='currentColor'></path>
<path d='M 72,80 L 88,48' fill='none' stroke='currentColor'></path>
<path d='M 88,112 L 104,80' fill='none' stroke='currentColor'></path>
<path d='M 136,80 L 152,48' fill='none' stroke='currentColor'></path>
<path d='M 152,112 L 168,80' fill='none' stroke='currentColor'></path>
<path d='M 216,80 L 232,48' fill='none' stroke='currentColor'></path>
<path d='M 232,112 L 248,80' fill='none' stroke='currentColor'></path>
<path d='M 72,80 L 88,112' fill='none' stroke='currentColor'></path>
<path d='M 88,48 L 104,80' fill='none' stroke='currentColor'></path>
<path d='M 136,80 L 152,112' fill='none' stroke='currentColor'></path>
<path d='M 152,48 L 168,80' fill='none' stroke='currentColor'></path>
<path d='M 216,80 L 232,112' fill='none' stroke='currentColor'></path>
<path d='M 232,48 L 248,80' fill='none' stroke='currentColor'></path>
<text text-anchor='middle' x='0' y='4' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='16' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='24' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='24' y='84' fill='currentColor' style='font-size:1em'>â– </text>
<text text-anchor='middle' x='32' y='4' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='40' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='40' y='100' fill='currentColor' style='font-size:1em'>â†’</text>
<text text-anchor='middle' x='48' y='4' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='48' y='84' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='64' y='4' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='72' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='72' y='164' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='80' y='4' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='80' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='80' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='88' y='4' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='88' y='36' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='88' y='84' fill='currentColor' style='font-size:1em'>â– </text>
<text text-anchor='middle' x='88' y='132' fill='currentColor' style='font-size:1em'>â†‘</text>
<text text-anchor='middle' x='88' y='148' fill='currentColor' style='font-size:1em'>â¬­</text>
<text text-anchor='middle' x='88' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='96' y='4' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='96' y='36' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='96' y='164' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='104' y='36' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='104' y='164' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='112' y='4' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='120' y='4' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='120' y='68' fill='currentColor' style='font-size:1em'>âœš</text>
<text text-anchor='middle' x='136' y='4' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='136' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='136' y='164' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='144' y='4' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='144' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='144' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='152' y='36' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='152' y='84' fill='currentColor' style='font-size:1em'>â– </text>
<text text-anchor='middle' x='152' y='132' fill='currentColor' style='font-size:1em'>â†‘</text>
<text text-anchor='middle' x='152' y='148' fill='currentColor' style='font-size:1em'>â¬¯</text>
<text text-anchor='middle' x='152' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='160' y='4' fill='currentColor' style='font-size:1em'>G</text>
<text text-anchor='middle' x='160' y='36' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='160' y='164' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='168' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='168' y='36' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='168' y='164' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='176' y='4' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='184' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='192' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='192' y='68' fill='currentColor' style='font-size:1em'>âœš</text>
<text text-anchor='middle' x='192' y='84' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='200' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='208' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='216' y='4' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='216' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='216' y='164' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='224' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='224' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='224' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='232' y='36' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='232' y='84' fill='currentColor' style='font-size:1em'>â– </text>
<text text-anchor='middle' x='232' y='132' fill='currentColor' style='font-size:1em'>â†‘</text>
<text text-anchor='middle' x='232' y='148' fill='currentColor' style='font-size:1em'>â¬­</text>
<text text-anchor='middle' x='232' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='240' y='4' fill='currentColor' style='font-size:1em'>O</text>
<text text-anchor='middle' x='240' y='36' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='240' y='164' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='248' y='4' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='248' y='36' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='248' y='164' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='256' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='264' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='272' y='4' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='280' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='280' y='132' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='288' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='288' y='84' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='288' y='132' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='288' y='164' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='296' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='296' y='84' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='296' y='132' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='296' y='164' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='304' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='304' y='84' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='304' y='132' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='304' y='164' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='312' y='4' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='312' y='116' fill='currentColor' style='font-size:1em'>â†‘</text>
<text text-anchor='middle' x='320' y='4' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='320' y='84' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='320' y='132' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='320' y='164' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='328' y='84' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='328' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='328' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='336' y='4' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='336' y='84' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='336' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='336' y='164' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='344' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='344' y='84' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='344' y='132' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='352' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='352' y='84' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='352' y='132' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='352' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='360' y='4' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='360' y='84' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='360' y='132' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='360' y='164' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='368' y='84' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='368' y='132' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='368' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='376' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='376' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='384' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='384' y='132' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='384' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='392' y='132' fill='currentColor' style='font-size:1em'>â‚‚</text>
<text text-anchor='middle' x='392' y='164' fill='currentColor' style='font-size:1em'>)</text>
</g>

    </svg>
  
</div>
<p>With the &ldquo;orthogonal correspondence&rdquo; between the ray space and the screen,
the ray integral (footprint function, or kernel&rsquo;s opacity) in the 3D ray space
<strong>becomes</strong> (??Not sure) an integral on the 2D screen plane, i.e., an integral of a 2D Gaussian.</p>
<p><del>And the ray in the 3D ray space corresponds to a line on the screen, as rays in the 3D ray space are parallel (i.e., orthogonal projection).
Thus, the opacity is an</del></p>
</li>
</ul>
<p><del>Alpha of an arbitrary point in screen (or 3D ray space) is a 2D-Gaussian mixture over all kernels.</del>
(Not the screen, object space is opacities combination, whereas the screen space is filter stacking.)</p>
<p><del>The alpha of a 3D location is calculated in each 3D Gaussian based on the distance to the center.
And the final alpha on the location is the expectation of all the evaluations.</del> (No location-wise alpha was calculated.)</p>
<p>The color of a pixel on the screen is a 2D-Gaussian mixture:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 512 249"
      >
      <g transform='translate(8,16)'>
<path d='M 168,80 L 256,80' fill='none' stroke='currentColor'></path>
<path d='M 400,112 L 432,112' fill='none' stroke='currentColor'></path>
<path d='M 144,128 L 152,128' fill='none' stroke='currentColor'></path>
<path d='M 272,128 L 280,128' fill='none' stroke='currentColor'></path>
<path d='M 152,88 L 160,88' fill='none' stroke='currentColor'></path>
<path d='M 264,88 L 272,88' fill='none' stroke='currentColor'></path>
<path d='M 160,136 L 264,136' fill='none' stroke='currentColor'></path>
<path d='M 40,96 L 40,224' fill='none' stroke='currentColor'></path>
<path d='M 56,64 L 56,192' fill='none' stroke='currentColor'></path>
<path d='M 72,32 L 72,160' fill='none' stroke='currentColor'></path>
<path d='M 128,104 L 128,120' fill='none' stroke='currentColor'></path>
<path d='M 296,104 L 296,120' fill='none' stroke='currentColor'></path>
<path d='M 328,96 L 328,128' fill='none' stroke='currentColor'></path>
<path d='M 336,72 L 336,88' fill='none' stroke='currentColor'></path>
<path d='M 336,136 L 336,152' fill='none' stroke='currentColor'></path>
<path d='M 344,152 L 344,168' fill='none' stroke='currentColor'></path>
<path d='M 360,152 L 360,168' fill='none' stroke='currentColor'></path>
<path d='M 368,72 L 368,88' fill='none' stroke='currentColor'></path>
<path d='M 368,136 L 368,152' fill='none' stroke='currentColor'></path>
<path d='M 376,96 L 376,128' fill='none' stroke='currentColor'></path>
<path d='M 40,96 L 56,64' fill='none' stroke='currentColor'></path>
<path d='M 56,64 L 72,32' fill='none' stroke='currentColor'></path>
<path d='M 40,128 L 56,96' fill='none' stroke='currentColor'></path>
<path d='M 56,96 L 72,64' fill='none' stroke='currentColor'></path>
<path d='M 40,160 L 56,128' fill='none' stroke='currentColor'></path>
<path d='M 56,128 L 72,96' fill='none' stroke='currentColor'></path>
<path d='M 40,192 L 56,160' fill='none' stroke='currentColor'></path>
<path d='M 56,160 L 72,128' fill='none' stroke='currentColor'></path>
<path d='M 80,128 L 136,16' fill='none' stroke='currentColor'></path>
<path d='M 40,224 L 56,192' fill='none' stroke='currentColor'></path>
<path d='M 56,192 L 72,160' fill='none' stroke='currentColor'></path>
<polygon points='92.000000,128.000000 80.000000,122.400002 80.000000,133.600006' fill='currentColor' transform='rotate(120.000000, 80.000000, 128.000000)'></polygon>
<polygon points='408.000000,112.000000 396.000000,106.400002 396.000000,117.599998' fill='currentColor' transform='rotate(180.000000, 400.000000, 112.000000)'></polygon>
<text text-anchor='middle' x='0' y='68' fill='currentColor' style='font-size:1em'>G</text>
<text text-anchor='middle' x='8' y='68' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='8' y='84' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='16' y='52' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='16' y='68' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='16' y='84' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='24' y='52' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='24' y='68' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='24' y='84' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='32' y='68' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='32' y='84' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='40' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='48' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='56' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='80' y='20' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='96' y='68' fill='currentColor' style='font-size:1em'>âˆ«</text>
<text text-anchor='middle' x='96' y='212' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='104' y='4' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='104' y='212' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='112' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='112' y='196' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='112' y='212' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='112' y='228' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='120' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='120' y='196' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='120' y='212' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='120' y='228' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='128' y='4' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='128' y='196' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='128' y='212' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='128' y='228' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='136' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='136' y='100' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='136' y='132' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='136' y='196' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='136' y='228' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='144' y='4' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='144' y='100' fill='currentColor' style='font-size:1em'>~</text>
<text text-anchor='middle' x='144' y='196' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='144' y='212' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='144' y='228' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='152' y='4' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='152' y='196' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='152' y='212' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='152' y='228' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='160' y='212' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='160' y='228' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='168' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='168' y='196' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='168' y='212' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='168' y='228' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='176' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='176' y='196' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='176' y='228' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='184' y='4' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='184' y='196' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='184' y='212' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='192' y='196' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='192' y='212' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='192' y='228' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='200' y='20' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='200' y='228' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='208' y='20' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='208' y='196' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='208' y='212' fill='currentColor' style='font-size:1em'>â€–</text>
<text text-anchor='middle' x='208' y='228' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='216' y='116' fill='currentColor' style='font-size:1em'>â€¢</text>
<text text-anchor='middle' x='216' y='196' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='216' y='212' fill='currentColor' style='font-size:1em'>ğ­</text>
<text text-anchor='middle' x='216' y='228' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='224' y='20' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='224' y='196' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='224' y='212' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='224' y='228' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='232' y='212' fill='currentColor' style='font-size:1em'>â€–</text>
<text text-anchor='middle' x='232' y='228' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='240' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='240' y='196' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='240' y='212' fill='currentColor' style='font-size:1em'>â‚‚</text>
<text text-anchor='middle' x='240' y='228' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='248' y='196' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='256' y='20' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='256' y='196' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='256' y='212' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='256' y='228' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='264' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='264' y='196' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='264' y='212' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='264' y='228' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='272' y='20' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='272' y='212' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='272' y='228' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='280' y='20' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='280' y='100' fill='currentColor' style='font-size:1em'>~</text>
<text text-anchor='middle' x='280' y='196' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='280' y='228' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='288' y='20' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='288' y='100' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='288' y='132' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='288' y='196' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='288' y='212' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='288' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='296' y='196' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='296' y='212' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='304' y='20' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='304' y='196' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='304' y='212' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='304' y='228' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='312' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='312' y='196' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='312' y='212' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='312' y='228' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='320' y='20' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='320' y='196' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='320' y='212' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='320' y='228' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='328' y='212' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='336' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='336' y='196' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='336' y='212' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='336' y='228' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='344' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='344' y='68' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='344' y='196' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='344' y='212' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='344' y='228' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='352' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='352' y='68' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='352' y='116' fill='currentColor' style='font-size:1em'>â€¢</text>
<text text-anchor='middle' x='352' y='180' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='352' y='196' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='352' y='212' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='352' y='228' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='360' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='360' y='68' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='360' y='196' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='360' y='212' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='360' y='228' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='368' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='368' y='212' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='368' y='228' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='376' y='196' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='376' y='228' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='384' y='196' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='384' y='212' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='392' y='196' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='392' y='212' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='392' y='228' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='400' y='84' fill='currentColor' style='font-size:1em'>P</text>
<text text-anchor='middle' x='400' y='100' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='400' y='212' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='400' y='228' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='408' y='84' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='408' y='100' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='408' y='196' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='408' y='212' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='416' y='84' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='416' y='100' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='416' y='196' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='416' y='212' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='416' y='228' fill='currentColor' style='font-size:1em'>ğšº</text>
<text text-anchor='middle' x='424' y='84' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='424' y='100' fill='currentColor' style='font-size:1em'>j</text>
<text text-anchor='middle' x='424' y='196' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='424' y='212' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='424' y='228' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='432' y='84' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='432' y='196' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='432' y='212' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='432' y='228' fill='currentColor' style='font-size:1em'>â‚ƒ</text>
<text text-anchor='middle' x='440' y='84' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='440' y='196' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='440' y='228' fill='currentColor' style='font-size:1em'>â‚“</text>
<text text-anchor='middle' x='448' y='84' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='448' y='196' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='448' y='212' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='448' y='228' fill='currentColor' style='font-size:1em'>â‚ƒ</text>
<text text-anchor='middle' x='456' y='20' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='456' y='36' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='456' y='196' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='456' y='212' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='456' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='464' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='464' y='36' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='464' y='116' fill='currentColor' style='font-size:1em'>â¬­</text>
<text text-anchor='middle' x='464' y='212' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='472' y='20' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='472' y='36' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='472' y='212' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='480' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='480' y='36' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='480' y='212' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='488' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='488' y='36' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='496' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='496' y='116' fill='currentColor' style='font-size:1em'>â¬¯</text>
</g>

    </svg>
  
</div>
<p>The alpha compositing process for a pixel is illustrated below:</p>
<p><img src="/post/writenotes/model/splats/b-note-3dgs-math/Splat_composite.jpg"
	width="505"
	height="431"
	
	loading="lazy"
	
		alt="img"
	
	
		class="gallery-image" 
		data-flex-grow="117"
		data-flex-basis="281px"
	
></p>
<ul>
<li>
<p>Opacities (oâ‚,oâ‚‚,oâ‚ƒ) of different kernels are various-length integral along the viewing ray in the 3D ray space.</p>
<ul>
<li>Not sure whether the integral in 3D ray space equal the integral on screen.</li>
</ul>
</li>
<li>
<p>Weight (wâ‚,wâ‚‚,wâ‚ƒ) of a kernel&rsquo;s opacity is its evaluation at the pixel.</p>
</li>
<li>
<p>Alpha (Î±â‚,Î±â‚‚,Î±â‚ƒ) of a kernel equals its opacity multiplied with its weight.</p>
</li>
<li>
<p>Accumulated transmittance (Tâ‚,Tâ‚‚,Tâ‚ƒ) equals the product of previously passed kernels&rsquo; transmittance.</p>
</li>
<li>
<p>Pixel color is the sum of each kernel&rsquo;s color scaled by alpha.</p>
</li>
</ul>
<p>There is no volume rendering as there is <strong>no sampling</strong> points on the viewing ray.
Pixel is a summation of visible <strong>2D discs</strong> (referring to 3DGS).
Only alphas of the explicitly existent discs require to be computed, unlike volume rendering where every sampling location need to compute alpha.</p>
<hr>
<h2 id="gradient-wrt-composite">Gradient wrt Composite
</h2><p>(2023-01-07)</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 512 185"
      >
      <g transform='translate(8,16)'>
<path d='M 304,16 L 328,16' fill='none' stroke='currentColor'></path>
<path d='M 120,96 L 120,160' fill='none' stroke='currentColor'></path>
<path d='M 136,64 L 136,128' fill='none' stroke='currentColor'></path>
<path d='M 152,32 L 152,96' fill='none' stroke='currentColor'></path>
<path d='M 120,96 L 136,64' fill='none' stroke='currentColor'></path>
<path d='M 136,64 L 152,32' fill='none' stroke='currentColor'></path>
<path d='M 120,128 L 136,96' fill='none' stroke='currentColor'></path>
<path d='M 136,96 L 152,64' fill='none' stroke='currentColor'></path>
<path d='M 120,160 L 136,128' fill='none' stroke='currentColor'></path>
<path d='M 136,128 L 152,96' fill='none' stroke='currentColor'></path>
<path d='M 256,96 L 272,64' fill='none' stroke='currentColor'></path>
<path d='M 272,128 L 288,96' fill='none' stroke='currentColor'></path>
<path d='M 320,96 L 336,64' fill='none' stroke='currentColor'></path>
<path d='M 336,128 L 352,96' fill='none' stroke='currentColor'></path>
<path d='M 400,96 L 416,64' fill='none' stroke='currentColor'></path>
<path d='M 416,128 L 432,96' fill='none' stroke='currentColor'></path>
<path d='M 64,16 L 104,96' fill='none' stroke='currentColor'></path>
<path d='M 256,96 L 272,128' fill='none' stroke='currentColor'></path>
<path d='M 272,64 L 288,96' fill='none' stroke='currentColor'></path>
<path d='M 320,96 L 336,128' fill='none' stroke='currentColor'></path>
<path d='M 336,64 L 352,96' fill='none' stroke='currentColor'></path>
<path d='M 400,96 L 416,128' fill='none' stroke='currentColor'></path>
<path d='M 416,64 L 432,96' fill='none' stroke='currentColor'></path>
<polygon points='116.000000,96.000000 104.000000,90.400002 104.000000,101.599998' fill='currentColor' transform='rotate(60.000000, 104.000000, 96.000000)'></polygon>
<polygon points='312.000000,16.000000 300.000000,10.400000 300.000000,21.600000' fill='currentColor' transform='rotate(180.000000, 304.000000, 16.000000)'></polygon>
<circle cx='24' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='48' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='56' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='80' cy='112' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='96' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='0' y='4' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='0' y='132' fill='currentColor' style='font-size:1em'>P</text>
<text text-anchor='middle' x='0' y='148' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='0' y='164' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='8' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='8' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='8' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='8' y='164' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='16' y='4' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='16' y='132' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='16' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='24' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='24' y='132' fill='currentColor' style='font-size:1em'>j</text>
<text text-anchor='middle' x='24' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='24' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='32' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='32' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='32' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='32' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='40' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='40' y='100' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='40' y='132' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='40' y='148' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='40' y='164' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='48' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='48' y='132' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='48' y='148' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='56' y='4' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='56' y='100' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='56' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='56' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='64' y='4' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='64' y='68' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='64' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='64' y='148' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='64' y='164' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='72' y='4' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='72' y='84' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='72' y='100' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='72' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='72' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='80' y='68' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='80' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='88' y='4' fill='currentColor' style='font-size:1em'>U</text>
<text text-anchor='middle' x='88' y='84' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='88' y='100' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='88' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='96' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='96' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='96' y='68' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='96' y='116' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='104' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='104' y='20' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='104' y='84' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='112' y='20' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='112' y='52' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='112' y='68' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='112' y='116' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='120' y='4' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='120' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='120' y='84' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='128' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='128' y='20' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='128' y='52' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='128' y='68' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='136' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='136' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='144' y='4' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='144' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='152' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='160' y='4' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='160' y='20' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='168' y='4' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='176' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='184' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='192' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='192' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='200' y='4' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='200' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='208' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='216' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='216' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='224' y='4' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='224' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='256' y='4' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='256' y='20' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='256' y='52' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='256' y='148' fill='currentColor' style='font-size:1em'>ğ›</text>
<text text-anchor='middle' x='264' y='4' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='264' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='264' y='52' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='264' y='148' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='264' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='272' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='272' y='20' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='272' y='52' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='272' y='100' fill='currentColor' style='font-size:1em'>â– </text>
<text text-anchor='middle' x='272' y='148' fill='currentColor' style='font-size:1em'>â‚</text>
<text text-anchor='middle' x='272' y='164' fill='currentColor' style='font-size:1em'>â‚</text>
<text text-anchor='middle' x='280' y='4' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='280' y='20' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='280' y='52' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='280' y='148' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='280' y='164' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='288' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='288' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='288' y='52' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='288' y='148' fill='currentColor' style='font-size:1em'>ğšº</text>
<text text-anchor='middle' x='288' y='164' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='296' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='296' y='148' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='296' y='164' fill='currentColor' style='font-size:1em'>â‚</text>
<text text-anchor='middle' x='304' y='4' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='304' y='84' fill='currentColor' style='font-size:1em'>âœš</text>
<text text-anchor='middle' x='304' y='148' fill='currentColor' style='font-size:1em'>â‚</text>
<text text-anchor='middle' x='312' y='4' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='320' y='52' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='328' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='328' y='52' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='328' y='148' fill='currentColor' style='font-size:1em'>ğ›</text>
<text text-anchor='middle' x='336' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='336' y='52' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='336' y='100' fill='currentColor' style='font-size:1em'>â– </text>
<text text-anchor='middle' x='336' y='148' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='336' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='344' y='4' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='344' y='20' fill='currentColor' style='font-size:1em'>B</text>
<text text-anchor='middle' x='344' y='52' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='344' y='148' fill='currentColor' style='font-size:1em'>â‚‚</text>
<text text-anchor='middle' x='344' y='164' fill='currentColor' style='font-size:1em'>â‚‚</text>
<text text-anchor='middle' x='352' y='4' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='352' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='352' y='52' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='352' y='148' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='352' y='164' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='360' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='360' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='360' y='148' fill='currentColor' style='font-size:1em'>ğšº</text>
<text text-anchor='middle' x='360' y='164' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='368' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='368' y='20' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='368' y='148' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='368' y='164' fill='currentColor' style='font-size:1em'>â‚‚</text>
<text text-anchor='middle' x='376' y='84' fill='currentColor' style='font-size:1em'>âœš</text>
<text text-anchor='middle' x='376' y='100' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='376' y='148' fill='currentColor' style='font-size:1em'>â‚‚</text>
<text text-anchor='middle' x='384' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='384' y='20' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='392' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='392' y='20' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='400' y='4' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='400' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='400' y='52' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='408' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='408' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='408' y='52' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='408' y='148' fill='currentColor' style='font-size:1em'>ğ›</text>
<text text-anchor='middle' x='416' y='4' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='416' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='416' y='52' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='416' y='100' fill='currentColor' style='font-size:1em'>â– </text>
<text text-anchor='middle' x='416' y='148' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='416' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='424' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='424' y='52' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='424' y='148' fill='currentColor' style='font-size:1em'>â‚™</text>
<text text-anchor='middle' x='424' y='164' fill='currentColor' style='font-size:1em'>â‚™</text>
<text text-anchor='middle' x='432' y='4' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='432' y='52' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='432' y='148' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='432' y='164' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='440' y='4' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='440' y='20' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='440' y='148' fill='currentColor' style='font-size:1em'>ğšº</text>
<text text-anchor='middle' x='440' y='164' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='448' y='4' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='448' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='448' y='100' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='448' y='148' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='448' y='164' fill='currentColor' style='font-size:1em'>â‚™</text>
<text text-anchor='middle' x='456' y='4' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='456' y='52' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='456' y='148' fill='currentColor' style='font-size:1em'>â‚™</text>
<text text-anchor='middle' x='464' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='464' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='464' y='52' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='464' y='100' fill='currentColor' style='font-size:1em'>â– </text>
<text text-anchor='middle' x='472' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='472' y='52' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='480' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='488' y='20' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='496' y='20' fill='currentColor' style='font-size:1em'>)</text>
</g>

    </svg>
  
</div>
<ul>
<li>The dot lines in the left figure represent orthogonal <strong>correspondence</strong>, not projection.</li>
<li>A pixel can only <strong>see</strong> 2D Gaussians located on its perpendicular line.</li>
<li>Those visible 2D Gaussians to a pixel are sorted based on depth,
and then their colors are composited from <strong>near to far</strong> with multiplying with their opacities that computed as an integral along the viewing ray.</li>
</ul>
<p>A synthesized pixel is a weighted sum of the <strong>related</strong> (overlapping) kernels&rsquo; color in the whole space:</p>
$$C_{pred} = âˆ‘_{nâ‰¤N} Tâ‚™â‹…Î±â‚™â‹…câ‚™, \quad \text{where } Î±â‚™=oâ‚™â‹…e^{-\frac{\bm Î”â‚™áµ€ \bm Î”â‚™}{2\bm Î£'}}$$<p>Loss:</p>
$$L = â€–C_{targ} - C_{pred}â€–â‚‚$$<details><summary>The paper used Frobenius product to analyze.</summary>
<p>A Frobenius inner product is like a linear layer:</p>
$$âŸ¨ğ—,ğ˜âŸ© = \operatorname{vec}(ğ—)áµ€ \operatorname{vec}(ğ˜)$$<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>   <span class="c1"># fc.weight is (10,3)</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">fc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>   <span class="c1"># Xâ‹…Wáµ€ = (2,3)â‹…(3,10) = (2,10) is âŸ¨Xáµ€,Wáµ€âŸ©</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Chain rule:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 288 25"
      >
      <g transform='translate(8,16)'>
<path d='M 16,0 L 32,0' fill='none' stroke='currentColor'></path>
<path d='M 168,0 L 184,0' fill='none' stroke='currentColor'></path>
<path d='M 240,0 L 256,0' fill='none' stroke='currentColor'></path>
<polygon points='40.000000,0.000000 28.000000,-5.600000 28.000000,5.600000' fill='currentColor' transform='rotate(0.000000, 32.000000, 0.000000)'></polygon>
<polygon points='192.000000,0.000000 180.000000,-5.600000 180.000000,5.600000' fill='currentColor' transform='rotate(0.000000, 184.000000, 0.000000)'></polygon>
<polygon points='264.000000,0.000000 252.000000,-5.600000 252.000000,5.600000' fill='currentColor' transform='rotate(0.000000, 256.000000, 0.000000)'></polygon>
<text text-anchor='middle' x='0' y='4' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='48' y='4' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='56' y='4' fill='currentColor' style='font-size:1em'>â‚˜</text>
<text text-anchor='middle' x='64' y='4' fill='currentColor' style='font-size:1em'>â‚“</text>
<text text-anchor='middle' x='72' y='4' fill='currentColor' style='font-size:1em'>â‚š</text>
<text text-anchor='middle' x='80' y='4' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='88' y='4' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='96' y='4' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='104' y='4' fill='currentColor' style='font-size:1em'>Y</text>
<text text-anchor='middle' x='112' y='4' fill='currentColor' style='font-size:1em'>â‚š</text>
<text text-anchor='middle' x='120' y='4' fill='currentColor' style='font-size:1em'>â‚“</text>
<text text-anchor='middle' x='128' y='4' fill='currentColor' style='font-size:1em'>â‚™</text>
<text text-anchor='middle' x='136' y='4' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='144' y='4' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='152' y='4' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='200' y='4' fill='currentColor' style='font-size:1em'>X</text>
<text text-anchor='middle' x='208' y='4' fill='currentColor' style='font-size:1em'>â‚˜</text>
<text text-anchor='middle' x='216' y='4' fill='currentColor' style='font-size:1em'>â‚“</text>
<text text-anchor='middle' x='224' y='4' fill='currentColor' style='font-size:1em'>â‚™</text>
<text text-anchor='middle' x='272' y='4' fill='currentColor' style='font-size:1em'>f</text>
</g>

    </svg>
  
</div>
$$\begin{aligned}
\frac{âˆ‚f}{âˆ‚x} &= \frac{âˆ‚f}{âˆ‚X}â‹…\frac{âˆ‚X}{âˆ‚AY}â‹…\frac{âˆ‚AY}{âˆ‚x} \\\
&= \frac{âˆ‚f}{âˆ‚X}â‹…\frac{âˆ‚X}{âˆ‚AY}â‹…(\frac{âˆ‚A}{âˆ‚x}Y + A\frac{âˆ‚Y}{âˆ‚x})\\\
\end{aligned}$$</details>
<hr>
<p>Since the passed kernels on the ray path (starting from a pixel)
have influences on the next kernel&rsquo;s contribution, which is scaled by the previous accumulated transmittance,
the order of solving derivatives should start from the <strong>most rear</strong> kernel,
and then sequentially calculate the derivatives of backer kernels in the reverse order of the forward pass.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 496 153"
      >
      <g transform='translate(8,16)'>
<path d='M 320,16 L 328,16' fill='none' stroke='currentColor'></path>
<path d='M 328,16 L 352,16' fill='none' stroke='currentColor'></path>
<path d='M 352,16 L 376,16' fill='none' stroke='currentColor'></path>
<path d='M 376,16 L 384,16' fill='none' stroke='currentColor'></path>
<path d='M 80,32 L 96,32' fill='none' stroke='currentColor'></path>
<path d='M 32,80 L 32,96' fill='none' stroke='currentColor'></path>
<path d='M 304,32 L 304,48' fill='none' stroke='currentColor'></path>
<path d='M 328,16 L 328,48' fill='none' stroke='currentColor'></path>
<path d='M 352,16 L 352,48' fill='none' stroke='currentColor'></path>
<path d='M 376,16 L 376,48' fill='none' stroke='currentColor'></path>
<path d='M 400,32 L 400,48' fill='none' stroke='currentColor'></path>
<polygon points='40.000000,80.000000 28.000000,74.400002 28.000000,85.599998' fill='currentColor' transform='rotate(270.000000, 32.000000, 80.000000)'></polygon>
<polygon points='88.000000,32.000000 76.000000,26.400000 76.000000,37.599998' fill='currentColor' transform='rotate(180.000000, 80.000000, 32.000000)'></polygon>
<polygon points='408.000000,48.000000 396.000000,42.400002 396.000000,53.599998' fill='currentColor' transform='rotate(90.000000, 400.000000, 48.000000)'></polygon>
<path d='M 320,16 A 16,16 0 0,0 304,32' fill='none' stroke='currentColor'></path>
<path d='M 384,16 A 16,16 0 0,1 400,32' fill='none' stroke='currentColor'></path>
<text text-anchor='middle' x='0' y='4' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='0' y='116' fill='currentColor' style='font-size:1em'>G</text>
<text text-anchor='middle' x='8' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='8' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='8' y='132' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='16' y='4' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='16' y='20' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='16' y='52' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='16' y='116' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='16' y='132' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='24' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='24' y='20' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='24' y='52' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='24' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='24' y='132' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='32' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='32' y='36' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='32' y='52' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='32' y='68' fill='currentColor' style='font-size:1em'>â¬®</text>
<text text-anchor='middle' x='32' y='132' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='40' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='40' y='52' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='40' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='40' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='40' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='48' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='48' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='48' y='52' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='48' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='48' y='116' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='48' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='56' y='4' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='56' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='56' y='68' fill='currentColor' style='font-size:1em'>â¬®</text>
<text text-anchor='middle' x='56' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='64' y='4' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='64' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='64' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='72' y='4' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='72' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='72' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='80' y='68' fill='currentColor' style='font-size:1em'>â¬®</text>
<text text-anchor='middle' x='88' y='4' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='88' y='20' fill='currentColor' style='font-size:1em'>P</text>
<text text-anchor='middle' x='88' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='96' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='96' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='96' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='104' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='104' y='20' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='104' y='68' fill='currentColor' style='font-size:1em'>â¬®</text>
<text text-anchor='middle' x='112' y='4' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='112' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='112' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='112' y='100' fill='currentColor' style='font-size:1em'>T</text>
<text text-anchor='middle' x='112' y='116' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='120' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='120' y='20' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='120' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='120' y='100' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='120' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='128' y='4' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='128' y='68' fill='currentColor' style='font-size:1em'>â¬®</text>
<text text-anchor='middle' x='128' y='100' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='136' y='4' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='136' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='136' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='136' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='144' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='144' y='52' fill='currentColor' style='font-size:1em'>B</text>
<text text-anchor='middle' x='144' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='144' y='100' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='144' y='116' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='152' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='152' y='20' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='152' y='36' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='152' y='52' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='152' y='68' fill='currentColor' style='font-size:1em'>â¬®</text>
<text text-anchor='middle' x='152' y='84' fill='currentColor' style='font-size:1em'>â†‘</text>
<text text-anchor='middle' x='152' y='100' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='152' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='160' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='160' y='20' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='160' y='52' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='160' y='100' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='168' y='4' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='168' y='52' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='168' y='68' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='168' y='100' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='168' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='176' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='176' y='100' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='176' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='184' y='4' fill='currentColor' style='font-size:1em'>â†˜</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='184' y='68' fill='currentColor' style='font-size:1em'>â– </text>
<text text-anchor='middle' x='184' y='100' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='184' y='116' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='192' y='20' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='192' y='100' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='192' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='200' y='4' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='200' y='20' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='200' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='208' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='208' y='100' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='216' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='216' y='20' fill='currentColor' style='font-size:1em'>â†</text>
<text text-anchor='middle' x='216' y='100' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='216' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='224' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='224' y='100' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='224' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='232' y='100' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='232' y='116' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='240' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='240' y='100' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='240' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='248' y='4' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='248' y='116' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='256' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='264' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='272' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='280' y='4' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='304' y='4' fill='currentColor' style='font-size:1em'>B</text>
<text text-anchor='middle' x='304' y='68' fill='currentColor' style='font-size:1em'>â¬®</text>
<text text-anchor='middle' x='304' y='84' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='304' y='100' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='304' y='116' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='312' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='312' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='312' y='100' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='312' y='116' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='320' y='4' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='320' y='36' fill='currentColor' style='font-size:1em'>âœš</text>
<text text-anchor='middle' x='320' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='320' y='100' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='320' y='116' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='328' y='4' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='328' y='68' fill='currentColor' style='font-size:1em'>â¬®</text>
<text text-anchor='middle' x='328' y='100' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='336' y='4' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='336' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='336' y='100' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='336' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='344' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='344' y='36' fill='currentColor' style='font-size:1em'>âœš</text>
<text text-anchor='middle' x='344' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='344' y='100' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='344' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='352' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='352' y='68' fill='currentColor' style='font-size:1em'>â¬®</text>
<text text-anchor='middle' x='352' y='100' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='352' y='116' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='360' y='4' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='360' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='360' y='100' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='360' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='368' y='4' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='368' y='36' fill='currentColor' style='font-size:1em'>âœš</text>
<text text-anchor='middle' x='368' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='368' y='84' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='368' y='100' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='368' y='116' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='376' y='68' fill='currentColor' style='font-size:1em'>â¬®</text>
<text text-anchor='middle' x='376' y='84' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='376' y='100' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='376' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='384' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='384' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='384' y='84' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='384' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='392' y='4' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='392' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='392' y='100' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='392' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='400' y='4' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='400' y='68' fill='currentColor' style='font-size:1em'>â¬®</text>
<text text-anchor='middle' x='400' y='84' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='400' y='100' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='400' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='408' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='408' y='100' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='408' y='116' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='416' y='4' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='416' y='68' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='416' y='100' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='424' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='424' y='68' fill='currentColor' style='font-size:1em'>â¬®</text>
<text text-anchor='middle' x='424' y='100' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='424' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='432' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='432' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='440' y='4' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='440' y='68' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='440' y='100' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='440' y='116' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='448' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='448' y='100' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='448' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='456' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='456' y='68' fill='currentColor' style='font-size:1em'>â– </text>
<text text-anchor='middle' x='456' y='100' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='456' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='464' y='4' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='464' y='100' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='464' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='472' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='480' y='4' fill='currentColor' style='font-size:1em'>s</text>
</g>

    </svg>
  
</div>
<ul>
<li>
<p>The viewing ray travels from front to back and hits the screen.
But the color <strong>nearest</strong> to the screen is the <strong>first to be seen</strong> by (or shown on) the camera (or eye).</p>
</li>
<li>
<p><del>The toppest color is based on downstream colors, so, its a function of all the preceding colors.</del></p>
<p><del>In the color stack, the color above depends on color below.
Thus, the derivatives at the <strong>bottom</strong> should be sovled first.</del></p>
<p>(2024-01-16) The toppest color is the base of all downstream colors, so, its derivative is contributed by all the behind colors.</p>
</li>
</ul>
<hr>
<h3 id="color-opacity">Color, Opacity
</h3><p>(2024-01-08)</p>
<p>Given $\frac{âˆ‚L}{âˆ‚Cáµ¢(k)}$, the partial derivatives of the predicting pixel color $Cáµ¢$ w.r.t.
each parameter of a Gaussian Gâ‚™ (in the ray space) that contributes to the pixel are:</p>
<ol>
<li>
<p>The parital derivative of Cáµ¢ w.r.t. the kernel Gâ‚™&rsquo;s color câ‚™,
based on the forward pass: $Cáµ¢ = Tâ‚â‹…Î±â‚â‹…câ‚+ Tâ‚‚â‹…Î±â‚‚â‹…câ‚‚ + â‹¯ Tâ‚™â‹…Î±â‚™â‹…câ‚™+ Tâ‚™â‚Šâ‚â‹…Î±â‚™â‚Šâ‚â‹…câ‚™â‚Šâ‚ +â‹¯ + T_Nâ‹…Î±_Nâ‹…c_N$:</p>
$$\frac{âˆ‚Cáµ¢(k)}{âˆ‚câ‚™(k)} = Î±â‚™â‹…Tâ‚™$$<ul>
<li>
<p>k represents one channel of RGB.</p>
</li>
<li>
<p>The <strong>furthest</strong> $T_N$ from the screen is saved at the end of the forward pass.
And then the $T_{N-1}$ in back of it is calculated as $T_{N-1} = \frac{T_N}{1-Î±_{N-1}}$.
The points in back follow this relation.</p>
</li>
</ul>
<p><a class="link" href="https://github.com/graphdeco-inria/diff-gaussian-rasterization/blob/59f5f77e3ddbac3ed9db93ec2cfe99ed6c5d121d/cuda_rasterizer/backward.cu#L503-L504"  target="_blank" rel="noopener"
    >3DGS Code</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">T</span> <span class="o">=</span> <span class="n">T</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.f</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">float</span> <span class="n">dchannel_dcolor</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">T</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Alpha Î±â‚™</p>
<p>To solve the partial derivative of pixel color $C_i$ w.r.t. the kernel Gâ‚™&rsquo;s Î±â‚™, only consider the kernels that <strong>follow</strong> Gâ‚™,
as the transmittances of all the subsequent kernels rely on the currenct kernel Gâ‚™:
</p>
$$Tâ‚™â‚Šâ‚ = (1-Î±â‚™)Tâ‚™$$<p>Thereby, the behind kernels will <strong>provide derivatives</strong> to the current kernel Gâ‚™&rsquo;s alpha.</p>
<p>For example, the color of the next kernel, Gâ‚™â‚Šâ‚, behind Gâ‚™ is:</p>
$$\begin{aligned}
   Câ‚™â‚Šâ‚ &= câ‚™â‚Šâ‚â‹…Î±â‚™â‚Šâ‚â‹…Tâ‚™â‚Šâ‚ \\\
   &= câ‚™â‚Šâ‚â‹…Î±â‚™â‚Šâ‚â‹… (1-Î±â‚™)Tâ‚™ \\\
   &= câ‚™â‚Šâ‚â‹…Î±â‚™â‚Šâ‚â‹…(1-Î±â‚™)â‹…
   \frac{ Tâ‚™â‚Šâ‚}{1-Î±â‚™} \\\
   \end{aligned}$$<p>Thus, the color $Câ‚™â‚Šâ‚$ contributes to the total partial derivative $\frac{âˆ‚Cáµ¢}{âˆ‚Î±â‚™}$ with the amount:
$-\frac{câ‚™â‚Šâ‚â‹…Î±â‚™â‚Šâ‚â‹…Tâ‚™â‚Šâ‚}{1-Î±â‚™}$ .</p>
<p>Continuously, the following color Câ‚™â‚Šâ‚‚ can be represented with Î±â‚™:</p>
$$ Câ‚™â‚Šâ‚‚ = câ‚™â‚Šâ‚‚â‹…Î±â‚™â‚Šâ‚‚â‹…Tâ‚™â‚Šâ‚‚ \\\
   = câ‚™â‚Šâ‚‚â‹…Î±â‚™â‚Šâ‚‚ â‹…\cancel{(1-Î±â‚™â‚Šâ‚)} (1-Î±â‚™) \frac{Tâ‚™â‚Šâ‚‚}{ \cancel{(1-Î±â‚™â‚Šâ‚)} (1-Î±â‚™)}$$<ul>
<li>Thus, $\frac{âˆ‚Câ‚™â‚Šâ‚‚}{âˆ‚Î±â‚™} = -\frac{câ‚™â‚Šâ‚‚â‹…Î±â‚™â‚Šâ‚‚â‹…Tâ‚™â‚Šâ‚‚}{1-Î±â‚™}$</li>
</ul>
<p>Similarly, the subsequent kernel Gâ‚˜, with m&gt;n, also contribute to the overall partial derivative $\frac{âˆ‚Cáµ¢}{âˆ‚Î±â‚™}$.</p>
<p>Thereby, the ultimate partial derivatives of the pixel color $Cáµ¢$ w.r.t. the Gâ‚™&rsquo;s alpha Î±â‚™ is:</p>
$$\frac{âˆ‚Cáµ¢}{âˆ‚Î±â‚™} = câ‚™â‹…Tâ‚™ - \frac{âˆ‘_{m>n}câ‚˜â‹…Î±â‚˜â‹… Tâ‚˜}{1-Î±â‚™}$$</li>
<li>
<p>Opacity oâ‚™, mean ğ›&rsquo;, and covariance ğšº':</p>
<p>According to $Î±â‚™ = oâ‚™ e^{-Ïƒâ‚™}$, where $Ïƒâ‚™ = \frac{\bm Î”â‚™áµ€ \bm Î”â‚™}{2\bm Î£â‚™'}$ (a scalar), and
ğš«â‚™ is the offset from the pixel center to the 2D Gaussian Gâ‚™&rsquo;s mean $\bm Î¼'$, such as $\bm Î”â‚™ = \bm Î¼â‚™' - ğ±áµ¢$.</p>
<ul>
<li>
<p>Partial derivative of Î±â‚™ w.r.t. opacity oâ‚™:</p>
$$ \frac{âˆ‚Î±â‚™}{âˆ‚oâ‚™} = e^{-\frac{\bm Î”â‚™áµ€ \bm Î”â‚™}{2\bm Î£â‚™'}} $$</li>
<li>
<p>Partial derivative of Î±â‚™ w.r.t. the &ldquo;exponent&rdquo; sigma $Ïƒâ‚™$:</p>
$$ \frac{âˆ‚Î±â‚™}{âˆ‚Ïƒâ‚™} = -oâ‚™ e^{-Ïƒâ‚™}$$</li>
<li>
<p>Partial derivative of sigma Ïƒâ‚™ w.r.t. 2D mean ğ›â‚™':</p>
<p>Because $\bm Î”â‚™$ is a function of ğ›â‚™&rsquo;,
computing derivaties w.r.t. ğ›â‚™&rsquo; is equivalent to $\bm Î”â‚™$.</p>
<p>The Jacobian of Ïƒâ‚™ is:</p>
$$\frac{âˆ‚Ïƒâ‚™}{âˆ‚\bm Î¼â‚™'} = 
     \frac{âˆ‚Ïƒâ‚™}{âˆ‚\bm Î”â‚™'} = \frac{âˆ‚(Â½\bm Î”â‚™'áµ€ \bm Î£'â»Â¹ \bm Î”â‚™')}{âˆ‚\bm Î”â‚™'} =
     \bm Î£â‚™'â»Â¹ \bm Î”â‚™'$$</li>
<li>
<p>Partial derivative of sigma Ïƒâ‚™ w.r.t. 2D covariance matrix ğšº':</p>
$$\frac{âˆ‚Ïƒâ‚™}{âˆ‚\bm Î£â‚™'} =$$</li>
</ul>
</li>
</ol>
<hr>
<h2 id="gradient-wrt-projection">Gradient wrt Projection
</h2><p>(2024-01-10)</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 528 217"
      >
      <g transform='translate(8,16)'>
<path d='M 128,96 L 216,96' fill='none' stroke='currentColor'></path>
<path d='M 248,96 L 328,96' fill='none' stroke='currentColor'></path>
<path d='M 376,96 L 448,96' fill='none' stroke='currentColor'></path>
<path d='M 184,128 L 192,128' fill='none' stroke='currentColor'></path>
<path d='M 48,176 L 392,176' fill='none' stroke='currentColor'></path>
<path d='M 0,96 L 0,160' fill='none' stroke='currentColor'></path>
<path d='M 16,64 L 16,128' fill='none' stroke='currentColor'></path>
<path d='M 32,32 L 32,96' fill='none' stroke='currentColor'></path>
<path d='M 408,144 L 408,160' fill='none' stroke='currentColor'></path>
<path d='M 416,104 L 416,120' fill='none' stroke='currentColor'></path>
<path d='M 0,96 L 16,64' fill='none' stroke='currentColor'></path>
<path d='M 16,64 L 32,32' fill='none' stroke='currentColor'></path>
<path d='M 0,128 L 16,96' fill='none' stroke='currentColor'></path>
<path d='M 16,96 L 32,64' fill='none' stroke='currentColor'></path>
<path d='M 0,160 L 16,128' fill='none' stroke='currentColor'></path>
<path d='M 16,128 L 32,96' fill='none' stroke='currentColor'></path>
<path d='M 416,104 L 416,112' fill='none' stroke='currentColor'></path>
<polygon points='136.000000,96.000000 124.000000,90.400002 124.000000,101.599998' fill='currentColor' transform='rotate(180.000000, 128.000000, 96.000000)'></polygon>
<polygon points='256.000000,96.000000 244.000000,90.400002 244.000000,101.599998' fill='currentColor' transform='rotate(180.000000, 248.000000, 96.000000)'></polygon>
<polygon points='384.000000,96.000000 372.000000,90.400002 372.000000,101.599998' fill='currentColor' transform='rotate(180.000000, 376.000000, 96.000000)'></polygon>
<polygon points='416.000000,144.000000 404.000000,138.399994 404.000000,149.600006' fill='currentColor' transform='rotate(270.000000, 408.000000, 144.000000)'></polygon>
<path d='M 32,160 A 16,16 0 0,0 48,176' fill='none' stroke='currentColor'></path>
<path d='M 408,160 A 16,16 0 0,1 392,176' fill='none' stroke='currentColor'></path>
<text text-anchor='middle' x='0' y='20' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='8' y='4' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='8' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='16' y='4' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='16' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='24' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='24' y='100' fill='currentColor' style='font-size:1em'>â¬¯</text>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='40' y='68' fill='currentColor' style='font-size:1em'>ğ±</text>
<text text-anchor='middle' x='40' y='100' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='48' y='116' fill='currentColor' style='font-size:1em'>O</text>
<text text-anchor='middle' x='48' y='196' fill='currentColor' style='font-size:1em'>ğ›</text>
<text text-anchor='middle' x='56' y='20' fill='currentColor' style='font-size:1em'>|</text>
<text text-anchor='middle' x='56' y='100' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='56' y='116' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='56' y='196' fill='currentColor' style='font-size:1em'>ğ“›</text>
<text text-anchor='middle' x='64' y='116' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='72' y='84' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='72' y='100' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='72' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='72' y='196' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='80' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='80' y='68' fill='currentColor' style='font-size:1em'>Ï•</text>
<text text-anchor='middle' x='80' y='84' fill='currentColor' style='font-size:1em'>ğ›</text>
<text text-anchor='middle' x='80' y='196' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='88' y='20' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='88' y='68' fill='currentColor' style='font-size:1em'>â‚–</text>
<text text-anchor='middle' x='88' y='84' fill='currentColor' style='font-size:1em'>â‚–</text>
<text text-anchor='middle' x='88' y='100' fill='currentColor' style='font-size:1em'>â‹¯</text>
<text text-anchor='middle' x='88' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='88' y='196' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='96' y='4' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='96' y='68' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='96' y='84' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='96' y='196' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='104' y='4' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='104' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='104' y='68' fill='currentColor' style='font-size:1em'>ğ­</text>
<text text-anchor='middle' x='104' y='84' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='104' y='100' fill='currentColor' style='font-size:1em'>â¬®</text>
<text text-anchor='middle' x='104' y='196' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='112' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='112' y='68' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='112' y='84' fill='currentColor' style='font-size:1em'>ğšº</text>
<text text-anchor='middle' x='112' y='196' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='120' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='120' y='68' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='120' y='84' fill='currentColor' style='font-size:1em'>â‚–</text>
<text text-anchor='middle' x='120' y='196' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='128' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='128' y='84' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='128' y='116' fill='currentColor' style='font-size:1em'>Ï•</text>
<text text-anchor='middle' x='128' y='132' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='128' y='148' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='128' y='196' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='136' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='136' y='84' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='136' y='116' fill='currentColor' style='font-size:1em'>â‚–</text>
<text text-anchor='middle' x='136' y='148' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='136' y='196' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='144' y='116' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='144' y='132' fill='currentColor' style='font-size:1em'>ğ‰</text>
<text text-anchor='middle' x='144' y='148' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='144' y='196' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='152' y='116' fill='currentColor' style='font-size:1em'>ğ­</text>
<text text-anchor='middle' x='152' y='132' fill='currentColor' style='font-size:1em'>â‹…</text>
<text text-anchor='middle' x='152' y='148' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='152' y='196' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='160' y='116' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='160' y='132' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='160' y='196' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='168' y='116' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='168' y='132' fill='currentColor' style='font-size:1em'>ğ­</text>
<text text-anchor='middle' x='168' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='168' y='196' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='176' y='20' fill='currentColor' style='font-size:1em'>|</text>
<text text-anchor='middle' x='176' y='116' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='176' y='132' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='176' y='148' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='184' y='116' fill='currentColor' style='font-size:1em'>Ï•</text>
<text text-anchor='middle' x='184' y='148' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='192' y='20' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='192' y='116' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='192' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='200' y='20' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='200' y='84' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='200' y='116' fill='currentColor' style='font-size:1em'>ğ›</text>
<text text-anchor='middle' x='200' y='132' fill='currentColor' style='font-size:1em'>ğ›</text>
<text text-anchor='middle' x='200' y='148' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='208' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='208' y='84' fill='currentColor' style='font-size:1em'>ğ›</text>
<text text-anchor='middle' x='208' y='116' fill='currentColor' style='font-size:1em'>â‚–</text>
<text text-anchor='middle' x='208' y='132' fill='currentColor' style='font-size:1em'>â‚–</text>
<text text-anchor='middle' x='208' y='148' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='216' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='216' y='84' fill='currentColor' style='font-size:1em'>â‚–</text>
<text text-anchor='middle' x='216' y='116' fill='currentColor' style='font-size:1em'>á¶œ</text>
<text text-anchor='middle' x='216' y='132' fill='currentColor' style='font-size:1em'>á¶œ</text>
<text text-anchor='middle' x='216' y='148' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='224' y='68' fill='currentColor' style='font-size:1em'>ğ­</text>
<text text-anchor='middle' x='224' y='84' fill='currentColor' style='font-size:1em'>á¶œ</text>
<text text-anchor='middle' x='224' y='116' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='224' y='132' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='224' y='148' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='232' y='68' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='232' y='84' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='232' y='100' fill='currentColor' style='font-size:1em'>â¬®</text>
<text text-anchor='middle' x='240' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='240' y='84' fill='currentColor' style='font-size:1em'>ğšº</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='248' y='84' fill='currentColor' style='font-size:1em'>â‚–</text>
<text text-anchor='middle' x='256' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='256' y='84' fill='currentColor' style='font-size:1em'>á¶œ</text>
<text text-anchor='middle' x='264' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='264' y='84' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='280' y='20' fill='currentColor' style='font-size:1em'>|</text>
<text text-anchor='middle' x='288' y='116' fill='currentColor' style='font-size:1em'>ğ</text>
<text text-anchor='middle' x='296' y='20' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='304' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='312' y='20' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='320' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='320' y='84' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='328' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='328' y='84' fill='currentColor' style='font-size:1em'>ğ­</text>
<text text-anchor='middle' x='336' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='336' y='84' fill='currentColor' style='font-size:1em'>â‚–</text>
<text text-anchor='middle' x='344' y='68' fill='currentColor' style='font-size:1em'>ğ­</text>
<text text-anchor='middle' x='344' y='84' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='344' y='100' fill='currentColor' style='font-size:1em'>â¬®</text>
<text text-anchor='middle' x='352' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='352' y='84' fill='currentColor' style='font-size:1em'>ğšº</text>
<text text-anchor='middle' x='360' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='360' y='84' fill='currentColor' style='font-size:1em'>â‚–</text>
<text text-anchor='middle' x='368' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='368' y='84' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='376' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='376' y='116' fill='currentColor' style='font-size:1em'>âŒˆ</text>
<text text-anchor='middle' x='376' y='132' fill='currentColor' style='font-size:1em'>âŒŠ</text>
<text text-anchor='middle' x='384' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='384' y='116' fill='currentColor' style='font-size:1em'>ğ‘</text>
<text text-anchor='middle' x='384' y='132' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='392' y='116' fill='currentColor' style='font-size:1em'>Ê·</text>
<text text-anchor='middle' x='400' y='20' fill='currentColor' style='font-size:1em'>|</text>
<text text-anchor='middle' x='400' y='116' fill='currentColor' style='font-size:1em'>Â²</text>
<text text-anchor='middle' x='408' y='116' fill='currentColor' style='font-size:1em'>á¶œ</text>
<text text-anchor='middle' x='416' y='20' fill='currentColor' style='font-size:1em'>O</text>
<text text-anchor='middle' x='416' y='132' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='424' y='20' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='424' y='116' fill='currentColor' style='font-size:1em'>ğ­</text>
<text text-anchor='middle' x='424' y='132' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='432' y='20' fill='currentColor' style='font-size:1em'>j</text>
<text text-anchor='middle' x='432' y='116' fill='currentColor' style='font-size:1em'>Ê·</text>
<text text-anchor='middle' x='440' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='440' y='116' fill='currentColor' style='font-size:1em'>Â²</text>
<text text-anchor='middle' x='448' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='448' y='84' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='448' y='116' fill='currentColor' style='font-size:1em'>á¶œ</text>
<text text-anchor='middle' x='456' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='456' y='84' fill='currentColor' style='font-size:1em'>ğ›</text>
<text text-anchor='middle' x='456' y='116' fill='currentColor' style='font-size:1em'>âŒ‰</text>
<text text-anchor='middle' x='456' y='132' fill='currentColor' style='font-size:1em'>âŒ‹</text>
<text text-anchor='middle' x='464' y='68' fill='currentColor' style='font-size:1em'>ğ—</text>
<text text-anchor='middle' x='464' y='84' fill='currentColor' style='font-size:1em'>â‚–</text>
<text text-anchor='middle' x='472' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='472' y='84' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='480' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='480' y='84' fill='currentColor' style='font-size:1em'>ğšº</text>
<text text-anchor='middle' x='480' y='100' fill='currentColor' style='font-size:1em'>â¬®</text>
<text text-anchor='middle' x='488' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='488' y='84' fill='currentColor' style='font-size:1em'>â‚–</text>
<text text-anchor='middle' x='496' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='496' y='84' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='504' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='512' y='20' fill='currentColor' style='font-size:1em'>|</text>
</g>

    </svg>
  
</div>
<p>A 3D Gaussian distribution centered at ğ›â‚– with a covariance matrix ğšºâ‚– in the object space
will be projected onto 2D screen through the <strong>splatting</strong> step,
resulting in a 2D Gaussian distribution, with applying the affine transformation approximation for the nonlinear perspective division.</p>
<p>The 3D ray space (or the screen) is constructed <strong>based on</strong> the perspective division (x,y divided by z), which however is non-linear.
Therefore, the projective transformation $Ï•(ğ­')$ (i.e., perspective division + new depth)
converting the <strong>clip</strong> space to the 3D ray space is approximated by a linear mapping:
$Ï•â‚–(ğ­') = Ï•(ğ­â‚–') + ğ‰â‚–â‹…(ğ­' - ğ­â‚–')$,
where ğ­â‚–&rsquo; = ğ›â‚–á¶œ, the mean vector in <strong>clip</strong> space.</p>
<p>The effects of the approximated affine mapping Ï•â‚–(ğ­&rsquo;) are as follows:</p>
<ol>
<li>
<p>The transformed 2D Gaussian&rsquo;s center ğ›â‚–&rsquo; is the <strong>exact</strong> projective transformation Ï•(ğ›â‚–á¶œ),
i.e., Ï•â‚–(ğ­â‚–&rsquo;)=Ï•(ğ­â‚–&rsquo;), without any error, with the 3rd dimension omitted.</p>
$$
   \underset{(3D)}{\bm Î¼â‚–'} = 
   Ï•(\bm Î¼â‚–á¶œ) = \begin{bmatrix} f_xâ‹…Î¼_{k,x}á¶œ/Î¼_{k,z}á¶œ + c_x \\\ f_yâ‹…Î¼_{k,y}á¶œ/Î¼_{k,z}á¶œ + c_y \\\ 
   \sqrt{ {Î¼_{k,x}á¶œ}^2 + {Î¼_{k,y}á¶œ}^2 + {Î¼_{k,z}á¶œ}^2} \end{bmatrix}
   \overset{\text{Omit 3rd dim}}{\longrightarrow} 
   \underset{(2D)}{\bm Î¼â‚–'}=
   \begin{bmatrix} \frac{f_xâ‹…Î¼_{k,x}á¶œ}{Î¼_{k,z}á¶œ} + c_x \\\ \frac{f_yâ‹…Î¼_{k,y}á¶œ}{Î¼_{k,z}á¶œ} + c_y \end{bmatrix}
   $$</li>
<li>
<p>However, the approximated transformation Ï•â‚–(ğ­&rsquo;) of an arbitrary point ğ­&rsquo; around the clip-space 3D Gaussian center ğ­â‚–'
will deviate from the <strong>precise</strong> perspective projections Ï•(ğ­&rsquo;) gradually, as the (ğ­&rsquo; - ğ­â‚–&rsquo;) increases in the approximated mapping:</p>
$$ \begin{aligned}
   Ï•(ğ­') â‰ˆ Ï•â‚–(ğ­') &= Ï•(ğ­â‚–') + ğ‰â‚–â‹…(ğ­' - ğ­â‚–') \\\
   &= \bm Î¼â‚–' + ğ‰â‚–â‹…(ğ­' - ğ­â‚–')
   \end{aligned} $$</li>
<li>
<p>The projected 2x2 covariance matrix on screen is the 3x3 matrix in the ray space: $\bm Î£â‚–' = ğ‰â‚–â‹… ğ‘_{w2c}â‹… \bm Î£â‚–â‹… ğ‘_{w2c}áµ€â‹… ğ‰â‚–áµ€$,
with the 3rd row and column omitted.</p>
</li>
</ol>
<hr>
<p>(2024-01-11)</p>
<p>â­Note: The following $ğ­â‚–$ is the coordinates of a <strong>Gaussian center</strong> in the <strong>camera</strong> space:</p>
$$ğ­â‚– = [^{ğ‘_{w2c} \ ğ­_{w2c}}_{0 \quad\ 1}] â‹…[^{\bm Î¼â‚–}_1]$$<ul>
<li>
<p>where ğ›â‚–Â³á•½Â¹ is the coordinates of the mean vector in world space.</p>
</li>
<li>
<p>$ğ­'$ is the clip coordinates, which is camera coordinates times the <a class="link" href="#ndc-matrix" >projection matrix</a> ğ: $ğ­' = ğğ­$</p>
</li>
<li>
<p>ğ maps the camera-space coordinates to camera film (homogeneous)
and scales for letting the ND Coordinates of points located within the camera frustum range in [-1,1].
With using clip coordinates, points whose w (i.e., z) is smaller than x,y,z are deleted.</p>
</li>
<li>
<p>The approximated projective transformation $Ï•â‚–(ğ­')$ fulfills perspective <strong>division</strong> after frustum clipping.
Therefore, the 2D screen coordinates ${\bm Î¼â‚–'}_{(2D)} = Ï•â‚–(ğ­â‚–')_{(2D)}$ are NDC âˆˆ [-1,1].</p>
</li>
<li>
<p>Then the Gaussian center&rsquo;s ND coordinates are scaled back to the <strong>screen size</strong>, yielding <strong>pixel</strong> coordinates <a class="link" href="#mu-pix" >ğ›â‚–&rsquo;â‚â‚šáµ¢â‚“â‚</a> represented with <strong>clip</strong> coordinates as:</p>
$$
  {ğ›â‚–'}_{(\text{pix})} = 
  \begin{bmatrix}
  (Wâ‹…t_{k,x}'/t_{k,w}' + 1) /2 + c_x \\\  (Hâ‹…t_{k,y}'/t_{k,w}' + 1) / 2 + c_y
  \end{bmatrix} 
  $$<p>This relationship enables propagating gradients from pixel coordinates $\bm Î¼â‚–'â‚â‚šáµ¢â‚“â‚$ to the clip coordinates $ğ­â‚–'$ directly,
without the 2D screen coordinates ${\bm Î¼â‚–'}_{(2D)}$ involved.</p>
</li>
</ul>
<h3 id="center">Center
</h3><p>(2024-01-12)</p>
<p>Because ellipse center ğ›â‚–&rsquo;â‚â‚šáµ¢â‚“â‚ and covariance ğšºâ‚–&rsquo; on the <strong>2D</strong> screen both are functions of 3D Gaussian center ğ­â‚–,
the partial derivatives of the loss w.r.t. ğ­â‚–Â³á•½Â¹ is a sum:</p>
$$
\frac{âˆ‚L}{âˆ‚ğ­â‚–} = \frac{âˆ‚L}{âˆ‚ \bm Î¼â‚–'â‚â‚šáµ¢â‚“â‚} \frac{âˆ‚\bm Î¼â‚–'â‚â‚šáµ¢â‚“â‚}{âˆ‚ğ­â‚–} 
    + \frac{âˆ‚L}{âˆ‚ {\bm Î£â‚–'}_{(2D)}} \frac{âˆ‚ {\bm Î£â‚–'}_{(2D)}}{âˆ‚ğ­â‚–} \\\
$$<ol>
<li>
<p>The partial derivative of 2D Gaussian&rsquo;s mean $\bm Î¼â‚–'â‚â‚šáµ¢â‚“â‚$ w.r.t. the <strong>camera</strong> coordinates of 3D Gaussian center ğ­â‚–:</p>
$$
   \begin{aligned}
   \frac{âˆ‚\bm Î¼â‚–'â‚â‚šáµ¢â‚“â‚}{âˆ‚ğ­â‚–} &= \frac{âˆ‚\bm Î¼â‚–'â‚â‚šáµ¢â‚“â‚}{âˆ‚ {\bm Î¼â‚–'}_{(2D)}} â‹…
   \frac{âˆ‚ {Ï•â‚–(ğ­â‚–')}_{(2D)}}{ğ­â‚–'} â‹… \frac{âˆ‚ğ­â‚–'}{âˆ‚ğ­â‚–} \qquad \text{(Full process)} 
   \\\
   &= \frac{âˆ‚\bm Î¼â‚–'â‚â‚šáµ¢â‚“â‚}{âˆ‚ğ­â‚–'} â‹… \frac{âˆ‚ğ­â‚–'}{âˆ‚ğ­â‚–}  \qquad \text{(Clipâ†’Pix, skip screen coords)} 
   \\\
   &= \frac{1}{2}
   \begin{bmatrix}
   W/t_{k,w}' & 0 & 0 & -Wâ‹…t_{k,x}'/{t_{k,w}'}^2 \\\
   0 & H/t_{k,w}' & 0 & -Hâ‹…t_{k,y}'/{t_{k,w}'}^2
   \end{bmatrix}â‹…
   ğ
   \end{aligned}
   $$<p>Based on the properties of the Frobenius inner product, eq. (23) is obtained.</p>
</li>
<li>
<p>The partial derivative of the 2D Gaussian&rsquo;s covariance ğšºâ‚–&rsquo; w.r.t. the camera coordinates of 3D Gaussian center ğ­â‚–:</p>
$$
   \frac{âˆ‚\bm Î£â‚–'}{âˆ‚ğ­â‚–} = \frac{âˆ‚(ğ‰â‚–â‹… ğ‘_{w2c}â‹… \bm Î£â‚–â‹… ğ‘_{w2c}áµ€â‹… ğ‰â‚–áµ€)_{2D} }{âˆ‚ğ­â‚–}
   $$<p>(2024-01-13) Derivation refers to <a class="link" href="https://zhuanlan.zhihu.com/p/666465701"  target="_blank" rel="noopener"
    >3D Gaussian Splattingä¸­çš„æ•°å­¦æ¨å¯¼ - å…«æ°¨åˆæ°¯åŒ–é’™çš„æ–‡ç«  - çŸ¥ä¹</a></p>
<ol>
<li>
<p>Letting $ğ” = ğ‰â‚–â‹… ğ‘_{w2c}$ (3DGS code refers to it as <code>T</code>.),
the Gaussian covariance ğšºâ‚–&rsquo; in the 3D <strong>ray space</strong> derived from the projective transformation Ï•â‚–(ğ­&rsquo;) is:</p>
$$\bm Î£â‚–' = ğ” â‹… \bm Î£â‚–â‹…ğ”áµ€ = \\\
      \begin{bmatrix} Uâ‚â‚ & Uâ‚â‚‚ & Uâ‚â‚ƒ \\\ Uâ‚‚â‚ & Uâ‚‚â‚‚ & Uâ‚‚â‚ƒ \\\ Uâ‚ƒâ‚ & Uâ‚ƒâ‚‚ & Uâ‚ƒâ‚ƒ \end{bmatrix}
      \begin{bmatrix} Ïƒâ‚â‚ & Ïƒâ‚â‚‚ & Ïƒâ‚â‚ƒ \\\ Ïƒâ‚‚â‚ & Ïƒâ‚‚â‚‚ & Ïƒâ‚‚â‚ƒ \\\ Ïƒâ‚ƒâ‚ & Ïƒâ‚ƒâ‚‚ & Ïƒâ‚ƒâ‚ƒ \end{bmatrix}
      \begin{bmatrix} Uâ‚â‚ & Uâ‚‚â‚ & Uâ‚ƒâ‚ \\\ Uâ‚â‚‚ & Uâ‚‚â‚‚ & Uâ‚ƒâ‚‚ \\\ Uâ‚â‚ƒ & Uâ‚‚â‚ƒ & Uâ‚ƒâ‚ƒ \end{bmatrix} = 
      \\\
      \begin{bmatrix} Uâ‚â‚ & Uâ‚â‚‚ & Uâ‚â‚ƒ \\\ Uâ‚‚â‚ & Uâ‚‚â‚‚ & Uâ‚‚â‚ƒ \\\ Uâ‚ƒâ‚ & Uâ‚ƒâ‚‚ & Uâ‚ƒâ‚ƒ \end{bmatrix}
      \begin{bmatrix}
      \boxed{Ïƒâ‚â‚}Uâ‚â‚+Ïƒâ‚â‚‚Uâ‚â‚‚+Ïƒâ‚â‚ƒUâ‚â‚ƒ & \boxed{Ïƒâ‚â‚}Uâ‚‚â‚+Ïƒâ‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚â‚ƒUâ‚‚â‚ƒ & \boxed{Ïƒâ‚â‚}Uâ‚ƒâ‚+Ïƒâ‚â‚‚Uâ‚ƒâ‚‚+Ïƒâ‚â‚ƒUâ‚ƒâ‚ƒ \\\
      Ïƒâ‚‚â‚Uâ‚â‚+Ïƒâ‚‚â‚‚Uâ‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚â‚ƒ & Ïƒâ‚‚â‚Uâ‚‚â‚+Ïƒâ‚‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚‚â‚ƒ & Ïƒâ‚‚â‚Uâ‚ƒâ‚+Ïƒâ‚‚â‚‚Uâ‚ƒâ‚‚+Ïƒâ‚‚â‚ƒUâ‚ƒâ‚ƒ \\\
      Ïƒâ‚ƒâ‚Uâ‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚â‚‚+Ïƒâ‚ƒâ‚ƒUâ‚â‚ƒ & Ïƒâ‚ƒâ‚Uâ‚‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚‚â‚‚+Ïƒâ‚ƒâ‚ƒUâ‚‚â‚ƒ & Ïƒâ‚ƒâ‚Uâ‚ƒâ‚+Ïƒâ‚ƒâ‚‚Uâ‚ƒâ‚‚+Ïƒâ‚ƒâ‚ƒUâ‚ƒâ‚ƒ
      \end{bmatrix} = \\\
      \Big[ \begin{array}{c|c|c}
      Uâ‚â‚(Ïƒâ‚â‚Uâ‚â‚+Ïƒâ‚â‚‚Uâ‚â‚‚+Ïƒâ‚â‚ƒUâ‚â‚ƒ) + Uâ‚â‚‚(Ïƒâ‚‚â‚Uâ‚â‚+Ïƒâ‚‚â‚‚Uâ‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚â‚ƒ) + Uâ‚â‚ƒ(Ïƒâ‚ƒâ‚Uâ‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚â‚‚+Ïƒâ‚ƒâ‚ƒUâ‚â‚ƒ) & 
      Uâ‚â‚(Ïƒâ‚â‚Uâ‚‚â‚+Ïƒâ‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚â‚ƒUâ‚‚â‚ƒ) + Uâ‚â‚‚(Ïƒâ‚‚â‚Uâ‚‚â‚+Ïƒâ‚‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚‚â‚ƒ) + Uâ‚â‚ƒ(Ïƒâ‚ƒâ‚Uâ‚‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚‚â‚‚+Ïƒâ‚ƒâ‚ƒUâ‚‚â‚ƒ) &
      Uâ‚â‚(Ïƒâ‚â‚Uâ‚ƒâ‚+Ïƒâ‚â‚‚Uâ‚ƒâ‚‚+Ïƒâ‚â‚ƒUâ‚ƒâ‚ƒ) + Uâ‚â‚‚(Ïƒâ‚‚â‚Uâ‚ƒâ‚+Ïƒâ‚‚â‚‚Uâ‚ƒâ‚‚+Ïƒâ‚‚â‚ƒUâ‚ƒâ‚ƒ) + Uâ‚â‚ƒ(Ïƒâ‚ƒâ‚Uâ‚ƒâ‚+Ïƒâ‚ƒâ‚‚Uâ‚ƒâ‚‚+Ïƒâ‚ƒâ‚ƒUâ‚ƒâ‚ƒ)
      \\\
      Uâ‚‚â‚(Ïƒâ‚â‚Uâ‚â‚+Ïƒâ‚â‚‚Uâ‚â‚‚+Ïƒâ‚â‚ƒUâ‚â‚ƒ) + Uâ‚‚â‚‚(Ïƒâ‚‚â‚Uâ‚â‚+Ïƒâ‚‚â‚‚Uâ‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚â‚ƒ) + Uâ‚‚â‚ƒ(Ïƒâ‚ƒâ‚Uâ‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚â‚‚+Ïƒâ‚ƒâ‚ƒUâ‚â‚ƒ) & 
      Uâ‚‚â‚(Ïƒâ‚â‚Uâ‚‚â‚+Ïƒâ‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚â‚ƒUâ‚‚â‚ƒ) + Uâ‚‚â‚‚(Ïƒâ‚‚â‚Uâ‚‚â‚+Ïƒâ‚‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚‚â‚ƒ) + Uâ‚‚â‚ƒ(Ïƒâ‚ƒâ‚Uâ‚‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚‚â‚‚+Ïƒâ‚ƒâ‚ƒUâ‚‚â‚ƒ) &
      Uâ‚‚â‚(Ïƒâ‚â‚Uâ‚ƒâ‚+Ïƒâ‚â‚‚Uâ‚ƒâ‚‚+Ïƒâ‚â‚ƒUâ‚ƒâ‚ƒ) + Uâ‚‚â‚‚(Ïƒâ‚‚â‚Uâ‚ƒâ‚+Ïƒâ‚‚â‚‚Uâ‚ƒâ‚‚+Ïƒâ‚‚â‚ƒUâ‚ƒâ‚ƒ) + Uâ‚‚â‚ƒ(Ïƒâ‚ƒâ‚Uâ‚ƒâ‚+Ïƒâ‚ƒâ‚‚Uâ‚ƒâ‚‚+Ïƒâ‚ƒâ‚ƒUâ‚ƒâ‚ƒ)
      \\\
      Uâ‚ƒâ‚(Ïƒâ‚â‚Uâ‚â‚+Ïƒâ‚â‚‚Uâ‚â‚‚+Ïƒâ‚â‚ƒUâ‚â‚ƒ) + Uâ‚ƒâ‚‚(Ïƒâ‚‚â‚Uâ‚â‚+Ïƒâ‚‚â‚‚Uâ‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚â‚ƒ) + Uâ‚ƒâ‚ƒ(Ïƒâ‚ƒâ‚Uâ‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚â‚‚+Ïƒâ‚ƒâ‚ƒUâ‚â‚ƒ) & 
      Uâ‚ƒâ‚(Ïƒâ‚â‚Uâ‚‚â‚+Ïƒâ‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚â‚ƒUâ‚‚â‚ƒ) + Uâ‚ƒâ‚‚(Ïƒâ‚‚â‚Uâ‚‚â‚+Ïƒâ‚‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚‚â‚ƒ) + Uâ‚ƒâ‚ƒ(Ïƒâ‚ƒâ‚Uâ‚‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚‚â‚‚+Ïƒâ‚ƒâ‚ƒUâ‚‚â‚ƒ) &
      Uâ‚ƒâ‚(Ïƒâ‚â‚Uâ‚ƒâ‚+Ïƒâ‚â‚‚Uâ‚ƒâ‚‚+Ïƒâ‚â‚ƒUâ‚ƒâ‚ƒ) + Uâ‚ƒâ‚‚(Ïƒâ‚‚â‚Uâ‚ƒâ‚+Ïƒâ‚‚â‚‚Uâ‚ƒâ‚‚+Ïƒâ‚‚â‚ƒUâ‚ƒâ‚ƒ) + Uâ‚ƒâ‚ƒ(Ïƒâ‚ƒâ‚Uâ‚ƒâ‚+Ïƒâ‚ƒâ‚‚Uâ‚ƒâ‚‚+Ïƒâ‚ƒâ‚ƒUâ‚ƒâ‚ƒ)
      \end{array} \Big]
      $$<p>The 3rd row and column of the ğšºâ‚–&rsquo; (in the 3D ray space) are omitted due to the orthogonal correspondence between the 3D ray space and the 2D screen (&quot;âŸ¼&quot;).
Thus, ${\bm Î£â‚–'}_{(2D)}$ is only the <strong>upper-left</strong> 2Ã—2 elements of the 3D ğšºâ‚–&rsquo;,
contributing to the gradient of 2D loss $L(ğœâ‚–, oâ‚–, {\bm Î¼â‚–'}_{(2D)}, {\bm Î£â‚–'}_{(2D)})$,
while the remaining 5 elements of ğšºâ‚–&rsquo;â‚â‚ƒâ‚“â‚ƒâ‚ make no contributions.</p>
$$
      {\bm Î£â‚–'}_{(2D)} = \\\
      \left[ \begin{array}{c|c}
      Uâ‚â‚(Ïƒâ‚â‚Uâ‚â‚+Ïƒâ‚â‚‚Uâ‚â‚‚+Ïƒâ‚â‚ƒUâ‚â‚ƒ) + Uâ‚â‚‚(Ïƒâ‚‚â‚Uâ‚â‚+Ïƒâ‚‚â‚‚Uâ‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚â‚ƒ) + Uâ‚â‚ƒ(Ïƒâ‚ƒâ‚Uâ‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚â‚‚+Ïƒâ‚ƒâ‚ƒUâ‚â‚ƒ) & 
      Uâ‚â‚(Ïƒâ‚â‚Uâ‚‚â‚+Ïƒâ‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚â‚ƒUâ‚‚â‚ƒ) + Uâ‚â‚‚(Ïƒâ‚‚â‚Uâ‚‚â‚+Ïƒâ‚‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚‚â‚ƒ) + Uâ‚â‚ƒ(Ïƒâ‚ƒâ‚Uâ‚‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚‚â‚‚+Ïƒâ‚ƒâ‚ƒUâ‚‚â‚ƒ)
      \\\
      Uâ‚‚â‚(Ïƒâ‚â‚Uâ‚â‚+Ïƒâ‚â‚‚Uâ‚â‚‚+Ïƒâ‚â‚ƒUâ‚â‚ƒ) + Uâ‚‚â‚‚(Ïƒâ‚‚â‚Uâ‚â‚+Ïƒâ‚‚â‚‚Uâ‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚â‚ƒ) + Uâ‚‚â‚ƒ(Ïƒâ‚ƒâ‚Uâ‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚â‚‚+Ïƒâ‚ƒâ‚ƒUâ‚â‚ƒ) & 
      Uâ‚‚â‚(Ïƒâ‚â‚Uâ‚‚â‚+Ïƒâ‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚â‚ƒUâ‚‚â‚ƒ) + Uâ‚‚â‚‚(Ïƒâ‚‚â‚Uâ‚‚â‚+Ïƒâ‚‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚‚â‚ƒ) + Uâ‚‚â‚ƒ(Ïƒâ‚ƒâ‚Uâ‚‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚‚â‚‚+Ïƒâ‚ƒâ‚ƒUâ‚‚â‚ƒ)
      \end{array} \right]
      $$<ul>
<li>
<p>Each element of ${\bm Î£â‚–'}_{(2D)}$ is a &ldquo;sub-&rdquo; <strong>function</strong>,
which is taken derivative w.r.t. each variable: Ïƒâ‚â‚, Ïƒâ‚â‚‚, Ïƒâ‚â‚ƒ, Ïƒâ‚‚â‚‚, Ïƒâ‚‚â‚ƒ, Ïƒâ‚ƒâ‚ƒ,
to backpropagate the gradient $\frac{âˆ‚L}{âˆ‚{\bm Î£â‚–'}_{(2D)}}$ to ğšºâ‚–.
(Only these 6 elements of ğšºâ‚– need computation as ğšºâ‚–â‚â‚ƒâ‚“â‚ƒâ‚ is symmetric.)</p>
</li>
<li>
<p>It&rsquo;s not proper to think of the derivative of a &ldquo;matrix&rdquo; w.r.t. a matrix.
Instead, it&rsquo;s better to consider the derivative of a function w.r.t. variables,
as essentially a matrix stands for a linear transformation.</p>
</li>
</ul>
<p>The partial derivative of ${\bm Î£â‚–'}_{(2D)}$ w.r.t. $\bm Î£â‚–$ (the 3D covariance matrix in world space):</p>
$$
      \frac{âˆ‚ {\bm Î£â‚–'}_{(2D)}}{âˆ‚Ïƒâ‚â‚} =
      \begin{bmatrix} Uâ‚â‚Uâ‚â‚ & Uâ‚â‚Uâ‚‚â‚ \\\ Uâ‚‚â‚Uâ‚â‚ & Uâ‚‚â‚Uâ‚‚â‚ \end{bmatrix} = 
      \begin{bmatrix} Uâ‚â‚ \\\ Uâ‚‚â‚ \end{bmatrix} \begin{bmatrix} Uâ‚â‚ & Uâ‚‚â‚ \end{bmatrix}
      \\\
      \frac{âˆ‚ {\bm Î£â‚–'}_{(2D)}}{âˆ‚Ïƒâ‚â‚‚} =
      \begin{bmatrix} Uâ‚â‚Uâ‚â‚‚ & Uâ‚â‚Uâ‚‚â‚‚ \\\ Uâ‚‚â‚Uâ‚â‚‚ & Uâ‚‚â‚Uâ‚‚â‚‚ \end{bmatrix} = 
      \begin{bmatrix} Uâ‚â‚ \\\ Uâ‚‚â‚ \end{bmatrix} \begin{bmatrix} Uâ‚â‚‚ & Uâ‚‚â‚‚ \end{bmatrix}
      \\\
      \frac{âˆ‚ {\bm Î£â‚–'}_{(2D)}}{âˆ‚Ïƒâ‚â‚ƒ} =
      \begin{bmatrix} Uâ‚â‚Uâ‚â‚ƒ & Uâ‚â‚Uâ‚‚â‚ƒ \\\ Uâ‚‚â‚Uâ‚â‚ƒ & Uâ‚‚â‚Uâ‚‚â‚ƒ \end{bmatrix} = 
      \begin{bmatrix} Uâ‚â‚ \\\ Uâ‚‚â‚ \end{bmatrix} \begin{bmatrix} Uâ‚â‚ƒ & Uâ‚‚â‚ƒ \end{bmatrix}
      \\\
      \frac{âˆ‚ {\bm Î£â‚–'}_{(2D)}}{âˆ‚Ïƒâ‚‚â‚‚} =
      \begin{bmatrix} Uâ‚â‚‚Uâ‚â‚‚ & Uâ‚â‚‚Uâ‚‚â‚‚ \\\ Uâ‚‚â‚‚Uâ‚â‚‚ & Uâ‚‚â‚‚Uâ‚‚â‚‚ \end{bmatrix} = 
      \begin{bmatrix} Uâ‚â‚‚ \\\ Uâ‚‚â‚‚ \end{bmatrix} \begin{bmatrix} Uâ‚â‚‚ & Uâ‚‚â‚‚ \end{bmatrix}
      \\\
      \frac{âˆ‚ {\bm Î£â‚–'}_{(2D)}}{âˆ‚Ïƒâ‚‚â‚ƒ} =
      \begin{bmatrix} Uâ‚â‚‚Uâ‚â‚ƒ & Uâ‚â‚‚Uâ‚‚â‚ƒ \\\ Uâ‚‚â‚‚Uâ‚â‚ƒ & Uâ‚‚â‚‚Uâ‚‚â‚ƒ \end{bmatrix} = 
      \begin{bmatrix} Uâ‚â‚‚ \\\ Uâ‚‚â‚‚ \end{bmatrix} \begin{bmatrix} Uâ‚â‚ƒ & Uâ‚‚â‚ƒ \end{bmatrix}
      \\\
      \frac{âˆ‚ {\bm Î£â‚–'}_{(2D)}}{âˆ‚Ïƒâ‚ƒâ‚ƒ} =
      \begin{bmatrix} Uâ‚â‚ƒUâ‚â‚ƒ & Uâ‚â‚ƒUâ‚‚â‚ƒ \\\ Uâ‚‚â‚ƒUâ‚â‚ƒ & Uâ‚‚â‚ƒUâ‚‚â‚ƒ \end{bmatrix} = 
      \begin{bmatrix} Uâ‚â‚ƒ \\\ Uâ‚‚â‚ƒ \end{bmatrix} \begin{bmatrix} Uâ‚â‚ƒ & Uâ‚‚â‚ƒ \end{bmatrix}
      $$<ul>
<li>Ïƒâ‚â‚, Ïƒâ‚‚â‚‚, Ïƒâ‚ƒâ‚ƒ are on the diagonal, while Ïƒâ‚â‚‚, Ïƒâ‚â‚ƒ, Ïƒâ‚‚â‚ƒ are off-diagonal.</li>
</ul>
<p>The partial derivative of the loss L w.r.t. each element of ğšºâ‚–:</p>
$$
      \begin{aligned}
      \frac{âˆ‚L}{âˆ‚ {\bm Î£â‚–'}_{(2D)}} \frac{âˆ‚ {\bm Î£â‚–'}_{(2D)}}{âˆ‚Ïƒâ‚â‚}
      &= âˆ‘_{row}âˆ‘_{col}{ 
      \begin{bmatrix} \frac{âˆ‚L}{âˆ‚a} & \frac{âˆ‚L}{âˆ‚b} \\\ \frac{âˆ‚L}{âˆ‚b} & \frac{âˆ‚L}{âˆ‚c} \end{bmatrix} 
      âŠ™
      \begin{bmatrix} Uâ‚â‚Uâ‚â‚ & Uâ‚â‚Uâ‚‚â‚ \\\ Uâ‚‚â‚Uâ‚â‚ & Uâ‚‚â‚Uâ‚‚â‚ \end{bmatrix} } \\\
      &= \frac{âˆ‚L}{âˆ‚a} Uâ‚â‚Uâ‚â‚ + 2Ã— \frac{âˆ‚L}{âˆ‚b} Uâ‚â‚Uâ‚‚â‚ + \frac{âˆ‚L}{âˆ‚c} Uâ‚‚â‚Uâ‚‚â‚
      \\\
      \frac{âˆ‚L}{âˆ‚ {\bm Î£â‚–'}_{(2D)}} \frac{âˆ‚ {\bm Î£â‚–'}_{(2D)}}{âˆ‚Ïƒâ‚â‚‚}
      &= âˆ‘_{row}âˆ‘_{col}{ 
      \begin{bmatrix} \frac{âˆ‚L}{âˆ‚a} & \frac{âˆ‚L}{âˆ‚b} \\\ \frac{âˆ‚L}{âˆ‚b} & \frac{âˆ‚L}{âˆ‚c} \end{bmatrix} 
      âŠ™
      \begin{bmatrix} Uâ‚â‚Uâ‚â‚‚ & Uâ‚â‚Uâ‚‚â‚‚ \\\ Uâ‚‚â‚Uâ‚â‚‚ & Uâ‚‚â‚Uâ‚‚â‚‚ \end{bmatrix} } \\\
      &= \frac{âˆ‚L}{âˆ‚a} Uâ‚â‚Uâ‚â‚‚ + \frac{âˆ‚L}{âˆ‚b} Uâ‚â‚Uâ‚‚â‚‚ +\frac{âˆ‚L}{âˆ‚b}Uâ‚‚â‚Uâ‚â‚‚ + \frac{âˆ‚L}{âˆ‚c} Uâ‚‚â‚Uâ‚‚â‚‚
      \end{aligned}
      $$<ul>
<li>
<p>âŠ™ is Hadamard product (element-wise product). $âˆ‘_{row}âˆ‘_{col}$ means summation of all elements in the matrix.</p>
<p>(2024-02-17) <a id="combine-grad"></a>
In this step, the derivative w.r.t. a matrix is determined by calculating the derivative w.r.t. <strong>each element</strong> individually,
rather than the <strong>entire matrix</strong>. Thus, the multiplication between two &ldquo;derivative matrices&rdquo; is hadamard product,
as essentially it&rsquo;s the derivative w.r.t. a single <strong>scalar</strong> (in contrast to vector or matrix).
However, for example, if $\frac{âˆ‚\bm Î£}{âˆ‚ğŒ}$ is the derivative of ğšº w.r.t. the <strong>matrix</strong> ğŒ,
the multiplication with the incoming upstream &ldquo;derivative matrix&rdquo; should be a normal matmul.</p>
<p>Within a chain of differentiation, the 2 manners of solving derivative for a matrix
by computing the derivative for the entire matrix or calculating the derivative for each element can coexist simultaneously.</p>
</li>
<li>
<p>Note: The $\frac{âˆ‚L}{âˆ‚b}$ in the <a class="link" href="https://github.com/graphdeco-inria/diff-gaussian-rasterization/blob/59f5f77e3ddbac3ed9db93ec2cfe99ed6c5d121d/cuda_rasterizer/backward.cu#L205-L228"  target="_blank" rel="noopener"
    >3DGS code</a> has been doubled.
And each off-diagonal element is multiplied by 2, as the symmetrical element has the same gradient contribution.</p>
</li>
</ul>
<p>In 3DGS code, the derivative of loss w.r.t. each element of 3D covariance matrix ğšºâ‚–â‚â‚ƒâ‚“â‚ƒâ‚ in the world space is computed individually:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">dL_da</span> <span class="o">=</span> <span class="n">denom2inv</span> <span class="o">*</span> <span class="p">(...);</span>
</span></span><span class="line"><span class="cl"><span class="n">dL_dc</span> <span class="o">=</span> <span class="n">denom2inv</span> <span class="o">*</span> <span class="p">(...);</span>
</span></span><span class="line"><span class="cl"><span class="n">dL_db</span> <span class="o">=</span> <span class="n">denom2inv</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(...);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dL_dcov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dL_da</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dL_db</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dL_dc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">dL_dcov</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dL_da</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dL_db</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dL_dc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">dL_dcov</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dL_da</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dL_db</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dL_dc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dL_dcov</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dL_da</span> <span class="o">+</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">dL_db</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dL_dc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dL_dcov</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dL_da</span> <span class="o">+</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">dL_db</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dL_dc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dL_dcov</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dL_da</span> <span class="o">+</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">dL_db</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dL_dc</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The 2D covariance matrix ${\bm Î£â‚–'}_{(2D)}$ is <strong>Not equivalent</strong> to the calculation
where the 3rd row and column of ğšºâ‚– are omitted from the <strong>beginning</strong>,
because Ïƒâ‚â‚ƒ, Ïƒâ‚‚â‚ƒ, Ïƒâ‚ƒâ‚ƒ are also involved in the projected covariance ğšºâ‚–&rsquo;.
However, the derivatives w.r.t. them
($\frac{âˆ‚ {\bm Î£â‚–'}_{(2D)}}{âˆ‚Ïƒâ‚â‚ƒ},\ \frac{âˆ‚ {\bm Î£â‚–'}_{(2D)}}{âˆ‚Ïƒâ‚‚â‚ƒ},\ \frac{âˆ‚ {\bm Î£â‚–'}_{(2D)}}{âˆ‚Ïƒâ‚ƒâ‚ƒ}$)
can&rsquo;t be derived from the following expression:</p>
$$
      \begin{aligned}
      {\bm Î£â‚–'}_{(2D)} &= 
      \begin{bmatrix} Uâ‚â‚ & Uâ‚â‚‚ \\\ Uâ‚‚â‚ & Uâ‚‚â‚‚ \end{bmatrix}
      \begin{bmatrix} Ïƒâ‚â‚ & Ïƒâ‚â‚‚ \\\ Ïƒâ‚‚â‚ & Ïƒâ‚‚â‚‚ \end{bmatrix}
      \begin{bmatrix} Uâ‚â‚ & Uâ‚‚â‚ \\\  Uâ‚â‚‚& Uâ‚‚â‚‚ \end{bmatrix} \\\
      &= \begin{bmatrix}
      (Uâ‚â‚Ïƒâ‚â‚ + Uâ‚â‚‚Ïƒâ‚‚â‚)Uâ‚â‚ + (Uâ‚â‚Ïƒâ‚â‚‚ + Uâ‚â‚‚Ïƒâ‚‚â‚‚) Uâ‚â‚‚ &
      (Uâ‚â‚Ïƒâ‚â‚ + Uâ‚â‚‚Ïƒâ‚‚â‚)Uâ‚‚â‚ + (Uâ‚â‚Ïƒâ‚â‚‚ + Uâ‚â‚‚Ïƒâ‚‚â‚‚) Uâ‚‚â‚‚ \\\
      (Uâ‚‚â‚Ïƒâ‚â‚ + Uâ‚‚â‚‚Ïƒâ‚‚â‚)Uâ‚â‚ + (Uâ‚‚â‚Ïƒâ‚â‚‚ + Uâ‚‚â‚‚Ïƒâ‚‚â‚‚) Uâ‚â‚‚ &
      (Uâ‚‚â‚Ïƒâ‚â‚ + Uâ‚‚â‚‚Ïƒâ‚‚â‚)Uâ‚‚â‚ + (Uâ‚‚â‚Ïƒâ‚â‚‚ + Uâ‚‚â‚‚Ïƒâ‚‚â‚‚) Uâ‚‚â‚‚ 
      \end{bmatrix}
      \end{aligned}
      $$</li>
<li>
<p>The partial derivative of the 2D Gaussian covariance matrix ${\bm Î£â‚–'}_{(2D)}$
w.r.t. the 3D Gaussian center ğ­â‚– in the camera space:</p>
$$
      \begin{aligned}
      \frac{âˆ‚ {\bm Î£â‚–'}_{(2D)}}{âˆ‚ğ”â‚–} \frac{âˆ‚ğ”â‚–}{âˆ‚ğ­â‚–}
      = \frac{âˆ‚ğ”â‚– {\bm Î£â‚–}_{(3D)} ğ”â‚–áµ€}{âˆ‚ğ”â‚–}
        \frac{âˆ‚(ğ‰â‚–â‹… ğ‘_{w2c})}{âˆ‚ğ­â‚–} \\\
      \end{aligned}
      $$<ul>
<li>
<p>$\frac{âˆ‚ğ”â‚– {\bm Î£â‚–}_{(3D)} ğ”â‚–áµ€}{âˆ‚ğ”â‚–}$
(corresponding to $\frac{âˆ‚\bm Î£â‚–'}{âˆ‚T}$ inside $\frac{âˆ‚L}{âˆ‚T}$ of eq.(25) in the gsplat paper.)</p>
$$
        \begin{aligned}
        \frac{âˆ‚ğ”â‚– {\bm Î£â‚–}_{(3D)} ğ”â‚–áµ€}{âˆ‚Uâ‚â‚} &= 
        \begin{bmatrix}
        2Ïƒâ‚â‚Uâ‚â‚+(Ïƒâ‚â‚‚+Ïƒâ‚‚â‚)Uâ‚â‚‚+(Ïƒâ‚â‚ƒ+Ïƒâ‚ƒâ‚)Uâ‚â‚ƒ & Ïƒâ‚â‚Uâ‚‚â‚+Ïƒâ‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚â‚ƒUâ‚‚â‚ƒ & Ïƒâ‚â‚Uâ‚ƒâ‚+Ïƒâ‚â‚‚Uâ‚ƒâ‚‚+Ïƒâ‚â‚ƒUâ‚ƒâ‚ƒ \\\
        Ïƒâ‚â‚Uâ‚‚â‚ + Ïƒâ‚‚â‚Uâ‚‚â‚‚ + Ïƒâ‚ƒâ‚Uâ‚‚â‚ƒ  & 0 & 0 \\\
        Ïƒâ‚â‚Uâ‚ƒâ‚ + Ïƒâ‚‚â‚Uâ‚ƒâ‚‚ + Ïƒâ‚ƒâ‚Uâ‚ƒâ‚ƒ &  0   &   0
        \end{bmatrix}
        \\\ 
        \frac{âˆ‚ğ”â‚– {\bm Î£â‚–}_{(3D)} ğ”â‚–áµ€}{âˆ‚Uâ‚â‚‚} &= 
        \begin{bmatrix}
        Uâ‚â‚Ïƒâ‚â‚‚+Ïƒâ‚‚â‚Uâ‚â‚+2Ïƒâ‚‚â‚‚Uâ‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚â‚ƒ +Uâ‚â‚ƒÏƒâ‚ƒâ‚‚ & Ïƒâ‚‚â‚Uâ‚‚â‚+Ïƒâ‚‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚‚â‚ƒ & Ïƒâ‚‚â‚Uâ‚ƒâ‚+Ïƒâ‚‚â‚‚Uâ‚ƒâ‚‚+Ïƒâ‚‚â‚ƒUâ‚ƒâ‚ƒ \\\
        Uâ‚‚â‚Ïƒâ‚â‚‚ + Uâ‚‚â‚‚Ïƒâ‚‚â‚‚+Uâ‚‚â‚ƒÏƒâ‚ƒâ‚‚ & 0 & 0 \\\
        Uâ‚ƒâ‚Ïƒâ‚â‚‚ + Uâ‚ƒâ‚‚Ïƒâ‚‚â‚‚+Uâ‚ƒâ‚ƒÏƒâ‚ƒâ‚‚ & 0 & 0
        \end{bmatrix}
        \\\
        \frac{âˆ‚ğ”â‚– {\bm Î£â‚–}_{(3D)} ğ”â‚–áµ€}{âˆ‚Uâ‚â‚ƒ} &= 
        \begin{bmatrix}
        Uâ‚â‚Ïƒâ‚â‚ƒ+Uâ‚â‚‚Ïƒâ‚‚â‚ƒ+Ïƒâ‚ƒâ‚Uâ‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚â‚‚+2Ïƒâ‚ƒâ‚ƒUâ‚â‚ƒ & Ïƒâ‚ƒâ‚Uâ‚‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚‚â‚‚+Ïƒâ‚ƒâ‚ƒUâ‚‚â‚ƒ & Ïƒâ‚ƒâ‚Uâ‚ƒâ‚+Ïƒâ‚ƒâ‚‚Uâ‚ƒâ‚‚+Ïƒâ‚ƒâ‚ƒUâ‚ƒâ‚ƒ \\\
        Uâ‚‚â‚Ïƒâ‚â‚ƒ+Uâ‚‚â‚‚Ïƒâ‚‚â‚ƒ+Uâ‚‚â‚ƒÏƒâ‚ƒâ‚ƒ & 0 & 0 \\\
        Uâ‚ƒâ‚Ïƒâ‚â‚ƒ+Uâ‚ƒâ‚‚Ïƒâ‚‚â‚ƒ+Uâ‚ƒâ‚ƒÏƒâ‚ƒâ‚ƒ & 0 & 0
        \end{bmatrix}
        \\\
        \\\
        \frac{âˆ‚ğ”â‚– {\bm Î£â‚–}_{(3D)} ğ”â‚–áµ€}{âˆ‚Uâ‚‚â‚} &= 
        \begin{bmatrix}
        0 & Uâ‚â‚Ïƒâ‚â‚+Uâ‚â‚‚Ïƒâ‚‚â‚+Uâ‚â‚ƒÏƒâ‚ƒâ‚ & 0 \\\
        Ïƒâ‚â‚Uâ‚â‚+Ïƒâ‚â‚‚Uâ‚â‚‚+Ïƒâ‚â‚ƒUâ‚â‚ƒ & 2Ïƒâ‚â‚Uâ‚‚â‚+Ïƒâ‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚â‚ƒUâ‚‚â‚ƒ+Uâ‚‚â‚‚Ïƒâ‚‚â‚+Uâ‚‚â‚ƒÏƒâ‚ƒâ‚ & Ïƒâ‚â‚Uâ‚ƒâ‚+Ïƒâ‚â‚‚Uâ‚ƒâ‚‚+Ïƒâ‚â‚ƒUâ‚ƒâ‚ƒ \\\
        0 &  Uâ‚ƒâ‚Ïƒâ‚â‚+Uâ‚ƒâ‚‚Ïƒâ‚‚â‚+Uâ‚ƒâ‚ƒÏƒâ‚ƒâ‚ & 0
        \end{bmatrix}
        \\\
        \frac{âˆ‚ğ”â‚– {\bm Î£â‚–}_{(3D)} ğ”â‚–áµ€}{âˆ‚Uâ‚‚â‚‚} &= 
        \begin{bmatrix}
        0 & Uâ‚â‚Ïƒâ‚â‚‚+Uâ‚â‚‚Ïƒâ‚‚â‚‚+Uâ‚â‚ƒÏƒâ‚ƒâ‚‚ & 0 \\\
        Ïƒâ‚‚â‚Uâ‚â‚+Ïƒâ‚‚â‚‚Uâ‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚â‚ƒ & Uâ‚‚â‚Ïƒâ‚â‚‚+Ïƒâ‚‚â‚Uâ‚‚â‚+2Ïƒâ‚‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚‚â‚ƒ+Uâ‚‚â‚ƒÏƒâ‚ƒâ‚‚ & Ïƒâ‚‚â‚Uâ‚ƒâ‚+Ïƒâ‚‚â‚‚Uâ‚ƒâ‚‚+Ïƒâ‚‚â‚ƒUâ‚ƒâ‚ƒ \\\
        0 & Uâ‚ƒâ‚Ïƒâ‚â‚‚+Uâ‚ƒâ‚‚Ïƒâ‚‚â‚‚+Uâ‚ƒâ‚ƒÏƒâ‚ƒâ‚‚ & 0
        \end{bmatrix}
        \\\
        \frac{âˆ‚ğ”â‚– {\bm Î£â‚–}_{(3D)} ğ”â‚–áµ€}{âˆ‚Uâ‚‚â‚ƒ} &= 
        \begin{bmatrix}
        0 & Uâ‚â‚Ïƒâ‚â‚ƒ+Uâ‚â‚‚Ïƒâ‚‚â‚ƒ+Uâ‚â‚ƒÏƒâ‚ƒâ‚ƒ & 0 \\\
        Ïƒâ‚ƒâ‚Uâ‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚â‚‚+Ïƒâ‚ƒâ‚ƒUâ‚â‚ƒ & Uâ‚‚â‚Ïƒâ‚â‚ƒ+Uâ‚‚â‚‚Ïƒâ‚‚â‚ƒ+Ïƒâ‚ƒâ‚Uâ‚‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚‚â‚‚+2Ïƒâ‚ƒâ‚ƒUâ‚‚â‚ƒ & Ïƒâ‚ƒâ‚Uâ‚ƒâ‚+Ïƒâ‚ƒâ‚‚Uâ‚ƒâ‚‚+Ïƒâ‚ƒâ‚ƒUâ‚ƒâ‚ƒ \\\
        0 & Uâ‚ƒâ‚Ïƒâ‚â‚ƒ+Uâ‚ƒâ‚‚Ïƒâ‚‚â‚ƒ+Uâ‚ƒâ‚ƒÏƒâ‚ƒâ‚ƒ & 0
        \end{bmatrix}
        \\\
        \\\
        \frac{âˆ‚ğ”â‚– {\bm Î£â‚–}_{(3D)} ğ”â‚–áµ€}{âˆ‚Uâ‚ƒâ‚} &= 
        \begin{bmatrix}
        0 & 0 & Uâ‚â‚Ïƒâ‚â‚+Uâ‚â‚‚Ïƒâ‚‚â‚+Uâ‚â‚ƒÏƒâ‚ƒâ‚ \\\
        0 & 0 & Uâ‚‚â‚Ïƒâ‚â‚+Uâ‚‚â‚‚Ïƒâ‚‚â‚+Uâ‚‚â‚ƒÏƒâ‚ƒâ‚ \\\
        Ïƒâ‚â‚Uâ‚â‚+Ïƒâ‚â‚‚Uâ‚â‚‚+Ïƒâ‚â‚ƒUâ‚â‚ƒ & Ïƒâ‚â‚Uâ‚‚â‚+Ïƒâ‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚â‚ƒUâ‚‚â‚ƒ & 2Ïƒâ‚â‚Uâ‚ƒâ‚+Ïƒâ‚â‚‚Uâ‚ƒâ‚‚+Ïƒâ‚â‚ƒUâ‚ƒâ‚ƒ+ Uâ‚ƒâ‚‚Ïƒâ‚‚â‚ + Uâ‚ƒâ‚ƒÏƒâ‚ƒâ‚ \\\
        \end{bmatrix}
        \\\
        \frac{âˆ‚ğ”â‚– {\bm Î£â‚–}_{(3D)} ğ”â‚–áµ€}{âˆ‚Uâ‚ƒâ‚‚} &= 
        \begin{bmatrix}
        0 & 0 & Uâ‚â‚Ïƒâ‚â‚‚+Uâ‚â‚‚Ïƒâ‚‚â‚‚+Uâ‚â‚ƒÏƒâ‚ƒâ‚‚ \\\
        0 & 0 & Uâ‚‚â‚Ïƒâ‚â‚‚+Uâ‚‚â‚‚Ïƒâ‚‚â‚‚+Uâ‚‚â‚ƒÏƒâ‚ƒâ‚‚ \\\
        Ïƒâ‚‚â‚Uâ‚â‚+Ïƒâ‚‚â‚‚Uâ‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚â‚ƒ & Ïƒâ‚‚â‚Uâ‚‚â‚+Ïƒâ‚‚â‚‚Uâ‚‚â‚‚+Ïƒâ‚‚â‚ƒUâ‚‚â‚ƒ & Uâ‚ƒâ‚Ïƒâ‚â‚‚+ Ïƒâ‚‚â‚Uâ‚ƒâ‚+2Ïƒâ‚‚â‚‚Uâ‚ƒâ‚‚+Ïƒâ‚‚â‚ƒUâ‚ƒâ‚ƒ+ Uâ‚ƒâ‚ƒÏƒâ‚ƒâ‚‚  \\\
        \end{bmatrix}
        \\\
        \frac{âˆ‚ğ”â‚– {\bm Î£â‚–}_{(3D)} ğ”â‚–áµ€}{âˆ‚Uâ‚ƒâ‚ƒ} &= 
        \begin{bmatrix}
        0 & 0 & Uâ‚â‚Ïƒâ‚â‚ƒ+Uâ‚â‚‚Ïƒâ‚‚â‚ƒ+Uâ‚â‚ƒÏƒâ‚ƒâ‚ƒ \\\
        0 & 0 & Uâ‚‚â‚Ïƒâ‚â‚ƒ+Uâ‚‚â‚‚Ïƒâ‚‚â‚ƒ+Uâ‚‚â‚ƒÏƒâ‚ƒâ‚ƒ \\\
        Ïƒâ‚ƒâ‚Uâ‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚â‚‚+Ïƒâ‚ƒâ‚ƒUâ‚â‚ƒ & Ïƒâ‚ƒâ‚Uâ‚‚â‚+Ïƒâ‚ƒâ‚‚Uâ‚‚â‚‚+Ïƒâ‚ƒâ‚ƒUâ‚‚â‚ƒ & Uâ‚ƒâ‚Ïƒâ‚â‚ƒ + Uâ‚ƒâ‚‚Ïƒâ‚‚â‚ƒ + Ïƒâ‚ƒâ‚Uâ‚ƒâ‚+Ïƒâ‚ƒâ‚‚Uâ‚ƒâ‚‚+2Ïƒâ‚ƒâ‚ƒUâ‚ƒâ‚ƒ \\\
        \end{bmatrix}
        \end{aligned}
        $$</li>
</ul>
<ul>
<li>
<p>$\frac{âˆ‚ğ”â‚–}{âˆ‚ğ­â‚–} = \frac{âˆ‚(ğ‰â‚–â‹… ğ‘_{w2c})}{âˆ‚ğ­â‚–} = \frac{âˆ‚ğ‰â‚–}{âˆ‚ğ­â‚–}â‹… ğ‘_{w2c} + \cancel{ ğ‰â‚–â‹…\frac{âˆ‚ğ‘_{w2c}}{âˆ‚ğ­â‚–} }$,</p>
<p>(2024-01-16)</p>
<p>The derivative of ğ‰â‚– w.r.t. the camera-space center ğ­â‚– could be obtained from the representation of ğ‰â‚– in terms of ğ­â‚–,
which includes <strong>focals</strong> fx,fy more than the representation with <strong>clip coordinates</strong> ğ­â‚–&rsquo;.
In this way, the projection matrix P isn&rsquo;t involved as ğ­â‚–&rsquo;=ğğ­â‚–.</p>
$$
        ğ‰_{ğ­â‚–} = \begin{bmatrix}
        fâ‚“/t_{k,z} & 0 & -fâ‚“ t_{k,x} / {t_{k,z}}^2  \\\
        0  & f_y/t_{k,z} & -f_y t_{k,y} / {t_{k,z}}^2  \\\
        t_{k,x}/â€–ğ­â‚–â€– & t_{k,y}/â€–ğ­â‚–â€– & t_{k,z}/â€–ğ­â‚–â€–
        \end{bmatrix}
        $$<p>The derivative of $ğ‰_{ğ­â‚–}$ w.r.t. each component of ğ­â‚–:</p>
$$
        \begin{aligned}
        \frac{âˆ‚ğ‰_{ğ­â‚–}}{âˆ‚t_{k,x}} = \begin{bmatrix}
        0 & 0 & -f_x/t_{k,z}Â² \\\ 0 & 0 & 0 \\\ 
        1/â€–ğ­â‚–â€– - t_{k,x}^2/â€–ğ­â‚–â€–^3 & -t_{k,y}t_{k,x}/â€–ğ­â‚–â€–^3 & -t_{k,z}t_{k,x}/â€–ğ­â‚–â€–^3
        \end{bmatrix}
        \\\
        \frac{âˆ‚ğ‰_{ğ­â‚–}}{âˆ‚t_{k,y}} = \begin{bmatrix}
        0 & 0 & 0 \\\ 0 & 0 & -f_y/t_{k,z}^2 \\\ 
        -t_{k,x}t_{k,y}/â€–ğ­â‚–â€–^3 & 1/â€–ğ­â‚–â€– - t_{k,y}^2/â€–ğ­â‚–â€–^3 & -t_{k,z}t_{k,y}/â€–ğ­â‚–â€–^3
        \end{bmatrix}
        \\\
        \frac{âˆ‚ğ‰_{ğ­â‚–}}{âˆ‚t_{k,z}} = \begin{bmatrix}
        -f_x/t_{k,z}^2 & 0 & 2 f_x t_{k,x}/t_{k,z}^3 \\\
        0 & -f_y/t_{k,z}^2 & 2 f_y t_{k,y}/t_{k,z}^3 \\\
        -t_{k,x}t_{k,z}/â€–ğ­â‚–â€–^3 & -t_{k,y}t_{k,z}/â€–ğ­â‚–â€–^3 & 1/â€–ğ­â‚–â€– - t_{k,z}^2/â€–ğ­â‚–â€–^3
        \end{bmatrix}
        \end{aligned}
        $$</li>
<li>
<p>The derivative of ğšºâ‚–&rsquo; w.r.t. ğ­â‚–</p>
<p>(2024-01-17)</p>
$$
        \begin{aligned}
        \frac{âˆ‚ {\bm Î£â‚–'}_{(2D)}}{âˆ‚ğ”â‚–} \frac{âˆ‚ğ”â‚–}{âˆ‚t_{k,x}}
        \end{aligned}
        $$</li>
</ul>
</li>
</ol>
</li>
</ol>
<hr>
<p>Based on the projective projection $Ï•(ğ­) â‰ˆ Ï•(ğ­â‚–) + ğ‰â‚–â‹…(ğ­ - ğ­â‚–)$,</p>
<p>where</p>
<ul>
<li>
<p>The extrinsics of camera: $ğ“_{w2c} = [^{ğ‘_{w2c} \ ğ­_{w2c}}_{0 \quad\ 1}]$</p>
</li>
<li>
<p>ğ­ is the mean vector represented in the <strong>camera space</strong>:
$ğ­ = ğ“_{w2c} â‹…[^{\bm Î¼â‚–}_1]$</p>
</li>
<li>
<p>The Jacobian of the projective transformation evaluated at ğ›â‚–:</p>
$$ğ‰â‚– = \begin{bmatrix}  fâ‚“/Î¼_{k,z} & 0 & -fâ‚“ Î¼â‚“ / Î¼_{k,z}^2  \\\
  0 & f_y/Î¼_{k,z} & -f_y Î¼_y / Î¼_{k,z}^2  \\\
  Î¼â‚–â‚“/â€–\bm Î¼â‚–â€–â‚‚ & Î¼_{k,y}/â€–\bm Î¼â‚–â€–â‚‚ & Î¼_{k,z}/â€–\bm Î¼â‚–â€–â‚‚  \end{bmatrix}
  $$</li>
</ul>
<p>Therefore, the partial derivatives of the loss w.r.t.</p>
<ol>
<li>
<p>The partial derivative of the loss ğ“› w.r.t. the 3D Gaussian center ğ­ in the world space:</p>
$$
   \frac{âˆ‚L}{âˆ‚ğ­} = \frac{âˆ‚L}{âˆ‚\bm Î¼'} \frac{âˆ‚\bm Î¼'}{âˆ‚ğ­} 
       + \frac{âˆ‚L}{âˆ‚ {\bm Î£â‚–'}_{(2D)}} \frac{âˆ‚ {\bm Î£â‚–'}_{2D}}{âˆ‚ğ­}
   $$</li>
<li>
<p>The partial derivative of the loss ğ“› w.r.t. the 3D Gaussian covariance matrix ğšºâ‚– in the world space:</p>
$$
   \frac{âˆ‚L}{âˆ‚\bm Î£â‚–} = \frac{âˆ‚L}{âˆ‚ {\bm Î£â‚–'}_{(2D)}} \frac{âˆ‚ {\bm Î£â‚–'}_{(2D)}}{âˆ‚\bm Î£â‚–}
   $$</li>
</ol>
<hr>
<hr>
<h3 id="covariance">Covariance
</h3><p>Because covariance matrix is <strong>symmetric</strong> (ğšºâ‚– = ğšºâ‚–áµ€),
it&rsquo;s a square matrix, so it&rsquo;s <a class="link" href="https://en.wikipedia.org/wiki/Diagonalizable_matrix"  target="_blank" rel="noopener"
    >diagonalizable</a></p>
<p>&ldquo;Diagonalizable matrix ğ€ can be represented as: ğ€ = ğğƒğâ»Â¹.&rdquo;</p>
<p>&ldquo;A diagonalizable matrix ğ€ <u>may</u> (?) be decomposed as ğ€=ğğš²ğáµ€&rdquo;</p>
<p>&ldquo;Quadratic form can be regarded as a generalization of conic sections.&rdquo;
<a class="link" href="https://en.wikipedia.org/wiki/Symmetric_matrix#Hessian"  target="_blank" rel="noopener"
    >Symmetric matrix</a></p>
<hr>
<p>Since the covariance matrix ğšº is a symmetric matrix, its eigenvalues are all real.
By arranging all its eigenvectors and eigenvalues into matrices, there is:</p>
$$\bm Î£ ğ• = ğ• ğ‹$$<ul>
<li>
<p>where each column in ğ• is an eigenvector, which are orthogonal to each other.</p>
</li>
<li>
<p>ğ‹ is a diagonal matrix. For example:</p>
$$
  \bm Î£ ğ• = ğ• ğ‹ = 
  \begin{bmatrix}
  a & d & g \\\ b & e & h \\\ c & f & j
  \end{bmatrix}
  \begin{bmatrix}
  1 & 0 & 0 \\\ 0 & 2 & 0 \\\ 0 & 0 & 3
  \end{bmatrix} = 
  \begin{bmatrix}
  a & 2d & 3g \\\ b & 2e & 3h \\\ c & 2f & 3j
  \end{bmatrix}
  $$</li>
<li>
<p>If ğ• is invertible, ğšº can be represented as ğšº=ğ•ğ‹ğ•â»Â¹</p>
</li>
</ul>
<p>The eigenvectors matrix ğ• and eigenvalues matrix ğ‹ corresponds to the rotation matrix ğ‘ and the stretching matrix ğ’ squared,
which are solved from SVD: ğšº=ğ‘ğ’ğ’áµ€ğ‘áµ€.</p>
<p>The rotation matrix rotates the original space to a new basis, where each axis points in the direction of the <strong>highest</strong> variance,
i.e., the eigenvectors.
And the stretching matrix indicates the <strong>magnitude</strong> of variance along each axis, i.e., the square root of the eigenvalues $\sqrt{ğ‹}$.
<a class="link" href="https://janakiev.com/blog/covariance-matrix/"  target="_blank" rel="noopener"
    >janakiev-Blog</a></p>
<p>After obtaining the magnitude of the variance in each direction,
the <strong>extent</strong> range on each axis can be calculated based on the standard deviation
according to the <a class="link" href="https://en.wikipedia.org/wiki/68%E2%80%9395%E2%80%9399.7_rule"  target="_blank" rel="noopener"
    >3-sigma rule</a>.</p>
<p>To optimize the 3D Gaussians in the <strong>world</strong> space based on rendered image, the derivative chain is like:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 408 57"
      >
      <g transform='translate(8,16)'>
<path d='M 40,32 L 56,32' fill='none' stroke='currentColor'></path>
<path d='M 144,32 L 152,32' fill='none' stroke='currentColor'></path>
<path d='M 248,32 L 256,32' fill='none' stroke='currentColor'></path>
<path d='M 328,32 L 336,32' fill='none' stroke='currentColor'></path>
<polygon points='64.000000,32.000000 52.000000,26.400000 52.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 56.000000, 32.000000)'></polygon>
<polygon points='160.000000,32.000000 148.000000,26.400000 148.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 152.000000, 32.000000)'></polygon>
<polygon points='264.000000,32.000000 252.000000,26.400000 252.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 256.000000, 32.000000)'></polygon>
<polygon points='344.000000,32.000000 332.000000,26.400000 332.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 336.000000, 32.000000)'></polygon>
<text text-anchor='middle' x='0' y='4' fill='currentColor' style='font-size:1em'>I</text>
<text text-anchor='middle' x='0' y='36' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='8' y='4' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='8' y='36' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='16' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='16' y='36' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='24' y='4' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='24' y='36' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='32' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='56' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='56' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='64' y='4' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='72' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='72' y='36' fill='currentColor' style='font-size:1em'>ğšº</text>
<text text-anchor='middle' x='80' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='80' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='80' y='36' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='88' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='88' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='96' y='4' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='96' y='36' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='104' y='36' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='112' y='36' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='120' y='36' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='160' y='4' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='160' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='168' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='176' y='4' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='176' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='176' y='36' fill='currentColor' style='font-size:1em'>ğšº</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='184' y='36' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='192' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='200' y='36' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='208' y='36' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='216' y='36' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='224' y='36' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='272' y='4' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='272' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='280' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='280' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='288' y='4' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='288' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='296' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='296' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='296' y='36' fill='currentColor' style='font-size:1em'>ğšº</text>
<text text-anchor='middle' x='304' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='304' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='312' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='360' y='4' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='360' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='368' y='4' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='368' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='368' y='36' fill='currentColor' style='font-size:1em'>ğšº</text>
<text text-anchor='middle' x='376' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='376' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='384' y='4' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='384' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='392' y='4' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='392' y='20' fill='currentColor' style='font-size:1em'>e</text>
</g>

    </svg>
  
</div>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/splatting/">Splatting</a>
        
    </section>


    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
	const mainArticleElement = document.querySelector(".main-article");
        renderMathInElement(mainArticleElement, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>

    

    

    


    

    


    
    


    
    


    
    

    

    


</article>



    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/post/writenotes/model/splats/c-symp-3dgs/">
        
        
            <div class="article-image">
                <img src="/post/writenotes/model/splats/c-symp-3dgs/feat_img-nerf_vs_3dgs.41589823e61ec695153c03fec0389cbe.webp" 
                        width="603" 
                        height="232" 
                        loading="lazy"
                        alt="Featured image of post Sympo: Render - Points | 3DGS"
                        
                        data-hash="md5-QViYI&#43;YexpUVPAP&#43;wDicvg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Sympo: Render - Points | 3DGS</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/writenotes/model/splats/b-note-ewa_splatting/">
        
        
            <div class="article-image">
                
                    <img src="https://pic2.zhimg.com/80/v2-7cbe3b0c3b67ce80593fad0d73a814b5_720w.webp" loading="lazy" data-key="" data-hash="https://pic2.zhimg.com/80/v2-7cbe3b0c3b67ce80593fad0d73a814b5_720w.webp"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Read: Render - Points | EWA Splatting</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/writenotes/model/splats/b-note-3dgs-debug/">
        
        

        <div class="article-details">
            <h2 class="article-title">Read: 3DGS | Debug Code</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/writenotes/model/splats/d-vid-3dgs-explain-%E8%91%B5/">
        
        
            <div class="article-image">
                
                    <img src="https://img.youtube.com/vi/1buFrKUaqwM/maxresdefault.jpg" loading="lazy" data-key="" data-hash="https://img.youtube.com/vi/1buFrKUaqwM/maxresdefault.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">watch: 3DGS | AIè‘µ Cuda Code Walkthrough</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/writenotes/model/splats/b-note-3dgs-read/">
        
        
            <div class="article-image">
                
                    <img src="https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Ftse3.mm.bing.net%2Fth%3Fid%3DOIP.bfDD9_L28UK7AsADDzB8vwHaEo%26pid%3DApi&amp;f=1&amp;ipt=3b34b7952e1e03305e5c085185ede1ad09e8edc71e9c1161a33c17b6b9f2b3ac&amp;ipo=images" loading="lazy" data-key="" data-hash="https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Ftse3.mm.bing.net%2Fth%3Fid%3DOIP.bfDD9_L28UK7AsADDzB8vwHaEo%26pid%3DApi&amp;f=1&amp;ipt=3b34b7952e1e03305e5c085185ede1ad09e8edc71e9c1161a33c17b6b9f2b3ac&amp;ipo=images"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Read: NVS - 3DGS | 3D Gaussian Splatting</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2025 Zichen Wang
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
